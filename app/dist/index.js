!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(window,(function(){return function(t){var e=window.webpackHotUpdate;window.webpackHotUpdate=function(t,r){!function(t,e){if(!C[t]||!m[t])return;for(var r in m[t]=!1,e)Object.prototype.hasOwnProperty.call(e,r)&&(A[r]=e[r]);0==--E&&0===v&&M()}(t,r),e&&e(t,r)};var r,n=!0,i="a41c10f92d7ac76e2a44",a={},o=[],s=[];function u(t){var e=_[t];if(!e)return P;var n=function(n){return e.hot.active?(_[n]?-1===_[n].parents.indexOf(t)&&_[n].parents.push(t):(o=[t],r=n),-1===e.children.indexOf(n)&&e.children.push(n)):(console.warn("[HMR] unexpected require("+n+") from disposed module "+t),o=[]),P(n)},i=function(t){return{configurable:!0,enumerable:!0,get:function(){return P[t]},set:function(e){P[t]=e}}};for(var a in P)Object.prototype.hasOwnProperty.call(P,a)&&"e"!==a&&"t"!==a&&Object.defineProperty(n,a,i(a));return n.e=function(t){return"ready"===f&&h("prepare"),v++,P.e(t).then(e,(function(t){throw e(),t}));function e(){v--,"prepare"===f&&(T[t]||b(t),0===v&&0===E&&M())}},n.t=function(t,e){return 1&e&&(t=n(t)),P.t(t,-2&e)},n}function c(e){var n={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:r!==e,active:!0,accept:function(t,e){if(void 0===t)n._selfAccepted=!0;else if("function"==typeof t)n._selfAccepted=t;else if("object"==typeof t)for(var r=0;r<t.length;r++)n._acceptedDependencies[t[r]]=e||function(){};else n._acceptedDependencies[t]=e||function(){}},decline:function(t){if(void 0===t)n._selfDeclined=!0;else if("object"==typeof t)for(var e=0;e<t.length;e++)n._declinedDependencies[t[e]]=!0;else n._declinedDependencies[t]=!0},dispose:function(t){n._disposeHandlers.push(t)},addDisposeHandler:function(t){n._disposeHandlers.push(t)},removeDisposeHandler:function(t){var e=n._disposeHandlers.indexOf(t);e>=0&&n._disposeHandlers.splice(e,1)},invalidate:function(){switch(this._selfInvalidated=!0,f){case"idle":(A={})[e]=t[e],h("ready");break;case"ready":O(e);break;case"prepare":case"check":case"dispose":case"apply":(I=I||[]).push(e)}},check:R,apply:F,status:function(t){if(!t)return f;l.push(t)},addStatusHandler:function(t){l.push(t)},removeStatusHandler:function(t){var e=l.indexOf(t);e>=0&&l.splice(e,1)},data:a[e]};return r=void 0,n}var l=[],f="idle";function h(t){f=t;for(var e=0;e<l.length;e++)l[e].call(null,t)}var d,A,p,I,E=0,v=0,T={},m={},C={};function g(t){return+t+""===t?+t:t}function R(t){if("idle"!==f)throw new Error("check() is only allowed in idle status");return n=t,h("check"),(e=1e4,e=e||1e4,new Promise((function(t,r){if("undefined"==typeof XMLHttpRequest)return r(new Error("No browser support"));try{var n=new XMLHttpRequest,a=P.p+""+i+".hot-update.json";n.open("GET",a,!0),n.timeout=e,n.send(null)}catch(t){return r(t)}n.onreadystatechange=function(){if(4===n.readyState)if(0===n.status)r(new Error("Manifest request to "+a+" timed out."));else if(404===n.status)t();else if(200!==n.status&&304!==n.status)r(new Error("Manifest request to "+a+" failed."));else{try{var e=JSON.parse(n.responseText)}catch(t){return void r(t)}t(e)}}}))).then((function(t){if(!t)return h(y()?"ready":"idle"),null;m={},T={},C=t.c,p=t.h,h("prepare");var e=new Promise((function(t,e){d={resolve:t,reject:e}}));A={};return b(0),"prepare"===f&&0===v&&0===E&&M(),e}));var e}function b(t){C[t]?(m[t]=!0,E++,function(t){var e=document.createElement("script");e.charset="utf-8",e.src=P.p+""+t+"."+i+".hot-update.js",document.head.appendChild(e)}(t)):T[t]=!0}function M(){h("ready");var t=d;if(d=null,t)if(n)Promise.resolve().then((function(){return F(n)})).then((function(e){t.resolve(e)}),(function(e){t.reject(e)}));else{var e=[];for(var r in A)Object.prototype.hasOwnProperty.call(A,r)&&e.push(g(r));t.resolve(e)}}function F(e){if("ready"!==f)throw new Error("apply() is only allowed in ready status");return function e(n){var s,u,c,l,f;function d(t){for(var e=[t],r={},n=e.map((function(t){return{chain:[t],id:t}}));n.length>0;){var i=n.pop(),a=i.id,o=i.chain;if((l=_[a])&&(!l.hot._selfAccepted||l.hot._selfInvalidated)){if(l.hot._selfDeclined)return{type:"self-declined",chain:o,moduleId:a};if(l.hot._main)return{type:"unaccepted",chain:o,moduleId:a};for(var s=0;s<l.parents.length;s++){var u=l.parents[s],c=_[u];if(c){if(c.hot._declinedDependencies[a])return{type:"declined",chain:o.concat([u]),moduleId:a,parentId:u};-1===e.indexOf(u)&&(c.hot._acceptedDependencies[a]?(r[u]||(r[u]=[]),E(r[u],[a])):(delete r[u],e.push(u),n.push({chain:o.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:t,outdatedModules:e,outdatedDependencies:r}}function E(t,e){for(var r=0;r<e.length;r++){var n=e[r];-1===t.indexOf(n)&&t.push(n)}}y();var v={},T=[],m={},R=function(){console.warn("[HMR] unexpected require("+M.moduleId+") to disposed module")};for(var b in A)if(Object.prototype.hasOwnProperty.call(A,b)){var M;f=g(b),M=A[b]?d(f):{type:"disposed",moduleId:b};var F=!1,O=!1,N=!1,S="";switch(M.chain&&(S="\nUpdate propagation: "+M.chain.join(" -> ")),M.type){case"self-declined":n.onDeclined&&n.onDeclined(M),n.ignoreDeclined||(F=new Error("Aborted because of self decline: "+M.moduleId+S));break;case"declined":n.onDeclined&&n.onDeclined(M),n.ignoreDeclined||(F=new Error("Aborted because of declined dependency: "+M.moduleId+" in "+M.parentId+S));break;case"unaccepted":n.onUnaccepted&&n.onUnaccepted(M),n.ignoreUnaccepted||(F=new Error("Aborted because "+f+" is not accepted"+S));break;case"accepted":n.onAccepted&&n.onAccepted(M),O=!0;break;case"disposed":n.onDisposed&&n.onDisposed(M),N=!0;break;default:throw new Error("Unexception type "+M.type)}if(F)return h("abort"),Promise.reject(F);if(O)for(f in m[f]=A[f],E(T,M.outdatedModules),M.outdatedDependencies)Object.prototype.hasOwnProperty.call(M.outdatedDependencies,f)&&(v[f]||(v[f]=[]),E(v[f],M.outdatedDependencies[f]));N&&(E(T,[M.moduleId]),m[f]=R)}var L,B=[];for(u=0;u<T.length;u++)f=T[u],_[f]&&_[f].hot._selfAccepted&&m[f]!==R&&!_[f].hot._selfInvalidated&&B.push({module:f,parents:_[f].parents.slice(),errorHandler:_[f].hot._selfAccepted});h("dispose"),Object.keys(C).forEach((function(t){!1===C[t]&&function(t){delete installedChunks[t]}(t)}));var x,w,U=T.slice();for(;U.length>0;)if(f=U.pop(),l=_[f]){var D={},G=l.hot._disposeHandlers;for(c=0;c<G.length;c++)(s=G[c])(D);for(a[f]=D,l.hot.active=!1,delete _[f],delete v[f],c=0;c<l.children.length;c++){var V=_[l.children[c]];V&&((L=V.parents.indexOf(f))>=0&&V.parents.splice(L,1))}}for(f in v)if(Object.prototype.hasOwnProperty.call(v,f)&&(l=_[f]))for(w=v[f],c=0;c<w.length;c++)x=w[c],(L=l.children.indexOf(x))>=0&&l.children.splice(L,1);h("apply"),void 0!==p&&(i=p,p=void 0);for(f in A=void 0,m)Object.prototype.hasOwnProperty.call(m,f)&&(t[f]=m[f]);var H=null;for(f in v)if(Object.prototype.hasOwnProperty.call(v,f)&&(l=_[f])){w=v[f];var X=[];for(u=0;u<w.length;u++)if(x=w[u],s=l.hot._acceptedDependencies[x]){if(-1!==X.indexOf(s))continue;X.push(s)}for(u=0;u<X.length;u++){s=X[u];try{s(w)}catch(t){n.onErrored&&n.onErrored({type:"accept-errored",moduleId:f,dependencyId:w[u],error:t}),n.ignoreErrored||H||(H=t)}}}for(u=0;u<B.length;u++){var q=B[u];f=q.module,o=q.parents,r=f;try{P(f)}catch(t){if("function"==typeof q.errorHandler)try{q.errorHandler(t)}catch(e){n.onErrored&&n.onErrored({type:"self-accept-error-handler-errored",moduleId:f,error:e,originalError:t}),n.ignoreErrored||H||(H=e),H||(H=t)}else n.onErrored&&n.onErrored({type:"self-accept-errored",moduleId:f,error:t}),n.ignoreErrored||H||(H=t)}}if(H)return h("fail"),Promise.reject(H);if(I)return e(n).then((function(t){return T.forEach((function(e){t.indexOf(e)<0&&t.push(e)})),t}));return h("idle"),new Promise((function(t){t(T)}))}(e=e||{})}function y(){if(I)return A||(A={}),I.forEach(O),I=void 0,!0}function O(e){Object.prototype.hasOwnProperty.call(A,e)||(A[e]=t[e])}var _={};function P(e){if(_[e])return _[e].exports;var r=_[e]={i:e,l:!1,exports:{},hot:c(e),parents:(s=o,o=[],s),children:[]};return t[e].call(r.exports,r,r.exports,u(e)),r.l=!0,r.exports}return P.m=t,P.c=_,P.d=function(t,e,r){P.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},P.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},P.t=function(t,e){if(1&e&&(t=P(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(P.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)P.d(r,n,function(e){return t[e]}.bind(null,n));return r},P.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return P.d(e,"a",e),e},P.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},P.p="",P.h=function(){return i},u("./src/index.ts")(P.s="./src/index.ts")}({"./node_modules/@xbim/viewer/index.js":function(t,e,r){window,t.exports=function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=18)}([function(t,e,r){"use strict";r.r(e);var n={};r.d(n,"EPSILON",(function(){return d})),r.d(n,"ARRAY_TYPE",(function(){return A})),r.d(n,"RANDOM",(function(){return p})),r.d(n,"setMatrixArrayType",(function(){return I})),r.d(n,"toRadian",(function(){return v})),r.d(n,"equals",(function(){return T}));var i={};r.d(i,"create",(function(){return m})),r.d(i,"clone",(function(){return C})),r.d(i,"copy",(function(){return g})),r.d(i,"identity",(function(){return R})),r.d(i,"fromValues",(function(){return b})),r.d(i,"set",(function(){return M})),r.d(i,"transpose",(function(){return F})),r.d(i,"invert",(function(){return y})),r.d(i,"adjoint",(function(){return O})),r.d(i,"determinant",(function(){return _})),r.d(i,"multiply",(function(){return P})),r.d(i,"rotate",(function(){return N})),r.d(i,"scale",(function(){return S})),r.d(i,"fromRotation",(function(){return L})),r.d(i,"fromScaling",(function(){return B})),r.d(i,"str",(function(){return x})),r.d(i,"frob",(function(){return w})),r.d(i,"LDU",(function(){return U})),r.d(i,"add",(function(){return D})),r.d(i,"subtract",(function(){return G})),r.d(i,"exactEquals",(function(){return V})),r.d(i,"equals",(function(){return H})),r.d(i,"multiplyScalar",(function(){return X})),r.d(i,"multiplyScalarAndAdd",(function(){return q})),r.d(i,"mul",(function(){return k})),r.d(i,"sub",(function(){return W}));var a={};r.d(a,"create",(function(){return j})),r.d(a,"clone",(function(){return Q})),r.d(a,"copy",(function(){return z})),r.d(a,"identity",(function(){return K})),r.d(a,"fromValues",(function(){return Y})),r.d(a,"set",(function(){return Z})),r.d(a,"invert",(function(){return J})),r.d(a,"determinant",(function(){return $})),r.d(a,"multiply",(function(){return tt})),r.d(a,"rotate",(function(){return et})),r.d(a,"scale",(function(){return rt})),r.d(a,"translate",(function(){return nt})),r.d(a,"fromRotation",(function(){return it})),r.d(a,"fromScaling",(function(){return at})),r.d(a,"fromTranslation",(function(){return ot})),r.d(a,"str",(function(){return st})),r.d(a,"frob",(function(){return ut})),r.d(a,"add",(function(){return ct})),r.d(a,"subtract",(function(){return lt})),r.d(a,"multiplyScalar",(function(){return ft})),r.d(a,"multiplyScalarAndAdd",(function(){return ht})),r.d(a,"exactEquals",(function(){return dt})),r.d(a,"equals",(function(){return At})),r.d(a,"mul",(function(){return pt})),r.d(a,"sub",(function(){return It}));var o={};r.d(o,"create",(function(){return Et})),r.d(o,"fromMat4",(function(){return vt})),r.d(o,"clone",(function(){return Tt})),r.d(o,"copy",(function(){return mt})),r.d(o,"fromValues",(function(){return Ct})),r.d(o,"set",(function(){return gt})),r.d(o,"identity",(function(){return Rt})),r.d(o,"transpose",(function(){return bt})),r.d(o,"invert",(function(){return Mt})),r.d(o,"adjoint",(function(){return Ft})),r.d(o,"determinant",(function(){return yt})),r.d(o,"multiply",(function(){return Ot})),r.d(o,"translate",(function(){return _t})),r.d(o,"rotate",(function(){return Pt})),r.d(o,"scale",(function(){return Nt})),r.d(o,"fromTranslation",(function(){return St})),r.d(o,"fromRotation",(function(){return Lt})),r.d(o,"fromScaling",(function(){return Bt})),r.d(o,"fromMat2d",(function(){return xt})),r.d(o,"fromQuat",(function(){return wt})),r.d(o,"normalFromMat4",(function(){return Ut})),r.d(o,"projection",(function(){return Dt})),r.d(o,"str",(function(){return Gt})),r.d(o,"frob",(function(){return Vt})),r.d(o,"add",(function(){return Ht})),r.d(o,"subtract",(function(){return Xt})),r.d(o,"multiplyScalar",(function(){return qt})),r.d(o,"multiplyScalarAndAdd",(function(){return kt})),r.d(o,"exactEquals",(function(){return Wt})),r.d(o,"equals",(function(){return jt})),r.d(o,"mul",(function(){return Qt})),r.d(o,"sub",(function(){return zt}));var s={};r.d(s,"create",(function(){return Kt})),r.d(s,"clone",(function(){return Yt})),r.d(s,"copy",(function(){return Zt})),r.d(s,"fromValues",(function(){return Jt})),r.d(s,"set",(function(){return $t})),r.d(s,"identity",(function(){return te})),r.d(s,"transpose",(function(){return ee})),r.d(s,"invert",(function(){return re})),r.d(s,"adjoint",(function(){return ne})),r.d(s,"determinant",(function(){return ie})),r.d(s,"multiply",(function(){return ae})),r.d(s,"translate",(function(){return oe})),r.d(s,"scale",(function(){return se})),r.d(s,"rotate",(function(){return ue})),r.d(s,"rotateX",(function(){return ce})),r.d(s,"rotateY",(function(){return le})),r.d(s,"rotateZ",(function(){return fe})),r.d(s,"fromTranslation",(function(){return he})),r.d(s,"fromScaling",(function(){return de})),r.d(s,"fromRotation",(function(){return Ae})),r.d(s,"fromXRotation",(function(){return pe})),r.d(s,"fromYRotation",(function(){return Ie})),r.d(s,"fromZRotation",(function(){return Ee})),r.d(s,"fromRotationTranslation",(function(){return ve})),r.d(s,"fromQuat2",(function(){return Te})),r.d(s,"getTranslation",(function(){return me})),r.d(s,"getScaling",(function(){return Ce})),r.d(s,"getRotation",(function(){return ge})),r.d(s,"fromRotationTranslationScale",(function(){return Re})),r.d(s,"fromRotationTranslationScaleOrigin",(function(){return be})),r.d(s,"fromQuat",(function(){return Me})),r.d(s,"frustum",(function(){return Fe})),r.d(s,"perspective",(function(){return ye})),r.d(s,"perspectiveFromFieldOfView",(function(){return Oe})),r.d(s,"ortho",(function(){return _e})),r.d(s,"lookAt",(function(){return Pe})),r.d(s,"targetTo",(function(){return Ne})),r.d(s,"str",(function(){return Se})),r.d(s,"frob",(function(){return Le})),r.d(s,"add",(function(){return Be})),r.d(s,"subtract",(function(){return xe})),r.d(s,"multiplyScalar",(function(){return we})),r.d(s,"multiplyScalarAndAdd",(function(){return Ue})),r.d(s,"exactEquals",(function(){return De})),r.d(s,"equals",(function(){return Ge})),r.d(s,"mul",(function(){return Ve})),r.d(s,"sub",(function(){return He}));var u={};r.d(u,"create",(function(){return Xe})),r.d(u,"clone",(function(){return qe})),r.d(u,"length",(function(){return ke})),r.d(u,"fromValues",(function(){return We})),r.d(u,"copy",(function(){return je})),r.d(u,"set",(function(){return Qe})),r.d(u,"add",(function(){return ze})),r.d(u,"subtract",(function(){return Ke})),r.d(u,"multiply",(function(){return Ye})),r.d(u,"divide",(function(){return Ze})),r.d(u,"ceil",(function(){return Je})),r.d(u,"floor",(function(){return $e})),r.d(u,"min",(function(){return tr})),r.d(u,"max",(function(){return er})),r.d(u,"round",(function(){return rr})),r.d(u,"scale",(function(){return nr})),r.d(u,"scaleAndAdd",(function(){return ir})),r.d(u,"distance",(function(){return ar})),r.d(u,"squaredDistance",(function(){return or})),r.d(u,"squaredLength",(function(){return sr})),r.d(u,"negate",(function(){return ur})),r.d(u,"inverse",(function(){return cr})),r.d(u,"normalize",(function(){return lr})),r.d(u,"dot",(function(){return fr})),r.d(u,"cross",(function(){return hr})),r.d(u,"lerp",(function(){return dr})),r.d(u,"hermite",(function(){return Ar})),r.d(u,"bezier",(function(){return pr})),r.d(u,"random",(function(){return Ir})),r.d(u,"transformMat4",(function(){return Er})),r.d(u,"transformMat3",(function(){return vr})),r.d(u,"transformQuat",(function(){return Tr})),r.d(u,"rotateX",(function(){return mr})),r.d(u,"rotateY",(function(){return Cr})),r.d(u,"rotateZ",(function(){return gr})),r.d(u,"angle",(function(){return Rr})),r.d(u,"zero",(function(){return br})),r.d(u,"str",(function(){return Mr})),r.d(u,"exactEquals",(function(){return Fr})),r.d(u,"equals",(function(){return yr})),r.d(u,"sub",(function(){return _r})),r.d(u,"mul",(function(){return Pr})),r.d(u,"div",(function(){return Nr})),r.d(u,"dist",(function(){return Sr})),r.d(u,"sqrDist",(function(){return Lr})),r.d(u,"len",(function(){return Br})),r.d(u,"sqrLen",(function(){return xr})),r.d(u,"forEach",(function(){return wr}));var c={};r.d(c,"create",(function(){return Ur})),r.d(c,"clone",(function(){return Dr})),r.d(c,"fromValues",(function(){return Gr})),r.d(c,"copy",(function(){return Vr})),r.d(c,"set",(function(){return Hr})),r.d(c,"add",(function(){return Xr})),r.d(c,"subtract",(function(){return qr})),r.d(c,"multiply",(function(){return kr})),r.d(c,"divide",(function(){return Wr})),r.d(c,"ceil",(function(){return jr})),r.d(c,"floor",(function(){return Qr})),r.d(c,"min",(function(){return zr})),r.d(c,"max",(function(){return Kr})),r.d(c,"round",(function(){return Yr})),r.d(c,"scale",(function(){return Zr})),r.d(c,"scaleAndAdd",(function(){return Jr})),r.d(c,"distance",(function(){return $r})),r.d(c,"squaredDistance",(function(){return tn})),r.d(c,"length",(function(){return en})),r.d(c,"squaredLength",(function(){return rn})),r.d(c,"negate",(function(){return nn})),r.d(c,"inverse",(function(){return an})),r.d(c,"normalize",(function(){return on})),r.d(c,"dot",(function(){return sn})),r.d(c,"cross",(function(){return un})),r.d(c,"lerp",(function(){return cn})),r.d(c,"random",(function(){return ln})),r.d(c,"transformMat4",(function(){return fn})),r.d(c,"transformQuat",(function(){return hn})),r.d(c,"zero",(function(){return dn})),r.d(c,"str",(function(){return An})),r.d(c,"exactEquals",(function(){return pn})),r.d(c,"equals",(function(){return In})),r.d(c,"sub",(function(){return En})),r.d(c,"mul",(function(){return vn})),r.d(c,"div",(function(){return Tn})),r.d(c,"dist",(function(){return mn})),r.d(c,"sqrDist",(function(){return Cn})),r.d(c,"len",(function(){return gn})),r.d(c,"sqrLen",(function(){return Rn})),r.d(c,"forEach",(function(){return bn}));var l={};r.d(l,"create",(function(){return Mn})),r.d(l,"identity",(function(){return Fn})),r.d(l,"setAxisAngle",(function(){return yn})),r.d(l,"getAxisAngle",(function(){return On})),r.d(l,"multiply",(function(){return _n})),r.d(l,"rotateX",(function(){return Pn})),r.d(l,"rotateY",(function(){return Nn})),r.d(l,"rotateZ",(function(){return Sn})),r.d(l,"calculateW",(function(){return Ln})),r.d(l,"slerp",(function(){return Bn})),r.d(l,"random",(function(){return xn})),r.d(l,"invert",(function(){return wn})),r.d(l,"conjugate",(function(){return Un})),r.d(l,"fromMat3",(function(){return Dn})),r.d(l,"fromEuler",(function(){return Gn})),r.d(l,"str",(function(){return Vn})),r.d(l,"clone",(function(){return Qn})),r.d(l,"fromValues",(function(){return zn})),r.d(l,"copy",(function(){return Kn})),r.d(l,"set",(function(){return Yn})),r.d(l,"add",(function(){return Zn})),r.d(l,"mul",(function(){return Jn})),r.d(l,"scale",(function(){return $n})),r.d(l,"dot",(function(){return ti})),r.d(l,"lerp",(function(){return ei})),r.d(l,"length",(function(){return ri})),r.d(l,"len",(function(){return ni})),r.d(l,"squaredLength",(function(){return ii})),r.d(l,"sqrLen",(function(){return ai})),r.d(l,"normalize",(function(){return oi})),r.d(l,"exactEquals",(function(){return si})),r.d(l,"equals",(function(){return ui})),r.d(l,"rotationTo",(function(){return ci})),r.d(l,"sqlerp",(function(){return li})),r.d(l,"setAxes",(function(){return fi}));var f={};r.d(f,"create",(function(){return hi})),r.d(f,"clone",(function(){return di})),r.d(f,"fromValues",(function(){return Ai})),r.d(f,"fromRotationTranslationValues",(function(){return pi})),r.d(f,"fromRotationTranslation",(function(){return Ii})),r.d(f,"fromTranslation",(function(){return Ei})),r.d(f,"fromRotation",(function(){return vi})),r.d(f,"fromMat4",(function(){return Ti})),r.d(f,"copy",(function(){return mi})),r.d(f,"identity",(function(){return Ci})),r.d(f,"set",(function(){return gi})),r.d(f,"getReal",(function(){return Ri})),r.d(f,"getDual",(function(){return bi})),r.d(f,"setReal",(function(){return Mi})),r.d(f,"setDual",(function(){return Fi})),r.d(f,"getTranslation",(function(){return yi})),r.d(f,"translate",(function(){return Oi})),r.d(f,"rotateX",(function(){return _i})),r.d(f,"rotateY",(function(){return Pi})),r.d(f,"rotateZ",(function(){return Ni})),r.d(f,"rotateByQuatAppend",(function(){return Si})),r.d(f,"rotateByQuatPrepend",(function(){return Li})),r.d(f,"rotateAroundAxis",(function(){return Bi})),r.d(f,"add",(function(){return xi})),r.d(f,"multiply",(function(){return wi})),r.d(f,"mul",(function(){return Ui})),r.d(f,"scale",(function(){return Di})),r.d(f,"dot",(function(){return Gi})),r.d(f,"lerp",(function(){return Vi})),r.d(f,"invert",(function(){return Hi})),r.d(f,"conjugate",(function(){return Xi})),r.d(f,"length",(function(){return qi})),r.d(f,"len",(function(){return ki})),r.d(f,"squaredLength",(function(){return Wi})),r.d(f,"sqrLen",(function(){return ji})),r.d(f,"normalize",(function(){return Qi})),r.d(f,"str",(function(){return zi})),r.d(f,"exactEquals",(function(){return Ki})),r.d(f,"equals",(function(){return Yi}));var h={};r.d(h,"create",(function(){return Zi})),r.d(h,"clone",(function(){return Ji})),r.d(h,"fromValues",(function(){return $i})),r.d(h,"copy",(function(){return ta})),r.d(h,"set",(function(){return ea})),r.d(h,"add",(function(){return ra})),r.d(h,"subtract",(function(){return na})),r.d(h,"multiply",(function(){return ia})),r.d(h,"divide",(function(){return aa})),r.d(h,"ceil",(function(){return oa})),r.d(h,"floor",(function(){return sa})),r.d(h,"min",(function(){return ua})),r.d(h,"max",(function(){return ca})),r.d(h,"round",(function(){return la})),r.d(h,"scale",(function(){return fa})),r.d(h,"scaleAndAdd",(function(){return ha})),r.d(h,"distance",(function(){return da})),r.d(h,"squaredDistance",(function(){return Aa})),r.d(h,"length",(function(){return pa})),r.d(h,"squaredLength",(function(){return Ia})),r.d(h,"negate",(function(){return Ea})),r.d(h,"inverse",(function(){return va})),r.d(h,"normalize",(function(){return Ta})),r.d(h,"dot",(function(){return ma})),r.d(h,"cross",(function(){return Ca})),r.d(h,"lerp",(function(){return ga})),r.d(h,"random",(function(){return Ra})),r.d(h,"transformMat2",(function(){return ba})),r.d(h,"transformMat2d",(function(){return Ma})),r.d(h,"transformMat3",(function(){return Fa})),r.d(h,"transformMat4",(function(){return ya})),r.d(h,"rotate",(function(){return Oa})),r.d(h,"angle",(function(){return _a})),r.d(h,"zero",(function(){return Pa})),r.d(h,"str",(function(){return Na})),r.d(h,"exactEquals",(function(){return Sa})),r.d(h,"equals",(function(){return La})),r.d(h,"len",(function(){return Ba})),r.d(h,"sub",(function(){return xa})),r.d(h,"mul",(function(){return wa})),r.d(h,"div",(function(){return Ua})),r.d(h,"dist",(function(){return Da})),r.d(h,"sqrDist",(function(){return Ga})),r.d(h,"sqrLen",(function(){return Va})),r.d(h,"forEach",(function(){return Ha}));var d=1e-6,A="undefined"!=typeof Float32Array?Float32Array:Array,p=Math.random;function I(t){A=t}var E=Math.PI/180;function v(t){return t*E}function T(t,e){return Math.abs(t-e)<=d*Math.max(1,Math.abs(t),Math.abs(e))}function m(){var t=new A(4);return A!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function C(t){var e=new A(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function g(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function R(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function b(t,e,r,n){var i=new A(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function M(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function F(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function y(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*a-i*n;return o?(o=1/o,t[0]=a*o,t[1]=-n*o,t[2]=-i*o,t[3]=r*o,t):null}function O(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t}function _(t){return t[0]*t[3]-t[2]*t[1]}function P(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[0],u=r[1],c=r[2],l=r[3];return t[0]=n*s+a*u,t[1]=i*s+o*u,t[2]=n*c+a*l,t[3]=i*c+o*l,t}function N(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+a*s,t[1]=i*u+o*s,t[2]=n*-s+a*u,t[3]=i*-s+o*u,t}function S(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[0],u=r[1];return t[0]=n*s,t[1]=i*s,t[2]=a*u,t[3]=o*u,t}function L(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t}function B(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function x(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function w(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))}function U(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]}function D(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function G(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function V(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function H(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=d*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-c)<=d*Math.max(1,Math.abs(a),Math.abs(c))}function X(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function q(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}var k=P,W=G;function j(){var t=new A(6);return A!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function Q(t){var e=new A(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function z(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function K(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Y(t,e,r,n,i,a){var o=new A(6);return o[0]=t,o[1]=e,o[2]=r,o[3]=n,o[4]=i,o[5]=a,o}function Z(t,e,r,n,i,a,o){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t}function J(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=r*a-n*i;return u?(u=1/u,t[0]=a*u,t[1]=-n*u,t[2]=-i*u,t[3]=r*u,t[4]=(i*s-a*o)*u,t[5]=(n*o-r*s)*u,t):null}function $(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=r[0],l=r[1],f=r[2],h=r[3],d=r[4],A=r[5];return t[0]=n*c+a*l,t[1]=i*c+o*l,t[2]=n*f+a*h,t[3]=i*f+o*h,t[4]=n*d+a*A+s,t[5]=i*d+o*A+u,t}function et(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=Math.sin(r),l=Math.cos(r);return t[0]=n*l+a*c,t[1]=i*l+o*c,t[2]=n*-c+a*l,t[3]=i*-c+o*l,t[4]=s,t[5]=u,t}function rt(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=r[0],l=r[1];return t[0]=n*c,t[1]=i*c,t[2]=a*l,t[3]=o*l,t[4]=s,t[5]=u,t}function nt(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=r[0],l=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=n*c+a*l+s,t[5]=i*c+o*l+u,t}function it(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t}function at(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function ot(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function st(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ut(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)}function ct(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t}function lt(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}function ft(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t}function ht(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t}function dt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function At(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=e[0],c=e[1],l=e[2],f=e[3],h=e[4],A=e[5];return Math.abs(r-u)<=d*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-c)<=d*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-l)<=d*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(a-f)<=d*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(o-h)<=d*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-A)<=d*Math.max(1,Math.abs(s),Math.abs(A))}var pt=tt,It=lt;function Et(){var t=new A(9);return A!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function vt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Tt(t){var e=new A(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function mt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Ct(t,e,r,n,i,a,o,s,u){var c=new A(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=n,c[4]=i,c[5]=a,c[6]=o,c[7]=s,c[8]=u,c}function gt(t,e,r,n,i,a,o,s,u,c){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t}function Rt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function bt(t,e){if(t===e){var r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Mt(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=l*o-s*c,h=-l*a+s*u,d=c*a-o*u,A=r*f+n*h+i*d;return A?(A=1/A,t[0]=f*A,t[1]=(-l*n+i*c)*A,t[2]=(s*n-i*o)*A,t[3]=h*A,t[4]=(l*r-i*u)*A,t[5]=(-s*r+i*a)*A,t[6]=d*A,t[7]=(-c*r+n*u)*A,t[8]=(o*r-n*a)*A,t):null}function Ft(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8];return t[0]=o*l-s*c,t[1]=i*c-n*l,t[2]=n*s-i*o,t[3]=s*u-a*l,t[4]=r*l-i*u,t[5]=i*a-r*s,t[6]=a*c-o*u,t[7]=n*u-r*c,t[8]=r*o-n*a,t}function yt(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],u=t[7],c=t[8];return e*(c*a-o*u)+r*(-c*i+o*s)+n*(u*i-a*s)}function Ot(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=r[0],d=r[1],A=r[2],p=r[3],I=r[4],E=r[5],v=r[6],T=r[7],m=r[8];return t[0]=h*n+d*o+A*c,t[1]=h*i+d*s+A*l,t[2]=h*a+d*u+A*f,t[3]=p*n+I*o+E*c,t[4]=p*i+I*s+E*l,t[5]=p*a+I*u+E*f,t[6]=v*n+T*o+m*c,t[7]=v*i+T*s+m*l,t[8]=v*a+T*u+m*f,t}function _t(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=r[0],d=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=u,t[6]=h*n+d*o+c,t[7]=h*i+d*s+l,t[8]=h*a+d*u+f,t}function Pt(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=Math.sin(r),d=Math.cos(r);return t[0]=d*n+h*o,t[1]=d*i+h*s,t[2]=d*a+h*u,t[3]=d*o-h*n,t[4]=d*s-h*i,t[5]=d*u-h*a,t[6]=c,t[7]=l,t[8]=f,t}function Nt(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function St(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Lt(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Bt(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function xt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function wt(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r+r,s=n+n,u=i+i,c=r*o,l=n*o,f=n*s,h=i*o,d=i*s,A=i*u,p=a*o,I=a*s,E=a*u;return t[0]=1-f-A,t[3]=l-E,t[6]=h+I,t[1]=l+E,t[4]=1-c-A,t[7]=d-p,t[2]=h-I,t[5]=d+p,t[8]=1-c-f,t}function Ut(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],A=e[12],p=e[13],I=e[14],E=e[15],v=r*s-n*o,T=r*u-i*o,m=r*c-a*o,C=n*u-i*s,g=n*c-a*s,R=i*c-a*u,b=l*p-f*A,M=l*I-h*A,F=l*E-d*A,y=f*I-h*p,O=f*E-d*p,_=h*E-d*I,P=v*_-T*O+m*y+C*F-g*M+R*b;return P?(P=1/P,t[0]=(s*_-u*O+c*y)*P,t[1]=(u*F-o*_-c*M)*P,t[2]=(o*O-s*F+c*b)*P,t[3]=(i*O-n*_-a*y)*P,t[4]=(r*_-i*F+a*M)*P,t[5]=(n*F-r*O-a*b)*P,t[6]=(p*R-I*g+E*C)*P,t[7]=(I*m-A*R-E*T)*P,t[8]=(A*g-p*m+E*v)*P,t):null}function Dt(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Gt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Vt(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))}function Ht(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function Xt(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function qt(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function kt(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t}function Wt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function jt(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=e[0],h=e[1],A=e[2],p=e[3],I=e[4],E=e[5],v=e[6],T=e[7],m=e[8];return Math.abs(r-f)<=d*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-h)<=d*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-A)<=d*Math.max(1,Math.abs(i),Math.abs(A))&&Math.abs(a-p)<=d*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-I)<=d*Math.max(1,Math.abs(o),Math.abs(I))&&Math.abs(s-E)<=d*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(u-v)<=d*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-T)<=d*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(l-m)<=d*Math.max(1,Math.abs(l),Math.abs(m))}var Qt=Ot,zt=Xt;function Kt(){var t=new A(16);return A!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Yt(t){var e=new A(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Zt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Jt(t,e,r,n,i,a,o,s,u,c,l,f,h,d,p,I){var E=new A(16);return E[0]=t,E[1]=e,E[2]=r,E[3]=n,E[4]=i,E[5]=a,E[6]=o,E[7]=s,E[8]=u,E[9]=c,E[10]=l,E[11]=f,E[12]=h,E[13]=d,E[14]=p,E[15]=I,E}function $t(t,e,r,n,i,a,o,s,u,c,l,f,h,d,A,p,I){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t[9]=l,t[10]=f,t[11]=h,t[12]=d,t[13]=A,t[14]=p,t[15]=I,t}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ee(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function re(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],A=e[12],p=e[13],I=e[14],E=e[15],v=r*s-n*o,T=r*u-i*o,m=r*c-a*o,C=n*u-i*s,g=n*c-a*s,R=i*c-a*u,b=l*p-f*A,M=l*I-h*A,F=l*E-d*A,y=f*I-h*p,O=f*E-d*p,_=h*E-d*I,P=v*_-T*O+m*y+C*F-g*M+R*b;return P?(P=1/P,t[0]=(s*_-u*O+c*y)*P,t[1]=(i*O-n*_-a*y)*P,t[2]=(p*R-I*g+E*C)*P,t[3]=(h*g-f*R-d*C)*P,t[4]=(u*F-o*_-c*M)*P,t[5]=(r*_-i*F+a*M)*P,t[6]=(I*m-A*R-E*T)*P,t[7]=(l*R-h*m+d*T)*P,t[8]=(o*O-s*F+c*b)*P,t[9]=(n*F-r*O-a*b)*P,t[10]=(A*g-p*m+E*v)*P,t[11]=(f*m-l*g-d*v)*P,t[12]=(s*M-o*y-u*b)*P,t[13]=(r*y-n*M+i*b)*P,t[14]=(p*T-A*C-I*v)*P,t[15]=(l*C-f*T+h*v)*P,t):null}function ne(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],A=e[12],p=e[13],I=e[14],E=e[15];return t[0]=s*(h*E-d*I)-f*(u*E-c*I)+p*(u*d-c*h),t[1]=-(n*(h*E-d*I)-f*(i*E-a*I)+p*(i*d-a*h)),t[2]=n*(u*E-c*I)-s*(i*E-a*I)+p*(i*c-a*u),t[3]=-(n*(u*d-c*h)-s*(i*d-a*h)+f*(i*c-a*u)),t[4]=-(o*(h*E-d*I)-l*(u*E-c*I)+A*(u*d-c*h)),t[5]=r*(h*E-d*I)-l*(i*E-a*I)+A*(i*d-a*h),t[6]=-(r*(u*E-c*I)-o*(i*E-a*I)+A*(i*c-a*u)),t[7]=r*(u*d-c*h)-o*(i*d-a*h)+l*(i*c-a*u),t[8]=o*(f*E-d*p)-l*(s*E-c*p)+A*(s*d-c*f),t[9]=-(r*(f*E-d*p)-l*(n*E-a*p)+A*(n*d-a*f)),t[10]=r*(s*E-c*p)-o*(n*E-a*p)+A*(n*c-a*s),t[11]=-(r*(s*d-c*f)-o*(n*d-a*f)+l*(n*c-a*s)),t[12]=-(o*(f*I-h*p)-l*(s*I-u*p)+A*(s*h-u*f)),t[13]=r*(f*I-h*p)-l*(n*I-i*p)+A*(n*h-i*f),t[14]=-(r*(s*I-u*p)-o*(n*I-i*p)+A*(n*u-i*s)),t[15]=r*(s*h-u*f)-o*(n*h-i*f)+l*(n*u-i*s),t}function ie(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11],d=t[12],A=t[13],p=t[14],I=t[15];return(e*o-r*a)*(f*I-h*p)-(e*s-n*a)*(l*I-h*A)+(e*u-i*a)*(l*p-f*A)+(r*s-n*o)*(c*I-h*d)-(r*u-i*o)*(c*p-f*d)+(n*u-i*s)*(c*A-l*d)}function ae(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],A=e[11],p=e[12],I=e[13],E=e[14],v=e[15],T=r[0],m=r[1],C=r[2],g=r[3];return t[0]=T*n+m*s+C*f+g*p,t[1]=T*i+m*u+C*h+g*I,t[2]=T*a+m*c+C*d+g*E,t[3]=T*o+m*l+C*A+g*v,T=r[4],m=r[5],C=r[6],g=r[7],t[4]=T*n+m*s+C*f+g*p,t[5]=T*i+m*u+C*h+g*I,t[6]=T*a+m*c+C*d+g*E,t[7]=T*o+m*l+C*A+g*v,T=r[8],m=r[9],C=r[10],g=r[11],t[8]=T*n+m*s+C*f+g*p,t[9]=T*i+m*u+C*h+g*I,t[10]=T*a+m*c+C*d+g*E,t[11]=T*o+m*l+C*A+g*v,T=r[12],m=r[13],C=r[14],g=r[15],t[12]=T*n+m*s+C*f+g*p,t[13]=T*i+m*u+C*h+g*I,t[14]=T*a+m*c+C*d+g*E,t[15]=T*o+m*l+C*A+g*v,t}function oe(t,e,r){var n,i,a,o,s,u,c,l,f,h,d,A,p=r[0],I=r[1],E=r[2];return e===t?(t[12]=e[0]*p+e[4]*I+e[8]*E+e[12],t[13]=e[1]*p+e[5]*I+e[9]*E+e[13],t[14]=e[2]*p+e[6]*I+e[10]*E+e[14],t[15]=e[3]*p+e[7]*I+e[11]*E+e[15]):(n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],A=e[11],t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=d,t[11]=A,t[12]=n*p+s*I+f*E+e[12],t[13]=i*p+u*I+h*E+e[13],t[14]=a*p+c*I+d*E+e[14],t[15]=o*p+l*I+A*E+e[15]),t}function se(t,e,r){var n=r[0],i=r[1],a=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ue(t,e,r,n){var i,a,o,s,u,c,l,f,h,A,p,I,E,v,T,m,C,g,R,b,M,F,y,O,_=n[0],P=n[1],N=n[2],S=Math.sqrt(_*_+P*P+N*N);return S<d?null:(_*=S=1/S,P*=S,N*=S,i=Math.sin(r),o=1-(a=Math.cos(r)),s=e[0],u=e[1],c=e[2],l=e[3],f=e[4],h=e[5],A=e[6],p=e[7],I=e[8],E=e[9],v=e[10],T=e[11],m=_*_*o+a,C=P*_*o+N*i,g=N*_*o-P*i,R=_*P*o-N*i,b=P*P*o+a,M=N*P*o+_*i,F=_*N*o+P*i,y=P*N*o-_*i,O=N*N*o+a,t[0]=s*m+f*C+I*g,t[1]=u*m+h*C+E*g,t[2]=c*m+A*C+v*g,t[3]=l*m+p*C+T*g,t[4]=s*R+f*b+I*M,t[5]=u*R+h*b+E*M,t[6]=c*R+A*b+v*M,t[7]=l*R+p*b+T*M,t[8]=s*F+f*y+I*O,t[9]=u*F+h*y+E*O,t[10]=c*F+A*y+v*O,t[11]=l*F+p*y+T*O,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ce(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[4],o=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+c*n,t[5]=o*i+l*n,t[6]=s*i+f*n,t[7]=u*i+h*n,t[8]=c*i-a*n,t[9]=l*i-o*n,t[10]=f*i-s*n,t[11]=h*i-u*n,t}function le(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[0],o=e[1],s=e[2],u=e[3],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-c*n,t[1]=o*i-l*n,t[2]=s*i-f*n,t[3]=u*i-h*n,t[8]=a*n+c*i,t[9]=o*n+l*i,t[10]=s*n+f*i,t[11]=u*n+h*i,t}function fe(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[0],o=e[1],s=e[2],u=e[3],c=e[4],l=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+c*n,t[1]=o*i+l*n,t[2]=s*i+f*n,t[3]=u*i+h*n,t[4]=c*i-a*n,t[5]=l*i-o*n,t[6]=f*i-s*n,t[7]=h*i-u*n,t}function he(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function de(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ae(t,e,r){var n,i,a,o=r[0],s=r[1],u=r[2],c=Math.sqrt(o*o+s*s+u*u);return c<d?null:(o*=c=1/c,s*=c,u*=c,n=Math.sin(e),a=1-(i=Math.cos(e)),t[0]=o*o*a+i,t[1]=s*o*a+u*n,t[2]=u*o*a-s*n,t[3]=0,t[4]=o*s*a-u*n,t[5]=s*s*a+i,t[6]=u*s*a+o*n,t[7]=0,t[8]=o*u*a+s*n,t[9]=s*u*a-o*n,t[10]=u*u*a+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function pe(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ie(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ee(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ve(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=n+n,u=i+i,c=a+a,l=n*s,f=n*u,h=n*c,d=i*u,A=i*c,p=a*c,I=o*s,E=o*u,v=o*c;return t[0]=1-(d+p),t[1]=f+v,t[2]=h-E,t[3]=0,t[4]=f-v,t[5]=1-(l+p),t[6]=A+I,t[7]=0,t[8]=h+E,t[9]=A-I,t[10]=1-(l+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Te(t,e){var r=new A(3),n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=n*n+i*i+a*a+o*o;return f>0?(r[0]=2*(s*o+l*n+u*a-c*i)/f,r[1]=2*(u*o+l*i+c*n-s*a)/f,r[2]=2*(c*o+l*a+s*i-u*n)/f):(r[0]=2*(s*o+l*n+u*a-c*i),r[1]=2*(u*o+l*i+c*n-s*a),r[2]=2*(c*o+l*a+s*i-u*n)),ve(t,e,r),t}function me(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Ce(t,e){var r=e[0],n=e[1],i=e[2],a=e[4],o=e[5],s=e[6],u=e[8],c=e[9],l=e[10];return t[0]=Math.sqrt(r*r+n*n+i*i),t[1]=Math.sqrt(a*a+o*o+s*s),t[2]=Math.sqrt(u*u+c*c+l*l),t}function ge(t,e){var r=e[0]+e[5]+e[10],n=0;return r>0?(n=2*Math.sqrt(r+1),t[3]=.25*n,t[0]=(e[6]-e[9])/n,t[1]=(e[8]-e[2])/n,t[2]=(e[1]-e[4])/n):e[0]>e[5]&&e[0]>e[10]?(n=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/n,t[0]=.25*n,t[1]=(e[1]+e[4])/n,t[2]=(e[8]+e[2])/n):e[5]>e[10]?(n=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/n,t[0]=(e[1]+e[4])/n,t[1]=.25*n,t[2]=(e[6]+e[9])/n):(n=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/n,t[0]=(e[8]+e[2])/n,t[1]=(e[6]+e[9])/n,t[2]=.25*n),t}function Re(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=e[3],u=i+i,c=a+a,l=o+o,f=i*u,h=i*c,d=i*l,A=a*c,p=a*l,I=o*l,E=s*u,v=s*c,T=s*l,m=n[0],C=n[1],g=n[2];return t[0]=(1-(A+I))*m,t[1]=(h+T)*m,t[2]=(d-v)*m,t[3]=0,t[4]=(h-T)*C,t[5]=(1-(f+I))*C,t[6]=(p+E)*C,t[7]=0,t[8]=(d+v)*g,t[9]=(p-E)*g,t[10]=(1-(f+A))*g,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function be(t,e,r,n,i){var a=e[0],o=e[1],s=e[2],u=e[3],c=a+a,l=o+o,f=s+s,h=a*c,d=a*l,A=a*f,p=o*l,I=o*f,E=s*f,v=u*c,T=u*l,m=u*f,C=n[0],g=n[1],R=n[2],b=i[0],M=i[1],F=i[2],y=(1-(p+E))*C,O=(d+m)*C,_=(A-T)*C,P=(d-m)*g,N=(1-(h+E))*g,S=(I+v)*g,L=(A+T)*R,B=(I-v)*R,x=(1-(h+p))*R;return t[0]=y,t[1]=O,t[2]=_,t[3]=0,t[4]=P,t[5]=N,t[6]=S,t[7]=0,t[8]=L,t[9]=B,t[10]=x,t[11]=0,t[12]=r[0]+b-(y*b+P*M+L*F),t[13]=r[1]+M-(O*b+N*M+B*F),t[14]=r[2]+F-(_*b+S*M+x*F),t[15]=1,t}function Me(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r+r,s=n+n,u=i+i,c=r*o,l=n*o,f=n*s,h=i*o,d=i*s,A=i*u,p=a*o,I=a*s,E=a*u;return t[0]=1-f-A,t[1]=l+E,t[2]=h-I,t[3]=0,t[4]=l-E,t[5]=1-c-A,t[6]=d+p,t[7]=0,t[8]=h+I,t[9]=d-p,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Fe(t,e,r,n,i,a,o){var s=1/(r-e),u=1/(i-n),c=1/(a-o);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*u,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(i+n)*u,t[10]=(o+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*c,t[15]=0,t}function ye(t,e,r,n,i){var a,o=1/Math.tan(e/2);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(n-i),t[10]=(i+n)*a,t[14]=2*i*n*a):(t[10]=-1,t[14]=-2*n),t}function Oe(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+s),c=2/(i+a);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-s)*u*.5,t[9]=(i-a)*c*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function _e(t,e,r,n,i,a,o){var s=1/(e-r),u=1/(n-i),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*u,t[14]=(o+a)*c,t[15]=1,t}function Pe(t,e,r,n){var i,a,o,s,u,c,l,f,h,A,p=e[0],I=e[1],E=e[2],v=n[0],T=n[1],m=n[2],C=r[0],g=r[1],R=r[2];return Math.abs(p-C)<d&&Math.abs(I-g)<d&&Math.abs(E-R)<d?te(t):(l=p-C,f=I-g,h=E-R,i=T*(h*=A=1/Math.sqrt(l*l+f*f+h*h))-m*(f*=A),a=m*(l*=A)-v*h,o=v*f-T*l,(A=Math.sqrt(i*i+a*a+o*o))?(i*=A=1/A,a*=A,o*=A):(i=0,a=0,o=0),s=f*o-h*a,u=h*i-l*o,c=l*a-f*i,(A=Math.sqrt(s*s+u*u+c*c))?(s*=A=1/A,u*=A,c*=A):(s=0,u=0,c=0),t[0]=i,t[1]=s,t[2]=l,t[3]=0,t[4]=a,t[5]=u,t[6]=f,t[7]=0,t[8]=o,t[9]=c,t[10]=h,t[11]=0,t[12]=-(i*p+a*I+o*E),t[13]=-(s*p+u*I+c*E),t[14]=-(l*p+f*I+h*E),t[15]=1,t)}function Ne(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=n[0],u=n[1],c=n[2],l=i-r[0],f=a-r[1],h=o-r[2],d=l*l+f*f+h*h;d>0&&(l*=d=1/Math.sqrt(d),f*=d,h*=d);var A=u*h-c*f,p=c*l-s*h,I=s*f-u*l;return(d=A*A+p*p+I*I)>0&&(A*=d=1/Math.sqrt(d),p*=d,I*=d),t[0]=A,t[1]=p,t[2]=I,t[3]=0,t[4]=f*I-h*p,t[5]=h*A-l*I,t[6]=l*p-f*A,t[7]=0,t[8]=l,t[9]=f,t[10]=h,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t}function Se(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Le(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function Be(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function xe(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function we(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function Ue(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function De(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Ge(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],A=t[11],p=t[12],I=t[13],E=t[14],v=t[15],T=e[0],m=e[1],C=e[2],g=e[3],R=e[4],b=e[5],M=e[6],F=e[7],y=e[8],O=e[9],_=e[10],P=e[11],N=e[12],S=e[13],L=e[14],B=e[15];return Math.abs(r-T)<=d*Math.max(1,Math.abs(r),Math.abs(T))&&Math.abs(n-m)<=d*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(i-C)<=d*Math.max(1,Math.abs(i),Math.abs(C))&&Math.abs(a-g)<=d*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(o-R)<=d*Math.max(1,Math.abs(o),Math.abs(R))&&Math.abs(s-b)<=d*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(u-M)<=d*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(c-F)<=d*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(l-y)<=d*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(f-O)<=d*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(h-_)<=d*Math.max(1,Math.abs(h),Math.abs(_))&&Math.abs(A-P)<=d*Math.max(1,Math.abs(A),Math.abs(P))&&Math.abs(p-N)<=d*Math.max(1,Math.abs(p),Math.abs(N))&&Math.abs(I-S)<=d*Math.max(1,Math.abs(I),Math.abs(S))&&Math.abs(E-L)<=d*Math.max(1,Math.abs(E),Math.abs(L))&&Math.abs(v-B)<=d*Math.max(1,Math.abs(v),Math.abs(B))}var Ve=ae,He=xe;function Xe(){var t=new A(3);return A!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function qe(t){var e=new A(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function ke(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)}function We(t,e,r){var n=new A(3);return n[0]=t,n[1]=e,n[2]=r,n}function je(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Qe(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function ze(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function Ke(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function Ye(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function Ze(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function Je(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function $e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function tr(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function er(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function rr(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function nr(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function ir(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t}function ar(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(r*r+n*n+i*i)}function or(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i}function sr(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function ur(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function cr(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function lr(t,e){var r=e[0],n=e[1],i=e[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function fr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function hr(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],s=r[1],u=r[2];return t[0]=i*u-a*s,t[1]=a*o-n*u,t[2]=n*s-i*o,t}function dr(t,e,r,n){var i=e[0],a=e[1],o=e[2];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=o+n*(r[2]-o),t}function Ar(t,e,r,n,i,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,c=o*(a-1),l=o*(3-2*a);return t[0]=e[0]*s+r[0]*u+n[0]*c+i[0]*l,t[1]=e[1]*s+r[1]*u+n[1]*c+i[1]*l,t[2]=e[2]*s+r[2]*u+n[2]*c+i[2]*l,t}function pr(t,e,r,n,i,a){var o=1-a,s=o*o,u=a*a,c=s*o,l=3*a*s,f=3*u*o,h=u*a;return t[0]=e[0]*c+r[0]*l+n[0]*f+i[0]*h,t[1]=e[1]*c+r[1]*l+n[1]*f+i[1]*h,t[2]=e[2]*c+r[2]*l+n[2]*f+i[2]*h,t}function Ir(t,e){e=e||1;var r=2*p()*Math.PI,n=2*p()-1,i=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=n*e,t}function Er(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,t[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,t[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,t[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,t}function vr(t,e,r){var n=e[0],i=e[1],a=e[2];return t[0]=n*r[0]+i*r[3]+a*r[6],t[1]=n*r[1]+i*r[4]+a*r[7],t[2]=n*r[2]+i*r[5]+a*r[8],t}function Tr(t,e,r){var n=r[0],i=r[1],a=r[2],o=r[3],s=e[0],u=e[1],c=e[2],l=i*c-a*u,f=a*s-n*c,h=n*u-i*s,d=i*h-a*f,A=a*l-n*h,p=n*f-i*l,I=2*o;return l*=I,f*=I,h*=I,d*=2,A*=2,p*=2,t[0]=s+l+d,t[1]=u+f+A,t[2]=c+h+p,t}function mr(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Cr(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function gr(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Rr(t,e){var r=We(t[0],t[1],t[2]),n=We(e[0],e[1],e[2]);lr(r,r),lr(n,n);var i=fr(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)}function br(t){return t[0]=0,t[1]=0,t[2]=0,t}function Mr(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Fr(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function yr(t,e){var r=t[0],n=t[1],i=t[2],a=e[0],o=e[1],s=e[2];return Math.abs(r-a)<=d*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=d*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=d*Math.max(1,Math.abs(i),Math.abs(s))}var Or,_r=Ke,Pr=Ye,Nr=Ze,Sr=ar,Lr=or,Br=ke,xr=sr,wr=(Or=Xe(),function(t,e,r,n,i,a){var o,s;for(e||(e=3),r||(r=0),s=n?Math.min(n*e+r,t.length):t.length,o=r;o<s;o+=e)Or[0]=t[o],Or[1]=t[o+1],Or[2]=t[o+2],i(Or,Or,a),t[o]=Or[0],t[o+1]=Or[1],t[o+2]=Or[2];return t});function Ur(){var t=new A(4);return A!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Dr(t){var e=new A(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Gr(t,e,r,n){var i=new A(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function Vr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Hr(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function Xr(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function qr(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function kr(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function Wr(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function jr(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Qr(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function zr(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function Kr(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function Yr(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Zr(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function Jr(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}function $r(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return Math.sqrt(r*r+n*n+i*i+a*a)}function tn(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return r*r+n*n+i*i+a*a}function en(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.sqrt(e*e+r*r+n*n+i*i)}function rn(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}function nn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function an(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function on(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=r*o,t[1]=n*o,t[2]=i*o,t[3]=a*o,t}function sn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function un(t,e,r,n){var i=r[0]*n[1]-r[1]*n[0],a=r[0]*n[2]-r[2]*n[0],o=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],u=r[1]*n[3]-r[3]*n[1],c=r[2]*n[3]-r[3]*n[2],l=e[0],f=e[1],h=e[2],d=e[3];return t[0]=f*c-h*u+d*s,t[1]=-l*c+h*o-d*a,t[2]=l*u-f*o+d*i,t[3]=-l*s+f*a-h*i,t}function cn(t,e,r,n){var i=e[0],a=e[1],o=e[2],s=e[3];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=o+n*(r[2]-o),t[3]=s+n*(r[3]-s),t}function ln(t,e){var r,n,i,a,o,s;e=e||1;do{o=(r=2*p()-1)*r+(n=2*p()-1)*n}while(o>=1);do{s=(i=2*p()-1)*i+(a=2*p()-1)*a}while(s>=1);var u=Math.sqrt((1-o)/s);return t[0]=e*r,t[1]=e*n,t[2]=e*i*u,t[3]=e*a*u,t}function fn(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,t[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,t[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,t[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,t}function hn(t,e,r){var n=e[0],i=e[1],a=e[2],o=r[0],s=r[1],u=r[2],c=r[3],l=c*n+s*a-u*i,f=c*i+u*n-o*a,h=c*a+o*i-s*n,d=-o*n-s*i-u*a;return t[0]=l*c+d*-o+f*-u-h*-s,t[1]=f*c+d*-s+h*-o-l*-u,t[2]=h*c+d*-u+l*-s-f*-o,t[3]=e[3],t}function dn(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function An(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function pn(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function In(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=d*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-c)<=d*Math.max(1,Math.abs(a),Math.abs(c))}var En=qr,vn=kr,Tn=Wr,mn=$r,Cn=tn,gn=en,Rn=rn,bn=function(){var t=Ur();return function(e,r,n,i,a,o){var s,u;for(r||(r=4),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,s=n;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();function Mn(){var t=new A(4);return A!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Fn(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function yn(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function On(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);return n>d?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function _n(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[0],u=r[1],c=r[2],l=r[3];return t[0]=n*l+o*s+i*c-a*u,t[1]=i*l+o*u+a*s-n*c,t[2]=a*l+o*c+n*u-i*s,t[3]=o*l-n*s-i*u-a*c,t}function Pn(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+o*s,t[1]=i*u+a*s,t[2]=a*u-i*s,t[3]=o*u-n*s,t}function Nn(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u-a*s,t[1]=i*u+o*s,t[2]=a*u+n*s,t[3]=o*u-i*s,t}function Sn(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+i*s,t[1]=i*u-n*s,t[2]=a*u+o*s,t[3]=o*u-a*s,t}function Ln(t,e){var r=e[0],n=e[1],i=e[2];return t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),t}function Bn(t,e,r,n){var i,a,o,s,u,c=e[0],l=e[1],f=e[2],h=e[3],A=r[0],p=r[1],I=r[2],E=r[3];return(a=c*A+l*p+f*I+h*E)<0&&(a=-a,A=-A,p=-p,I=-I,E=-E),1-a>d?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-n)*i)/o,u=Math.sin(n*i)/o):(s=1-n,u=n),t[0]=s*c+u*A,t[1]=s*l+u*p,t[2]=s*f+u*I,t[3]=s*h+u*E,t}function xn(t){var e=p(),r=p(),n=p(),i=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=a*Math.sin(2*Math.PI*n),t[3]=a*Math.cos(2*Math.PI*n),t}function wn(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=r*r+n*n+i*i+a*a,s=o?1/o:0;return t[0]=-r*s,t[1]=-n*s,t[2]=-i*s,t[3]=a*s,t}function Un(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Dn(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*a+a]-e[3*o+o]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*a+o]-e[3*o+a])*r,t[a]=(e[3*a+i]+e[3*i+a])*r,t[o]=(e[3*o+i]+e[3*i+o])*r}return t}function Gn(t,e,r,n){var i=.5*Math.PI/180;e*=i,r*=i,n*=i;var a=Math.sin(e),o=Math.cos(e),s=Math.sin(r),u=Math.cos(r),c=Math.sin(n),l=Math.cos(n);return t[0]=a*u*l-o*s*c,t[1]=o*s*l+a*u*c,t[2]=o*u*c-a*s*l,t[3]=o*u*l+a*s*c,t}function Vn(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Hn,Xn,qn,kn,Wn,jn,Qn=Dr,zn=Gr,Kn=Vr,Yn=Hr,Zn=Xr,Jn=_n,$n=Zr,ti=sn,ei=cn,ri=en,ni=ri,ii=rn,ai=ii,oi=on,si=pn,ui=In,ci=(Hn=Xe(),Xn=We(1,0,0),qn=We(0,1,0),function(t,e,r){var n=fr(e,r);return n<-.999999?(hr(Hn,Xn,e),Br(Hn)<1e-6&&hr(Hn,qn,e),lr(Hn,Hn),yn(t,Hn,Math.PI),t):n>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(hr(Hn,e,r),t[0]=Hn[0],t[1]=Hn[1],t[2]=Hn[2],t[3]=1+n,oi(t,t))}),li=(kn=Mn(),Wn=Mn(),function(t,e,r,n,i,a){return Bn(kn,e,i,a),Bn(Wn,r,n,a),Bn(t,kn,Wn,2*a*(1-a)),t}),fi=(jn=Et(),function(t,e,r,n){return jn[0]=r[0],jn[3]=r[1],jn[6]=r[2],jn[1]=n[0],jn[4]=n[1],jn[7]=n[2],jn[2]=-e[0],jn[5]=-e[1],jn[8]=-e[2],oi(t,Dn(t,jn))});function hi(){var t=new A(8);return A!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function di(t){var e=new A(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function Ai(t,e,r,n,i,a,o,s){var u=new A(8);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=i,u[5]=a,u[6]=o,u[7]=s,u}function pi(t,e,r,n,i,a,o){var s=new A(8);s[0]=t,s[1]=e,s[2]=r,s[3]=n;var u=.5*i,c=.5*a,l=.5*o;return s[4]=u*n+c*r-l*e,s[5]=c*n+l*t-u*r,s[6]=l*n+u*e-c*t,s[7]=-u*t-c*e-l*r,s}function Ii(t,e,r){var n=.5*r[0],i=.5*r[1],a=.5*r[2],o=e[0],s=e[1],u=e[2],c=e[3];return t[0]=o,t[1]=s,t[2]=u,t[3]=c,t[4]=n*c+i*u-a*s,t[5]=i*c+a*o-n*u,t[6]=a*c+n*s-i*o,t[7]=-n*o-i*s-a*u,t}function Ei(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function vi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Ti(t,e){var r=Mn();ge(r,e);var n=new A(3);return me(n,e),Ii(t,r,n),t}function mi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Ci(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function gi(t,e,r,n,i,a,o,s,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=u,t}var Ri=Kn;function bi(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var Mi=Kn;function Fi(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function yi(t,e){var r=e[4],n=e[5],i=e[6],a=e[7],o=-e[0],s=-e[1],u=-e[2],c=e[3];return t[0]=2*(r*c+a*o+n*u-i*s),t[1]=2*(n*c+a*s+i*o-r*u),t[2]=2*(i*c+a*u+r*s-n*o),t}function Oi(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=.5*r[0],u=.5*r[1],c=.5*r[2],l=e[4],f=e[5],h=e[6],d=e[7];return t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=o*s+i*c-a*u+l,t[5]=o*u+a*s-n*c+f,t[6]=o*c+n*u-i*s+h,t[7]=-n*s-i*u-a*c+d,t}function _i(t,e,r){var n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=s*o+l*n+u*a-c*i,h=u*o+l*i+c*n-s*a,d=c*o+l*a+s*i-u*n,A=l*o-s*n-u*i-c*a;return Pn(t,e,r),n=t[0],i=t[1],a=t[2],o=t[3],t[4]=f*o+A*n+h*a-d*i,t[5]=h*o+A*i+d*n-f*a,t[6]=d*o+A*a+f*i-h*n,t[7]=A*o-f*n-h*i-d*a,t}function Pi(t,e,r){var n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=s*o+l*n+u*a-c*i,h=u*o+l*i+c*n-s*a,d=c*o+l*a+s*i-u*n,A=l*o-s*n-u*i-c*a;return Nn(t,e,r),n=t[0],i=t[1],a=t[2],o=t[3],t[4]=f*o+A*n+h*a-d*i,t[5]=h*o+A*i+d*n-f*a,t[6]=d*o+A*a+f*i-h*n,t[7]=A*o-f*n-h*i-d*a,t}function Ni(t,e,r){var n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=s*o+l*n+u*a-c*i,h=u*o+l*i+c*n-s*a,d=c*o+l*a+s*i-u*n,A=l*o-s*n-u*i-c*a;return Sn(t,e,r),n=t[0],i=t[1],a=t[2],o=t[3],t[4]=f*o+A*n+h*a-d*i,t[5]=h*o+A*i+d*n-f*a,t[6]=d*o+A*a+f*i-h*n,t[7]=A*o-f*n-h*i-d*a,t}function Si(t,e,r){var n=r[0],i=r[1],a=r[2],o=r[3],s=e[0],u=e[1],c=e[2],l=e[3];return t[0]=s*o+l*n+u*a-c*i,t[1]=u*o+l*i+c*n-s*a,t[2]=c*o+l*a+s*i-u*n,t[3]=l*o-s*n-u*i-c*a,s=e[4],u=e[5],c=e[6],l=e[7],t[4]=s*o+l*n+u*a-c*i,t[5]=u*o+l*i+c*n-s*a,t[6]=c*o+l*a+s*i-u*n,t[7]=l*o-s*n-u*i-c*a,t}function Li(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[0],u=r[1],c=r[2],l=r[3];return t[0]=n*l+o*s+i*c-a*u,t[1]=i*l+o*u+a*s-n*c,t[2]=a*l+o*c+n*u-i*s,t[3]=o*l-n*s-i*u-a*c,s=r[4],u=r[5],c=r[6],l=r[7],t[4]=n*l+o*s+i*c-a*u,t[5]=i*l+o*u+a*s-n*c,t[6]=a*l+o*c+n*u-i*s,t[7]=o*l-n*s-i*u-a*c,t}function Bi(t,e,r,n){if(Math.abs(n)<d)return mi(t,e);var i=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);n*=.5;var a=Math.sin(n),o=a*r[0]/i,s=a*r[1]/i,u=a*r[2]/i,c=Math.cos(n),l=e[0],f=e[1],h=e[2],A=e[3];t[0]=l*c+A*o+f*u-h*s,t[1]=f*c+A*s+h*o-l*u,t[2]=h*c+A*u+l*s-f*o,t[3]=A*c-l*o-f*s-h*u;var p=e[4],I=e[5],E=e[6],v=e[7];return t[4]=p*c+v*o+I*u-E*s,t[5]=I*c+v*s+E*o-p*u,t[6]=E*c+v*u+p*s-I*o,t[7]=v*c-p*o-I*s-E*u,t}function xi(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t}function wi(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[4],u=r[5],c=r[6],l=r[7],f=e[4],h=e[5],d=e[6],A=e[7],p=r[0],I=r[1],E=r[2],v=r[3];return t[0]=n*v+o*p+i*E-a*I,t[1]=i*v+o*I+a*p-n*E,t[2]=a*v+o*E+n*I-i*p,t[3]=o*v-n*p-i*I-a*E,t[4]=n*l+o*s+i*c-a*u+f*v+A*p+h*E-d*I,t[5]=i*l+o*u+a*s-n*c+h*v+A*I+d*p-f*E,t[6]=a*l+o*c+n*u-i*s+d*v+A*E+f*I-h*p,t[7]=o*l-n*s-i*u-a*c+A*v-f*p-h*I-d*E,t}var Ui=wi;function Di(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t}var Gi=ti;function Vi(t,e,r,n){var i=1-n;return Gi(e,r)<0&&(n=-n),t[0]=e[0]*i+r[0]*n,t[1]=e[1]*i+r[1]*n,t[2]=e[2]*i+r[2]*n,t[3]=e[3]*i+r[3]*n,t[4]=e[4]*i+r[4]*n,t[5]=e[5]*i+r[5]*n,t[6]=e[6]*i+r[6]*n,t[7]=e[7]*i+r[7]*n,t}function Hi(t,e){var r=Wi(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t}function Xi(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var qi=ri,ki=qi,Wi=ii,ji=Wi;function Qi(t,e){var r=Wi(e);if(r>0){r=Math.sqrt(r);var n=e[0]/r,i=e[1]/r,a=e[2]/r,o=e[3]/r,s=e[4],u=e[5],c=e[6],l=e[7],f=n*s+i*u+a*c+o*l;t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=(s-n*f)/r,t[5]=(u-i*f)/r,t[6]=(c-a*f)/r,t[7]=(l-o*f)/r}return t}function zi(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function Ki(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function Yi(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=e[0],f=e[1],h=e[2],A=e[3],p=e[4],I=e[5],E=e[6],v=e[7];return Math.abs(r-l)<=d*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-f)<=d*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(i-h)<=d*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(a-A)<=d*Math.max(1,Math.abs(a),Math.abs(A))&&Math.abs(o-p)<=d*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-I)<=d*Math.max(1,Math.abs(s),Math.abs(I))&&Math.abs(u-E)<=d*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-v)<=d*Math.max(1,Math.abs(c),Math.abs(v))}function Zi(){var t=new A(2);return A!=Float32Array&&(t[0]=0,t[1]=0),t}function Ji(t){var e=new A(2);return e[0]=t[0],e[1]=t[1],e}function $i(t,e){var r=new A(2);return r[0]=t,r[1]=e,r}function ta(t,e){return t[0]=e[0],t[1]=e[1],t}function ea(t,e,r){return t[0]=e,t[1]=r,t}function ra(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function na(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function ia(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function aa(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function oa(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function sa(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function ua(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function ca(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function la(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function fa(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function ha(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t}function da(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)}function Aa(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n}function pa(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)}function Ia(t){var e=t[0],r=t[1];return e*e+r*r}function Ea(t,e){return t[0]=-e[0],t[1]=-e[1],t}function va(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function Ta(t,e){var r=e[0],n=e[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function ma(t,e){return t[0]*e[0]+t[1]*e[1]}function Ca(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t}function ga(t,e,r,n){var i=e[0],a=e[1];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t}function Ra(t,e){e=e||1;var r=2*p()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function ba(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t}function Ma(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t}function Fa(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t}function ya(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t}function Oa(t,e,r,n){var i=e[0]-r[0],a=e[1]-r[1],o=Math.sin(n),s=Math.cos(n);return t[0]=i*s-a*o+r[0],t[1]=i*o+a*s+r[1],t}function _a(t,e){var r=t[0],n=t[1],i=e[0],a=e[1],o=r*r+n*n;o>0&&(o=1/Math.sqrt(o));var s=i*i+a*a;s>0&&(s=1/Math.sqrt(s));var u=(r*i+n*a)*o*s;return u>1?0:u<-1?Math.PI:Math.acos(u)}function Pa(t){return t[0]=0,t[1]=0,t}function Na(t){return"vec2("+t[0]+", "+t[1]+")"}function Sa(t,e){return t[0]===e[0]&&t[1]===e[1]}function La(t,e){var r=t[0],n=t[1],i=e[0],a=e[1];return Math.abs(r-i)<=d*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=d*Math.max(1,Math.abs(n),Math.abs(a))}var Ba=pa,xa=na,wa=ia,Ua=aa,Da=da,Ga=Aa,Va=Ia,Ha=function(){var t=Zi();return function(e,r,n,i,a,o){var s,u;for(r||(r=2),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,s=n;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],a(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}}();r.d(e,"glMatrix",(function(){return n})),r.d(e,"mat2",(function(){return i})),r.d(e,"mat2d",(function(){return a})),r.d(e,"mat3",(function(){return o})),r.d(e,"mat4",(function(){return s})),r.d(e,"quat",(function(){return l})),r.d(e,"quat2",(function(){return f})),r.d(e,"vec2",(function(){return h})),r.d(e,"vec3",(function(){return u})),r.d(e,"vec4",(function(){return c}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(52),i=r(0),a=function(){function t(t,e,r,n){if(this.gl=t,this.width=e,this.height=r,this.withDepth=n,this.isReady=!0,this._disposed=!1,this._glVersion=1,this.width=e=Math.floor(e),this.height=r=Math.floor(r),0!==e&&0!==r){if("undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext?this._glVersion=2:this._glVersion=1,this.framebuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),this.renderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.renderbuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e,r),this.texture=t.createTexture(),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,r,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,1),n&&(this.depthTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.depthTexture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),1===this._glVersion?t.texImage2D(t.TEXTURE_2D,0,t.DEPTH_COMPONENT,e,r,0,t.DEPTH_COMPONENT,t.UNSIGNED_SHORT,null):t.texImage2D(t.TEXTURE_2D,0,t.DEPTH_COMPONENT16,e,r,0,t.DEPTH_COMPONENT,t.UNSIGNED_SHORT,null)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0),n?t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,this.depthTexture,0):t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.renderbuffer),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE)throw new Error("this combination of attachments does not work")}else this.isReady=!1}return Object.defineProperty(t.prototype,"depthReader",{get:function(){return null!=this._depthReader||(this._depthReader=new n.DepthReader(this.gl)),this._depthReader},enumerable:!0,configurable:!0}),t.prototype.bind=function(){if(this.isReady){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.bindRenderbuffer(t.RENDERBUFFER,this.renderbuffer)}},t.prototype.getPixel=function(t,e){if(!this.isReady)return null;var r=new Uint8Array(4);return this.gl.readPixels(t,e,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,r),r},t.prototype.getDepth=function(t,e){return this.isReady?this.withDepth?this.depthReader.getDepth(t,e,this.depthTexture,this.width,this.height):-1:null},t.prototype.getDepths=function(t){return this.withDepth&&this.isReady?this.depthReader.getDepths(t,this.depthTexture,this.width,this.height):null},t.prototype.getXYZArray=function(t){var e=this;return this.withDepth&&this.isReady?this.getDepths(t).map((function(r,n){if(255===r)return null;var a=t[n],o=a.x/e.width*2-1,s=a.y/e.height*2-1,u=2*(r/255-.5);return i.vec3.fromValues(o,s,u)})):null},t.prototype.getXYZ=function(t,e){return this.withDepth&&this.isReady?this.getXYZArray([{x:t,y:e}])[0]:null},t.prototype.getXYZRange=function(t,e){if(!this.withDepth||!this.isReady)return null;var r=this.getDepth(t,e);if(255===r)return null;var n=t/this.width*2-1,a=e/this.height*2-1,o=2*(r/255-.5),s=2*(Math.max(r-1,0)/255-.5),u=2*(Math.min(r+1,255)/255-.5);return{far:i.vec3.fromValues(n,a,u),near:i.vec3.fromValues(n,a,s),middle:i.vec3.fromValues(n,a,o)}},t.prototype.getId=function(t,e){if(!this.isReady)return null;var r=this.getPixel(t,e);return 0!==r[3]?r[0]+256*r[1]+256*r[2]*256:null},t.prototype.getIds=function(t){var e=this;return this.isReady?t.map((function(t){var r=e.getPixel(t.x,t.y);return 0!==r[3]?r[0]+256*r[1]+256*r[2]*256:null})):null},t.prototype.getImageDataArray=function(){if(!this.isReady)return null;var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.bindRenderbuffer(t.RENDERBUFFER,this.renderbuffer);var e=new Uint8Array(this.width*this.height*4);t.readPixels(0,0,this.width,this.height,t.RGBA,t.UNSIGNED_BYTE,e);for(var r=new Uint8ClampedArray(this.width*this.height*4),n=0;n<this.height;n++){var i=e.subarray(n*this.width*4,(n+1)*this.width*4),a=this.height-n-1;r.set(new Uint8ClampedArray(i),a*this.width*4)}return r},t.prototype.get2DCanvas=function(){if(!this.isReady)return document.createElement("canvas");var t=this.getImageDataArray(),e=document.createElement("canvas");e.width=this.width,e.height=this.height;var r=e.getContext("2d"),n=r.createImageData(this.width,this.height);return n.data.set(new Uint8ClampedArray(t)),r.putImageData(n,0,0),e},t.prototype.getImageDataUrl=function(t){return void 0===t&&(t="png"),this.isReady?this.get2DCanvas().toDataURL("image/"+t):null},t.prototype.getImageDataBlob=function(t,e){void 0===e&&(e="png"),this.isReady&&this.get2DCanvas().toBlob(t,"image/"+e)},t.prototype.delete=function(){!this._disposed&&this.isReady&&(this.gl.deleteFramebuffer(this.framebuffer),this.gl.deleteRenderbuffer(this.renderbuffer),this.gl.deleteTexture(this.texture),this.gl.deleteTexture(this.depthTexture),null!=this._depthReader&&this._depthReader.delete(),this._disposed=!0)},t}();e.Framebuffer=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Message=function(){},function(t){t[t.PROGRESS=0]="PROGRESS",t[t.COMPLETED=1]="COMPLETED",t[t.FAILED=2]="FAILED"}(e.MessageType||(e.MessageType={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=r(0),a=function(){function t(t){this._fov=45,this._type=n.PERSPECTIVE,this.onChange=function(){},this.onChange=t||function(){}}return Object.defineProperty(t.prototype,"fov",{get:function(){return this._fov},set:function(t){if(null==t||t<=0||t>180)throw new Error("Perspective field of view has to be a positive number between 0 and 180 degrees");this._fov=t,this.onChange&&this.type===n.PERSPECTIVE&&this.onChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"near",{get:function(){return this._near},set:function(t){this._near=t,this.onChange&&this.onChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"far",{get:function(){return this._far},set:function(t){this._far=t,this.onChange&&this.onChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(t){if(null==t||t<=0)throw new Error("Orthographic view height has to be a positive number");this._height=t,this.onChange&&this.type===n.ORTHOGONAL&&this.onChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this.onChange&&this.onChange()},enumerable:!0,configurable:!0}),t.prototype.getProjectionMatrix=function(t,e){var r=t/e;switch(this.type){case n.PERSPECTIVE:return i.mat4.perspective(i.mat4.create(),this.fov*Math.PI/180,r,this.near,this.far);case n.ORTHOGONAL:var a=this.height,o=a*r;return i.mat4.ortho(i.mat4.create(),o/-2,o/2,a/-2,a/2,this.near,this.far);default:throw new Error("Undefined camera type")}},t}();e.CameraProperties=a,function(t){t[t.PERSPECTIVE=0]="PERSPECTIVE",t[t.ORTHOGONAL=1]="ORTHOGONAL"}(n=e.CameraType||(e.CameraType={}))},function(t,e,r){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.UNDEFINED=255]="UNDEFINED",t[t.HIDDEN=254]="HIDDEN",t[t.HIGHLIGHTED=253]="HIGHLIGHTED",t[t.XRAYVISIBLE=252]="XRAYVISIBLE",t[t.PICKING_ONLY=251]="PICKING_ONLY",t[t.UNSTYLED=225]="UNSTYLED"}(n=e.State||(e.State={}));var i=function(){function t(){}return t.getPriority=function(t){switch(t){case n.HIGHLIGHTED:return 1;case n.PICKING_ONLY:return 2;case n.HIDDEN:return 3;case n.XRAYVISIBLE:return 4;default:return 100}},t.getHighestPriority=function(t){var e=this;if(null==t||0===t.length)return null;if(1===t.length)return t[0];var r=t.map((function(t){return{state:t,priority:e.getPriority(t)}}));r.sort((function(t,e){return t.priority-e.priority}));var i=r[0];return i.priority>50?n.UNDEFINED:i.state},t}();e.StatePriorities=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Visibility=function(){this.default_visibility=!1}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Components=function(){}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Component=function(t){this.ifc_guid=t,this.originating_system="xBIM",this.authoring_tool_id="WebUI"}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ClippingPlane=function(){}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),i=function(){function t(t){var e=this;this.setToInfinity(),this._onChange=function(){e._lastWcs=null,e._lastBBox=null,t&&t()}}return Object.defineProperty(t.prototype,"location",{get:function(){return this._location},set:function(t){this._location=t,this._onChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotationX",{get:function(){return this._rotationX},set:function(t){this._rotationX=t,this._onChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotationY",{get:function(){return this._rotationY},set:function(t){this._rotationY=t,this._onChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotationZ",{get:function(){return this._rotationZ},set:function(t){this._rotationZ=t,this._onChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthX",{get:function(){return this._lengthX},set:function(t){this._lengthX=t,this._onChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthY",{get:function(){return this._lengthY},set:function(t){this._lengthY=t,this._onChange()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthZ",{get:function(){return this._lengthZ},set:function(t){this._lengthZ=t,this._onChange()},enumerable:!0,configurable:!0}),t.prototype.getMatrix=function(t){var e=n.mat4.create();e=n.mat4.rotateX(n.mat4.create(),e,-this.rotationX/180*Math.PI),e=n.mat4.rotateY(n.mat4.create(),e,-this.rotationY/180*Math.PI),e=n.mat4.rotateZ(n.mat4.create(),e,-this.rotationZ/180*Math.PI);var r=n.vec3.subtract(n.vec3.create(),this.location,t),i=n.vec3.scale(n.vec3.create(),r,-1);e=n.mat4.translate(n.mat4.create(),e,i);var a=n.mat4.ortho(n.mat4.create(),-this.lengthX/2,this.lengthX/2,-this.lengthY/2,this.lengthY/2,-this.lengthZ/2,this.lengthZ/2);return n.mat4.multiply(n.mat4.create(),a,e)},Object.defineProperty(t.prototype,"isSet",{get:function(){return Number.isFinite(this._lengthX)},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this.setToInfinity()},t.prototype.setToInfinity=function(){this._location=n.vec3.fromValues(0,0,0),this._rotationX=this._rotationY=this._rotationZ=0,this._lengthX=this._lengthY=this._lengthZ=Number.POSITIVE_INFINITY,this._onChange&&this._onChange()},t.prototype.setToBox=function(t){this._location=n.vec3.clone(t.location),this._lengthX=t._lengthX,this._lengthY=t._lengthY,this._lengthZ=t._lengthZ,this._rotationX=t._rotationX,this._rotationY=t._rotationY,this._rotationZ=t._rotationZ,this._onChange&&this._onChange()},t.prototype.setToBoundingBox=function(t){this._location=n.vec3.fromValues(t[0]+t[3]/2,t[1]+t[4]/2,t[2]+t[5]/2),this._lengthX=t[3],this._lengthY=t[4],this._lengthZ=t[5],this._rotationX=0,this._rotationY=0,this._rotationZ=0,this._onChange&&this._onChange()},t.prototype.setToPlanes=function(t){if(null==t||6!=t.length)throw new Error("Invalid input: box has to be defined by 3 clipping planes");for(var e=[],r=[],i=0;i<6;i++)for(var a=t[i],o=i+1;o<6;o++){var s=t[o];if(this.areOrthogonal(a,s))for(var u=o+1;u<6;u++){var c=t[u];if(this.areOrthogonal(a,c)&&this.areOrthogonal(s,c)){var l=a.direction,f=s.direction,h=c.direction,d=a.location,A=s.location,p=c.location,I=this.getDparam(l,d),E=this.getDparam(f,A),v=this.getDparam(h,p),T=n.vec3.fromValues(-I,-E,-v),m=n.mat3.fromValues(l[0],f[0],h[0],l[1],f[1],h[1],l[2],f[2],h[2]),C=n.mat3.determinant(m);if(Math.abs(C)<1e-6)console.warn("Singular system of linear equations. Intersection point for section box can't be computed");else{var g=n.mat3.invert(n.mat3.create(),m),R=n.vec3.transformMat3(n.vec3.create(),T,g);r.push(R),this.addPointToResults(e,a,R),this.addPointToResults(e,s,R),this.addPointToResults(e,c,R)}}}}if(8!==r.length)return console.warn("Section box based on clipping planes should have exactly 8 intersection points"),!1;var b=this.getCentroid(r),M=this.getSize(e[0].plane,t),F=this.getSize(e[1].plane,t),y=this.getSize(e[2].plane,t);if(null==M||null==F||null==y)return console.warn("Section box based on clipping planes should have always two planes pointing to opposite direction"),!1;var O=n.vec3.normalize(n.vec3.create(),e[0].plane.direction),_=n.vec3.normalize(n.vec3.create(),e[1].plane.direction),P=n.vec3.normalize(n.vec3.create(),e[2].plane.direction),N=n.quat.setAxes(n.quat.create(),n.vec3.negate(n.vec3.create(),P),O,_),S=this.toEulerAngles(N);return this._location=b,this._lengthX=M,this._lengthY=F,this._lengthZ=y,this._rotationX=180*S.roll/Math.PI,this._rotationY=180*S.pitch/Math.PI,this._rotationZ=180*S.yaw/Math.PI,this._onChange&&this._onChange(),!0},t.prototype.getSize=function(t,e){var r=this,i=e.filter((function(e){return r.isOpposite(t.direction,e.direction)})).pop();if(null==i)return null;var a=i.direction[0],o=i.direction[1],s=i.direction[2],u=this.getDparam(i.direction,i.location),c=t.location[0],l=t.location[1],f=t.location[2];return Math.abs(a*c+o*l+s*f+u)/n.vec3.length(i.direction)},t.prototype.toEulerAngles=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=2*(i*e+r*n),o=1-2*(e*e+r*r),s=2*(i*r-n*e),u=2*(i*n+e*r),c=1-2*(r*r+n*n);return{roll:Math.atan2(a,o),pitch:Math.abs(s)>=1?Math.PI/2*Math.sign(s):Math.asin(s),yaw:Math.atan2(u,c)}},t.prototype.isOpposite=function(t,e){var r=n.vec3.angle(t,e);return Math.abs(r-Math.PI)<1e-6},t.prototype.getCentroid=function(t){var e=t.reduce((function(t,e){return n.vec3.add(n.vec3.create(),t,e)}));return n.vec3.scale(n.vec3.create(),e,1/t.length)},t.prototype.addPointToResults=function(t,e,r){var n=t.filter((function(t){return t.plane===e})).pop();null==n&&(n={plane:e,points:[]},t.push(n)),n.points.push(r)},t.prototype.getDparam=function(t,e){return-t[0]*e[0]-t[1]*e[1]-t[2]*e[2]},t.prototype.areOrthogonal=function(t,e){var r=n.vec3.angle(t.direction,e.direction);return Math.abs(r-Math.PI/2)<1e-6},t.prototype.getBoundingBox=function(t){if(this._lastBBox&&this._lastWcs&&n.vec3.distance(this._lastWcs,t)<1e-6)return this._lastBBox;var e=this.lengthX/2,r=this.lengthY/2,i=this.lengthZ/2,a=[[-e,-r,-i],[-e,-r,+i],[-e,+r,-i],[-e,+r,+i],[+e,-r,-i],[+e,-r,+i],[+e,+r,-i],[+e,+r,+i]],o=n.vec3.subtract(n.vec3.create(),this.location,t),s=n.mat4.create();s=n.mat4.rotateX(n.mat4.create(),s,this.rotationX*Math.PI/180),s=n.mat4.rotateY(n.mat4.create(),s,this.rotationY*Math.PI/180),s=n.mat4.rotateZ(n.mat4.create(),s,this.rotationZ*Math.PI/180),s=n.mat4.translate(n.mat4.create(),s,o);var u=a.map((function(t){return n.vec3.transformMat4(n.vec3.create(),t,s)})),c=u.reduce((function(t,e){return n.vec3.fromValues(Math.min(t[0],e[0]),Math.min(t[1],e[1]),Math.min(t[2],e[2]))})),l=u.reduce((function(t,e){return n.vec3.fromValues(Math.max(t[0],e[0]),Math.max(t[1],e[1]),Math.max(t[2],e[2]))}));return this._lastWcs=t,this._lastBBox=new Float32Array([c[0],c[1],c[2],l[0]-c[0],l[1]-c[1],l[2]-c[2]]),this._lastBBox},t}();e.SectionBox=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=r(0);!function(t){t[t.LINEAR=0]="LINEAR",t[t.SINUS=1]="SINUS",t[t.SINUS2=2]="SINUS2",t[t.CIRCLE=3]="CIRCLE"}(n=e.EasingType||(e.EasingType={}));var a=function(){function t(t){var e=this;this.viewer=t,this._rotationOn=!1,this.setTimeout=window.setTimeout.bind(window),this.requestAnimationFrame=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}).bind(window),t.canvas.addEventListener("mousedown",(function(){return e.clear()})),t.canvas.addEventListener("touchstart",(function(){return e.clear()}))}return t.prototype.clear=function(){t.viewQueue=[],t.zoomQueue=[],this._rotationOn=!1},t.prototype.startRotation=function(){var t=this;return this._rotationOn?new Promise((function(t,e){t()})):(this._rotationOn=!0,new Promise((function(e,r){var n=function(){t._rotationOn?(t.viewer.mvMatrix=i.mat4.rotateZ(i.mat4.create(),t.viewer.mvMatrix,.2*Math.PI/180),t.requestAnimationFrame(n)):e()};n()})))},t.prototype.stopRotation=function(){this._rotationOn=!1},t.prototype.viewTo=function(e,r,a){var o=this;return void 0===a&&(a=n.SINUS2),new Promise((function(s,u){if(r<=0)return o.viewer.mvMatrix=e.mv,o.viewer.cameraProperties.height=e.height,void s();var c;if(c=t.viewQueue.length>0?t.viewQueue[t.viewQueue.length-1]:{mv:i.mat4.copy(i.mat4.create(),o.viewer.mvMatrix),height:o.viewer.cameraProperties.height},i.mat4.equals(c.mv,e.mv)&&Math.abs(c.height-e.height)<1e-6)s();else{var l=i.mat4.getRotation(i.quat.create(),c.mv),f=i.mat4.getScaling(i.vec3.create(),c.mv),h=i.mat4.getTranslation(i.vec3.create(),c.mv),d=null,A=i.mat4.getRotation(i.quat.create(),e.mv),p=i.mat4.getScaling(i.vec3.create(),e.mv),I=i.mat4.getTranslation(i.vec3.create(),e.mv);t.viewQueue.push(e);var E=function(){if(t.viewQueue[0]!==e)return null!=t.viewQueue.filter((function(t){return t===e})).pop()?void o.requestAnimationFrame(E):void s();null==d&&(d=Date.now());var u=Date.now();if(!(u<d+r))return o.viewer.mvMatrix=e.mv,o.viewer.cameraProperties.height=e.height,t.viewQueue.shift(),void s();var v=(u-d)/r;switch(a){case n.LINEAR:break;case n.CIRCLE:v=o.getCircleEasing(v);break;case n.SINUS:v=o.getSinEasing(v);break;case n.SINUS2:v=o.getSinEasing(v),v=o.getSinEasing(v)}var T=i.quat.slerp(i.quat.create(),l,A,v),m=i.vec3.lerp(i.vec3.create(),f,p,v),C=i.vec3.lerp(i.vec3.create(),h,I,v),g=(e.height-c.height)*v,R=i.mat4.fromRotationTranslationScaleOrigin(i.mat4.create(),T,C,m,i.vec3.create());o.viewer.mvMatrix=R,o.viewer.cameraProperties.height=c.height+g,o.requestAnimationFrame(E)};E()}}))},t.prototype.addZoom=function(e,r,n){var a=this,o=i.mat4.copy(i.mat4.create(),this.viewer.mvMatrix),s=this.viewer.cameraProperties.height;if(t.zoomQueue.length>0){var u=t.zoomQueue[t.zoomQueue.length-1];o=u.mv,s=u.height}var c=i.vec3.create();if(n)n=i.vec3.normalize(i.vec3.create(),n),i.vec3.negate(c,n);else{var l=i.mat4.invert(i.mat4.create(),o),f=i.mat4.getRotation(i.quat.create(),l),h=i.vec3.transformQuat(i.vec3.create(),i.vec3.fromValues(0,0,-1),f);i.vec3.negate(c,h)}var d=i.vec3.scale(i.vec3.create(),c,e),A=this.viewer.cameraProperties.fov*Math.PI/180,p=2*e*Math.tan(A/2),I=2*this.viewer.cameraProperties.near*Math.tan(A/2);s-p<I&&(p=0);var E={mv:i.mat4.translate(i.mat4.create(),o,d),height:s-p};return new Promise((function(e,n){if(r<=0)return t.zoomQueue=[],a.viewer.mvMatrix=E.mv,a.viewer.cameraProperties.height=E.height,void e();var u=null,c=d;t.zoomQueue.push(E);var l=function(){if(t.zoomQueue[0]!==E)return null!=t.zoomQueue.filter((function(t){return t===E})).pop()?void a.requestAnimationFrame(l):void e();null==u&&(u=Date.now());var n=Date.now();if(!(n<u+r))return a.viewer.mvMatrix=E.mv,a.viewer.cameraProperties.height=E.height,t.zoomQueue.shift(),void e();var f=(n-u)/r,h=i.vec3.lerp(i.vec3.create(),i.vec3.create(),c,f),d=p*f;a.viewer.mvMatrix=i.mat4.translate(i.mat4.create(),o,h),a.viewer.cameraProperties.height=s-d,a.requestAnimationFrame(l)};l()}))},t.prototype.getCircleEasing=function(t){if(t<=.5){var e=2*t;return(1-Math.sqrt(1-e*e))/2}return e=2*t-2,(1+Math.sqrt(1-e*e))/2},t.prototype.getSinEasing=function(t){var e=t*Math.PI-Math.PI/2;return.5*Math.sin(e)+.5},t.viewQueue=[],t.zoomQueue=[],t}();e.Animations=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.makeFailHTML=function(t){return'<table style="background-color: #8CE; width: 100%; height: 100%;"><tr><td align="center"><div style="display: table-cell; vertical-align: middle;"><div style="">'+t+"</div></div></td></tr></table>"},t.setupWebGL=function(e,r,n,i){i=i||function(r){var n=e.parentNode;if(n){var i="undefined"!=typeof WebGLRenderingContext?t.OTHER_PROBLEM:t.GET_A_WEBGL_BROWSER;r&&(i+="<br/><br/>Status: "+r),n.innerHTML=t.makeFailHTML(i)}},e.addEventListener&&e.addEventListener("webglcontextcreationerror",(function(t){i(t.statusMessage)}),!1),t.create3DContext(e,r,n)},t.create3DContext=function(t,e,r){var n=null;try{if(null!=(n=t.getContext("webgl2",r)))return void e(n,2)}catch(t){}for(var i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],a=0;a<i.length;++a){try{n=t.getContext(i[a],r)}catch(t){}if(n)break}e(n,1)},t.GET_A_WEBGL_BROWSER='This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>',t.OTHER_PROBLEM='It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>',t}();e.WebGLUtils=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),i=function(){function t(){}return t.centre=function(t){return[t[0]+t[3]/2,t[1]+t[4]/2,t[2]+t[5]/2]},t.union=function(t,e){var r=[t[0],t[1],t[2]],n=[e[0],e[1],e[2]],i=[t[0]+t[3],t[1]+t[4],t[2]+t[5]],a=[e[0]+e[3],e[1]+e[4],e[2]+e[5]],o=[Math.min(r[0],n[0]),Math.min(r[1],n[1]),Math.min(r[2],n[2])],s=[Math.max(i[0],a[0]),Math.max(i[1],a[1]),Math.max(i[2],a[2])];return[o[0],o[1],o[2],s[0]-o[0],s[1]-o[1],s[2]-o[2]]},t.intersection=function(e,r){if(null==e||null==r||t.areDisjoint(e,r))return null;var n=[e[0],e[1],e[2]],i=[r[0],r[1],r[2]],a=[e[0]+e[3],e[1]+e[4],e[2]+e[5]],o=[r[0]+r[3],r[1]+r[4],r[2]+r[5]],s=[Math.max(n[0],i[0]),Math.max(n[1],i[1]),Math.max(n[2],i[2])],u=[Math.min(a[0],o[0]),Math.min(a[1],o[1]),Math.min(a[2],o[2])];return[s[0],s[1],s[2],u[0]-s[0],u[1]-s[1],u[2]-s[2]]},t.areDisjoint=function(t,e){if(null==t||null==e)throw new Error("Bounding box is not defined");var r=[t[0],t[1],t[2]],n=[e[0],e[1],e[2]],i=[t[0]+t[3],t[1]+t[4],t[2]+t[5]],a=[e[0]+e[3],e[1]+e[4],e[2]+e[5]];return r[0]>a[0]||r[1]>a[1]||r[2]>a[2]||n[0]>i[0]||n[1]>i[1]||n[2]>i[2]},t.getSizeInView=function(t,e,r){e=n.vec3.normalize(n.vec3.create(),e),r=n.vec3.normalize(n.vec3.create(),r);var i=n.vec3.negate(n.vec3.create(),e),a=Math.max(t[3],t[4],t[5]),o=n.vec3.fromValues(t[0]+t[3]/2,t[1]+t[4]/2,t[2]+t[5]/2),s=n.vec3.scale(n.vec3.create(),i,a),u=n.vec3.add(n.vec3.create(),o,s),c=n.mat4.lookAt(n.mat4.create(),u,o,r),l=Array.prototype.slice.call(c.slice(0,3)),f=Array.prototype.slice.call(c.slice(4,7)),h=Array.prototype.slice.call(c.slice(8,11)),d=n.vec3.scale(n.vec3.create(),l,t[0]),A=n.vec3.scale(n.vec3.create(),l,t[0]+t[3]),p=n.vec3.scale(n.vec3.create(),f,t[1]),I=n.vec3.scale(n.vec3.create(),f,t[1]+t[4]),E=n.vec3.scale(n.vec3.create(),h,t[2]),v=n.vec3.scale(n.vec3.create(),h,t[2]+t[5]),T=n.vec3.min(n.vec3.create(),d,A),m=n.vec3.min(n.vec3.create(),p,I),C=n.vec3.min(n.vec3.create(),E,v),g=n.vec3.max(n.vec3.create(),d,A),R=n.vec3.max(n.vec3.create(),p,I),b=n.vec3.max(n.vec3.create(),E,v),M=[T[0]+m[0]+C[0],T[1]+m[1]+C[1],T[2]+m[2]+C[2]],F=[g[0]+R[0]+b[0],g[1]+R[1]+b[1],g[2]+R[2]+b[2]],y=n.vec3.sub(n.vec3.create(),F,M);return{width:1*y[0],height:1*y[1],depth:y[2]}},t.none=[Number.MAX_VALUE/2,Number.MAX_VALUE/2,Number.MAX_VALUE/2,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],t}();e.BBox=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(4),i=function(){function t(){this.states=[]}return t.clone=function(e){var r=new t;return r.productID=e.productID,r.renderId=e.renderId,r.type=e.type,r.bBox=new Float32Array(e.bBox),r.spans=e.spans,r.states=e.states.slice(0),r},t.addState=function(t,e){null==t.states.find((function(t){return t===e}))&&t.states.push(e)},t.removeState=function(t,e){var r=t.states.indexOf(e);r<0||t.states.splice(r,1)},t.getState=function(t){return null==t.states||0===t.states.length?n.State.UNDEFINED:n.StatePriorities.getHighestPriority(t.states)},t}();e.ProductMap=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),i=function(){function t(){this._buffer=null,this._view=null,this._position=0,this._progress=function(t){},this._lastProgress=0}return Object.defineProperty(t.prototype,"Position",{get:function(){return this._position},enumerable:!0,configurable:!0}),t.prototype.getSubReader=function(e){var r=new t,n=this._buffer.slice(this._position,this._position+e);return r.load(n,null,null),this._position+=e,r},t.prototype.load=function(t,e,r){this._position=0;var i=this;if(r=r||function(t){},this._progress=r,void 0===t||null==t)throw"Source must be defined";if("string"==typeof t){var a=new XMLHttpRequest;a.open("GET",t,!0),a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var t=new FileReader;t.onloadend=function(){t.result&&"string"!=typeof t.result&&(i._buffer=t.result,i._view=new DataView(i._buffer),i.onloaded&&i.onloaded(i))},t.onprogress=function(t){r({message:"Downloading geometry",percent:Math.floor(t.loaded/t.total*100),type:n.MessageType.PROGRESS})},t.readAsArrayBuffer(a.response)}if(4==a.readyState&&200!=a.status){var e="Failed to fetch binary data from server. Server code: "+a.status+". This might be due to CORS policy of your browser if you run this as a local file.";throw r({message:"Downloading geometry",percent:0,type:n.MessageType.FAILED}),i.onerror&&i.onerror(e),e}},a.responseType="blob",null!=e&&Object.keys(e).forEach((function(t){var r=e[t];a.setRequestHeader(t,r)})),a.send()}else if(t instanceof Blob||t instanceof File){var o=new FileReader;o.onloadend=function(){o.result&&"string"!=typeof o.result&&(i._buffer=o.result,i._view=new DataView(i._buffer),i.onloaded&&i.onloaded(i))},o.onprogress=function(t){r({message:"Loading binary data",percent:Math.floor(t.loaded/t.total*100),type:n.MessageType.PROGRESS})},o.readAsArrayBuffer(t)}else t instanceof ArrayBuffer&&(this._buffer=t,this._view=new DataView(i._buffer),i.onloaded&&i.onloaded(i))},t.prototype.seek=function(t){if(t<0||t>this._buffer.byteLength)throw"Position out of range.";this._position=t},t.prototype.isEOF=function(){if(null==this._position)throw"Position is not defined";return this._position==this._buffer.byteLength},t.prototype.readArray=function(t,e,r){null==e&&(e=1);var n=t*e,i=this._position;return this._position+=n,this.reportProgress(),1===e?new r(this._buffer.slice(i,i+n))[0]:new r(this._buffer.slice(i,i+n))},t.prototype.move=function(t){var e=this._position;return this._position+=t,this.reportProgress(),e},t.prototype.reportProgress=function(){null!=this._progress&&this._position-this._lastProgress>5e5&&(this._lastProgress=this._position,this._progress({type:n.MessageType.PROGRESS,message:"Processing data",percent:Math.floor(100*this._position/this._buffer.byteLength)}))},t.prototype.readByte=function(){return this.readUint8()},t.prototype.readByteArray=function(t){return this.readUint8Array(t)},t.prototype.readUint8=function(){var t=this.move(1);return this._view.getUint8(t)},t.prototype.readUint8Array=function(t){return this.readArray(1,t,Uint8Array)},t.prototype.readInt16=function(){var t=this.move(2);return this._view.getInt16(t,!0)},t.prototype.readInt16Array=function(t){return this.readArray(2,t,Int16Array)},t.prototype.readUInt16=function(){var t=this.move(2);return this._view.getUint16(t,!0)},t.prototype.readUint16Array=function(t){return this.readArray(2,t,Uint16Array)},t.prototype.readInt32=function(){var t=this.move(4);return this._view.getInt32(t,!0)},t.prototype.readInt32Array=function(t){return this.readArray(4,t,Int32Array)},t.prototype.readUint32=function(){var t=this.move(4);return this._view.getUint32(t,!0)},t.prototype.readUint32Array=function(t){return this.readArray(4,t,Uint32Array)},t.prototype.readFloat32=function(){var t=this.move(4);return this._view.getFloat32(t,!0)},t.prototype.readFloat32Array=function(t){return this.readArray(4,t,Float32Array)},t.prototype.readFloat64=function(){var t=this.move(8);return this._view.getFloat64(t,!0)},t.prototype.readFloat64Array=function(t){return this.readArray(8,t,Float64Array)},t.prototype.readChar=function(t){null==t&&(t=1);var e=this.readByteArray(t),r=new Array(t);for(var n in e)r[n]=String.fromCharCode(e[n]);return 1===t?r[0]:r},t.prototype.readPoint=function(t){null==t&&(t=1);for(var e=this.readFloat32Array(3*t),r=new Array(t),n=0;n<t;n++){var i=3*n*4,a=new Float32Array(e.buffer,i,3);r[n]=a}return 1===t?r[0]:r},t.prototype.readRgba=function(t){null==t&&(t=1);for(var e=this.readByteArray(4*t),r=new Array(t),n=0;n<t;n++){var i=4*n,a=new Uint8Array(e.buffer,i,4);r[n]=a}return 1===t?r[0]:r},t.prototype.readPackedNormal=function(t){null==t&&(t=1);for(var e=this.readUint8Array(2*t),r=new Array(t),n=0;n<t;n++){var i=new Uint8Array(e.buffer,2*n,2);r[n]=i}return 1===t?r[0]:r},t.prototype.readMatrix4x4=function(t){null==t&&(t=1);for(var e=this.readFloat32Array(16*t),r=new Array(t),n=0;n<t;n++){var i=16*n*4,a=new Float32Array(e.buffer,i,16);r[n]=a}return 1===t?r[0]:r},t.prototype.readMatrix4x4_64=function(t){null==t&&(t=1);for(var e=this.readFloat64Array(16*t),r=new Array(t),n=0;n<t;n++){var i=16*n*8,a=new Float64Array(e.buffer,i,16);r[n]=a}return 1===t?r[0]:r},t.prototype.readData=function(t){var e=this.move(t);return this._buffer.slice(e,e+t)},t}();e.BinaryReader=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(14),i=r(54),a=r(4),o=r(16),s=r(2),u=r(13),c=function(){function t(){this.normals=new Uint8Array(0),this.indices=new Float32Array(0),this.products=new Float32Array(0),this.transformations=new Float32Array(0),this.styleIndices=new Uint16Array(0),this.states=new Uint8Array(0),this.vertices=new Float32Array(0),this.matrices=new Float32Array(0),this.styles=new Uint8Array(0),this.meter=1e3,this.wcs=[0,0,0],this._iVertex=0,this._iIndexForward=0,this._iIndexBackward=0,this._iTransform=0,this._iMatrix=0,this._maxVersionSupported=4,this.productMaps={},this.productIdLookup=[],this._styleMap=new f}return t.prototype.parse=function(t){if(t&&!t.isEOF()){this._reader=t;var e=t;if(94132117!==e.readInt32())throw new Error("Magic number mismatch. This is not a wexBIM file.");var r=e.readByte();if(r>this._maxVersionSupported)throw new Error("Viewer doesn't support version "+r+" of the wexBIM stream");var n=e.readInt32(),c=e.readInt32(),f=e.readInt32(),h=e.readInt32(),d=e.readInt32(),A=e.readInt32();this.meter=e.readFloat32(),r>3&&(this.wcs=[e.readFloat64(),e.readFloat64(),e.readFloat64()]);var p=e.readInt16();this.vertices=new Float32Array(this.square(4,3*c)),this.normals=new Uint8Array(6*f),this.indices=new Float32Array(3*f),this.styleIndices=new Uint16Array(3*f),this.styles=new Uint8Array(this.square(1,4*(A+2))),this.products=new Float32Array(3*f),this.states=new Uint8Array(3*f*2),this.transformations=new Float32Array(3*f),this.matrices=new Float32Array(this.square(4,16*h)),this.productMaps={},this.regions=new Array(p),this._iVertex=0,this._iIndexForward=0,this._iIndexBackward=3*f,this._iTransform=0,this._iMatrix=0;for(var I=0;I<p;I++)(O=new l).population=e.readInt32(),O.centre=e.readFloat32Array(3),O.bbox=e.readFloat32Array(6),this.regions[I]=O;for(var E=0;E<A;E++){var v=e.readInt32(),T=255*e.readFloat32(),m=255*e.readFloat32(),C=255*e.readFloat32(),g=255*e.readFloat32();this.styles.set([T,m,C,g],4*E),this._styleMap.Add({id:v,index:E,transparent:g<254})}for(this.styles.set([255,255,255,255],4*E),this._styleMap.Add({id:-1,index:E,transparent:!1}),E++,this.styles.set([0,255,255,100],4*E),this._styleMap.Add({id:-2,index:E,transparent:!0}),I=0;I<d;I++){var R=e.readInt32(),b=e.readInt16(),M=e.readFloat32Array(6),F=new u.ProductMap;F.productID=R,F.renderId=I+1,F.type=b,F.bBox=M,F.spans=[],this.productMaps[R]=F,this.productIdLookup[I+1]=R,b!==o.ProductType.IFCSPACE&&b!==o.ProductType.IFCOPENINGELEMENT||F.states.push(a.State.HIDDEN)}if(r>=3)for(var y=0;y<p;y++)for(var O=this.regions[y],_=e.readInt32(),P=0;P<_;P++){var N=this.readShape(r),S=e.readInt32();if(0!==S){var L=e.getSubReader(S);if((x=new i.TriangulatedShape).parse(L),!L.isEOF())throw new Error("Incomplete reading of geometry for shape instance "+N[0].iLabel);this.feedDataArrays(N,x)}}else for(var B=0;B<n;B++){var x;N=this.readShape(r),(x=new i.TriangulatedShape).parse(e),this.feedDataArrays(N,x)}if(!e.isEOF())throw this.progress({type:s.MessageType.FAILED,message:"Processing data",percent:0}),new Error("Binary reader is not at the end of the file.");this.progress({type:s.MessageType.PROGRESS,message:"Processing data",percent:100}),this.transparentIndex=this._iIndexForward}},t.prototype.square=function(t,e){if(null==t||null==e)throw new Error('Wrong arguments for "square" function.');if(0===e)return 0;for(var r=e*t,n=Math.ceil(Math.sqrt(r/4));4*n%t!=0;)n++;return n*n*4/t},t.prototype.feedDataArrays=function(t,e){var r=this;t.forEach((function(t){var n=0,i=n=t.transparent?r._iIndexBackward-e.indices.length:r._iIndexForward,s=r.productMaps[t.pLabel];void 0===s&&((s=new u.ProductMap).productID=0,s.renderId=0,s.type=o.ProductType.IFCOPENINGELEMENT,s.bBox=new Float32Array(6),s.spans=[],s.states.push(a.State.HIDDEN),r.productMaps[t.pLabel]=s),r.normals.set(e.normals,2*n);var c=s.type===o.ProductType.IFCSPACE||s.type===o.ProductType.IFCOPENINGELEMENT?a.State.HIDDEN:255;e.indices.forEach((function(e){r.indices[n]=e+r._iVertex/3,r.products[n]=s.renderId,r.styleIndices[n]=t.style,r.transformations[n]=t.transform,r.states[2*n]=c,r.states[2*n+1]=255,n++}));var l=n;s.spans.push(new Int32Array([i,l])),t.transparent?r._iIndexBackward-=e.indices.length:r._iIndexForward+=e.indices.length}),this),this.vertices.set(e.vertices,this._iVertex),this._iVertex+=e.vertices.length},t.prototype.readShape=function(t){for(var e=this._reader,r=e.readInt32(),n=new Array,i=0;i<r;i++){var a=e.readInt32(),s=(e.readInt16(),e.readInt32()),u=e.readInt32(),c=null;r>1&&(c=1===t?e.readFloat32Array(16):e.readFloat64Array(16),this.matrices.set(c,this._iMatrix),this._iMatrix+=16);var l=this._styleMap.GetStyle(u);null===l&&(l=this._styleMap.GetStyle(-1));var f=this.productMaps[a].type;f!==o.ProductType.IFCSPACE&&f!==o.ProductType.IFCOPENINGELEMENT||(l=this._styleMap.GetStyle(-2)),n.push({pLabel:a,iLabel:s,style:l.index,transparent:l.transparent,transform:null!=c?this._iTransform++:-1})}return n},t.prototype.load=function(t,e,r){var i=this;this.progress=r||function(t){};var a=new n.BinaryReader,o=this;a.onloaded=function(){o.parse(a),o.onloaded&&o.onloaded(i)},a.onerror=function(t){o.onerror&&o.onerror(t)},a.load(t,e,r)},t}();e.ModelGeometry=c;var l=function(){function t(t){this.population=-1,this.centre=null,this.bbox=null,t&&(this.population=t.population,t.centre&&(this.centre=new Float32Array(t.centre)),t.bbox&&(this.bbox=new Float32Array(t.bbox)))}return t.clone=function(e){var r=new t;return r.population=e.population,e.centre&&(r.centre=new Float32Array(e.centre)),e.bbox&&(r.bbox=new Float32Array(e.bbox)),r},t.prototype.merge=function(e){if(-1===this.population&&null===this.centre&&null===this.bbox)return new t(e);var r=new t;if(r.population=this.population+e.population,this.bbox&&e.bbox){var n=Math.min(this.bbox[0],e.bbox[0]),i=Math.min(this.bbox[1],e.bbox[1]),a=Math.min(this.bbox[2],e.bbox[2]),o=Math.max(this.bbox[0]+this.bbox[3],e.bbox[0]+e.bbox[3]),s=Math.max(this.bbox[1]+this.bbox[4],e.bbox[1]+e.bbox[4]),u=Math.max(this.bbox[2]+this.bbox[5],e.bbox[2]+e.bbox[5]),c=o-n,l=s-i,f=u-a,h=(n+o)/2,d=(i+s)/2,A=(a+u)/2;r.bbox=new Float32Array([n,i,a,c,l,f]),r.centre=new Float32Array([h,d,A])}else this.bbox?(r.bbox=new Float32Array(this.bbox),r.centre=new Float32Array(this.centre)):(r.bbox=new Float32Array(e.bbox),r.centre=new Float32Array(e.centre));return r},t}();e.Region=l;var f=function(){function t(){this._internal={}}return t.prototype.Add=function(t){this._internal[t.id]=t},t.prototype.GetStyle=function(t){return this._internal[t]||null},t}()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.IFCPRODUCT=20]="IFCPRODUCT",t[t.IFCELEMENT=19]="IFCELEMENT",t[t.IFCBUILDINGELEMENT=26]="IFCBUILDINGELEMENT",t[t.IFCFOOTING=120]="IFCFOOTING",t[t.IFCPILE=572]="IFCPILE",t[t.IFCBEAM=171]="IFCBEAM",t[t.IFCBEAMSTANDARDCASE=1104]="IFCBEAMSTANDARDCASE",t[t.IFCBUILDINGELEMENTPROXY=560]="IFCBUILDINGELEMENTPROXY",t[t.IFCCHIMNEY=1120]="IFCCHIMNEY",t[t.IFCCOLUMN=383]="IFCCOLUMN",t[t.IFCCOLUMNSTANDARDCASE=1126]="IFCCOLUMNSTANDARDCASE",t[t.IFCCOVERING=382]="IFCCOVERING",t[t.IFCCURTAINWALL=456]="IFCCURTAINWALL",t[t.IFCDOOR=213]="IFCDOOR",t[t.IFCDOORSTANDARDCASE=1151]="IFCDOORSTANDARDCASE",t[t.IFCMEMBER=310]="IFCMEMBER",t[t.IFCMEMBERSTANDARDCASE=1214]="IFCMEMBERSTANDARDCASE",t[t.IFCPLATE=351]="IFCPLATE",t[t.IFCPLATESTANDARDCASE=1224]="IFCPLATESTANDARDCASE",t[t.IFCRAILING=350]="IFCRAILING",t[t.IFCRAMP=414]="IFCRAMP",t[t.IFCRAMPFLIGHT=348]="IFCRAMPFLIGHT",t[t.IFCROOF=347]="IFCROOF",t[t.IFCSHADINGDEVICE=1265]="IFCSHADINGDEVICE",t[t.IFCSLAB=99]="IFCSLAB",t[t.IFCSLABELEMENTEDCASE=1268]="IFCSLABELEMENTEDCASE",t[t.IFCSLABSTANDARDCASE=1269]="IFCSLABSTANDARDCASE",t[t.IFCSTAIR=346]="IFCSTAIR",t[t.IFCSTAIRFLIGHT=25]="IFCSTAIRFLIGHT",t[t.IFCWALL=452]="IFCWALL",t[t.IFCWALLELEMENTEDCASE=1314]="IFCWALLELEMENTEDCASE",t[t.IFCWALLSTANDARDCASE=453]="IFCWALLSTANDARDCASE",t[t.IFCWINDOW=667]="IFCWINDOW",t[t.IFCWINDOWSTANDARDCASE=1316]="IFCWINDOWSTANDARDCASE",t[t.IFCELEMENTCOMPONENT=424]="IFCELEMENTCOMPONENT",t[t.IFCREINFORCINGELEMENT=262]="IFCREINFORCINGELEMENT",t[t.IFCREINFORCINGBAR=571]="IFCREINFORCINGBAR",t[t.IFCREINFORCINGMESH=531]="IFCREINFORCINGMESH",t[t.IFCTENDON=261]="IFCTENDON",t[t.IFCTENDONANCHOR=675]="IFCTENDONANCHOR",t[t.IFCBUILDINGELEMENTPART=220]="IFCBUILDINGELEMENTPART",t[t.IFCDISCRETEACCESSORY=423]="IFCDISCRETEACCESSORY",t[t.IFCFASTENER=535]="IFCFASTENER",t[t.IFCMECHANICALFASTENER=536]="IFCMECHANICALFASTENER",t[t.IFCVIBRATIONISOLATOR=1312]="IFCVIBRATIONISOLATOR",t[t.IFCFEATUREELEMENT=386]="IFCFEATUREELEMENT",t[t.IFCSURFACEFEATURE=1287]="IFCSURFACEFEATURE",t[t.IFCFEATUREELEMENTSUBTRACTION=499]="IFCFEATUREELEMENTSUBTRACTION",t[t.IFCVOIDINGFEATURE=1313]="IFCVOIDINGFEATURE",t[t.IFCOPENINGELEMENT=498]="IFCOPENINGELEMENT",t[t.IFCOPENINGSTANDARDCASE=1217]="IFCOPENINGSTANDARDCASE",t[t.IFCFEATUREELEMENTADDITION=385]="IFCFEATUREELEMENTADDITION",t[t.IFCPROJECTIONELEMENT=384]="IFCPROJECTIONELEMENT",t[t.IFCFURNISHINGELEMENT=253]="IFCFURNISHINGELEMENT",t[t.IFCFURNITURE=1184]="IFCFURNITURE",t[t.IFCSYSTEMFURNITUREELEMENT=1291]="IFCSYSTEMFURNITUREELEMENT",t[t.IFCDISTRIBUTIONELEMENT=44]="IFCDISTRIBUTIONELEMENT",t[t.IFCDISTRIBUTIONFLOWELEMENT=45]="IFCDISTRIBUTIONFLOWELEMENT",t[t.IFCDISTRIBUTIONCHAMBERELEMENT=180]="IFCDISTRIBUTIONCHAMBERELEMENT",t[t.IFCENERGYCONVERSIONDEVICE=175]="IFCENERGYCONVERSIONDEVICE",t[t.IFCAIRTOAIRHEATRECOVERY=1097]="IFCAIRTOAIRHEATRECOVERY",t[t.IFCBOILER=1105]="IFCBOILER",t[t.IFCBURNER=1109]="IFCBURNER",t[t.IFCCHILLER=1119]="IFCCHILLER",t[t.IFCCOIL=1124]="IFCCOIL",t[t.IFCCONDENSER=1132]="IFCCONDENSER",t[t.IFCCOOLEDBEAM=1141]="IFCCOOLEDBEAM",t[t.IFCCOOLINGTOWER=1142]="IFCCOOLINGTOWER",t[t.IFCENGINE=1164]="IFCENGINE",t[t.IFCEVAPORATIVECOOLER=1166]="IFCEVAPORATIVECOOLER",t[t.IFCEVAPORATOR=1167]="IFCEVAPORATOR",t[t.IFCHEATEXCHANGER=1187]="IFCHEATEXCHANGER",t[t.IFCHUMIDIFIER=1188]="IFCHUMIDIFIER",t[t.IFCTUBEBUNDLE=1305]="IFCTUBEBUNDLE",t[t.IFCUNITARYEQUIPMENT=1310]="IFCUNITARYEQUIPMENT",t[t.IFCELECTRICGENERATOR=1160]="IFCELECTRICGENERATOR",t[t.IFCELECTRICMOTOR=1161]="IFCELECTRICMOTOR",t[t.IFCMOTORCONNECTION=1216]="IFCMOTORCONNECTION",t[t.IFCSOLARDEVICE=1270]="IFCSOLARDEVICE",t[t.IFCTRANSFORMER=1303]="IFCTRANSFORMER",t[t.IFCFLOWCONTROLLER=121]="IFCFLOWCONTROLLER",t[t.IFCAIRTERMINALBOX=1096]="IFCAIRTERMINALBOX",t[t.IFCDAMPER=1148]="IFCDAMPER",t[t.IFCFLOWMETER=1182]="IFCFLOWMETER",t[t.IFCVALVE=1311]="IFCVALVE",t[t.IFCELECTRICDISTRIBUTIONBOARD=1157]="IFCELECTRICDISTRIBUTIONBOARD",t[t.IFCELECTRICTIMECONTROL=1162]="IFCELECTRICTIMECONTROL",t[t.IFCPROTECTIVEDEVICE=1235]="IFCPROTECTIVEDEVICE",t[t.IFCSWITCHINGDEVICE=1290]="IFCSWITCHINGDEVICE",t[t.IFCFLOWFITTING=467]="IFCFLOWFITTING",t[t.IFCDUCTFITTING=1153]="IFCDUCTFITTING",t[t.IFCPIPEFITTING=1222]="IFCPIPEFITTING",t[t.IFCCABLECARRIERFITTING=1111]="IFCCABLECARRIERFITTING",t[t.IFCCABLEFITTING=1113]="IFCCABLEFITTING",t[t.IFCJUNCTIONBOX=1195]="IFCJUNCTIONBOX",t[t.IFCFLOWMOVINGDEVICE=502]="IFCFLOWMOVINGDEVICE",t[t.IFCCOMPRESSOR=1131]="IFCCOMPRESSOR",t[t.IFCFAN=1177]="IFCFAN",t[t.IFCPUMP=1238]="IFCPUMP",t[t.IFCFLOWSEGMENT=574]="IFCFLOWSEGMENT",t[t.IFCDUCTSEGMENT=1154]="IFCDUCTSEGMENT",t[t.IFCPIPESEGMENT=1223]="IFCPIPESEGMENT",t[t.IFCCABLECARRIERSEGMENT=1112]="IFCCABLECARRIERSEGMENT",t[t.IFCCABLESEGMENT=1115]="IFCCABLESEGMENT",t[t.IFCFLOWSTORAGEDEVICE=371]="IFCFLOWSTORAGEDEVICE",t[t.IFCTANK=1293]="IFCTANK",t[t.IFCELECTRICFLOWSTORAGEDEVICE=1159]="IFCELECTRICFLOWSTORAGEDEVICE",t[t.IFCFLOWTERMINAL=46]="IFCFLOWTERMINAL",t[t.IFCFIRESUPPRESSIONTERMINAL=1179]="IFCFIRESUPPRESSIONTERMINAL",t[t.IFCSANITARYTERMINAL=1262]="IFCSANITARYTERMINAL",t[t.IFCSTACKTERMINAL=1277]="IFCSTACKTERMINAL",t[t.IFCWASTETERMINAL=1315]="IFCWASTETERMINAL",t[t.IFCAIRTERMINAL=1095]="IFCAIRTERMINAL",t[t.IFCMEDICALDEVICE=1212]="IFCMEDICALDEVICE",t[t.IFCSPACEHEATER=1272]="IFCSPACEHEATER",t[t.IFCAUDIOVISUALAPPLIANCE=1099]="IFCAUDIOVISUALAPPLIANCE",t[t.IFCCOMMUNICATIONSAPPLIANCE=1127]="IFCCOMMUNICATIONSAPPLIANCE",t[t.IFCELECTRICAPPLIANCE=1156]="IFCELECTRICAPPLIANCE",t[t.IFCLAMP=1198]="IFCLAMP",t[t.IFCLIGHTFIXTURE=1199]="IFCLIGHTFIXTURE",t[t.IFCOUTLET=1219]="IFCOUTLET",t[t.IFCFLOWTREATMENTDEVICE=425]="IFCFLOWTREATMENTDEVICE",t[t.IFCINTERCEPTOR=1193]="IFCINTERCEPTOR",t[t.IFCDUCTSILENCER=1155]="IFCDUCTSILENCER",t[t.IFCFILTER=1178]="IFCFILTER",t[t.IFCDISTRIBUTIONCONTROLELEMENT=468]="IFCDISTRIBUTIONCONTROLELEMENT",t[t.IFCPROTECTIVEDEVICETRIPPINGUNIT=1236]="IFCPROTECTIVEDEVICETRIPPINGUNIT",t[t.IFCACTUATOR=1091]="IFCACTUATOR",t[t.IFCALARM=1098]="IFCALARM",t[t.IFCCONTROLLER=1139]="IFCCONTROLLER",t[t.IFCFLOWINSTRUMENT=1181]="IFCFLOWINSTRUMENT",t[t.IFCSENSOR=1264]="IFCSENSOR",t[t.IFCUNITARYCONTROLELEMENT=1308]="IFCUNITARYCONTROLELEMENT",t[t.IFCCIVILELEMENT=1122]="IFCCIVILELEMENT",t[t.IFCELEMENTASSEMBLY=18]="IFCELEMENTASSEMBLY",t[t.IFCGEOGRAPHICELEMENT=1185]="IFCGEOGRAPHICELEMENT",t[t.IFCTRANSPORTELEMENT=416]="IFCTRANSPORTELEMENT",t[t.IFCVIRTUALELEMENT=168]="IFCVIRTUALELEMENT",t[t.IFCSTRUCTURALACTIVITY=41]="IFCSTRUCTURALACTIVITY",t[t.IFCSTRUCTURALACTION=40]="IFCSTRUCTURALACTION",t[t.IFCSTRUCTURALCURVEACTION=1279]="IFCSTRUCTURALCURVEACTION",t[t.IFCSTRUCTURALLINEARACTION=463]="IFCSTRUCTURALLINEARACTION",t[t.IFCSTRUCTURALSURFACEACTION=1284]="IFCSTRUCTURALSURFACEACTION",t[t.IFCSTRUCTURALPLANARACTION=39]="IFCSTRUCTURALPLANARACTION",t[t.IFCSTRUCTURALPOINTACTION=356]="IFCSTRUCTURALPOINTACTION",t[t.IFCSTRUCTURALREACTION=355]="IFCSTRUCTURALREACTION",t[t.IFCSTRUCTURALCURVEREACTION=1280]="IFCSTRUCTURALCURVEREACTION",t[t.IFCSTRUCTURALPOINTREACTION=354]="IFCSTRUCTURALPOINTREACTION",t[t.IFCSTRUCTURALSURFACEREACTION=1285]="IFCSTRUCTURALSURFACEREACTION",t[t.IFCSTRUCTURALITEM=226]="IFCSTRUCTURALITEM",t[t.IFCSTRUCTURALCONNECTION=265]="IFCSTRUCTURALCONNECTION",t[t.IFCSTRUCTURALCURVECONNECTION=534]="IFCSTRUCTURALCURVECONNECTION",t[t.IFCSTRUCTURALPOINTCONNECTION=533]="IFCSTRUCTURALPOINTCONNECTION",t[t.IFCSTRUCTURALSURFACECONNECTION=264]="IFCSTRUCTURALSURFACECONNECTION",t[t.IFCSTRUCTURALMEMBER=225]="IFCSTRUCTURALMEMBER",t[t.IFCSTRUCTURALCURVEMEMBER=224]="IFCSTRUCTURALCURVEMEMBER",t[t.IFCSTRUCTURALCURVEMEMBERVARYING=227]="IFCSTRUCTURALCURVEMEMBERVARYING",t[t.IFCSTRUCTURALSURFACEMEMBER=420]="IFCSTRUCTURALSURFACEMEMBER",t[t.IFCSTRUCTURALSURFACEMEMBERVARYING=421]="IFCSTRUCTURALSURFACEMEMBERVARYING",t[t.IFCPORT=179]="IFCPORT",t[t.IFCDISTRIBUTIONPORT=178]="IFCDISTRIBUTIONPORT",t[t.IFCANNOTATION=634]="IFCANNOTATION",t[t.IFCSPATIALELEMENT=1273]="IFCSPATIALELEMENT",t[t.IFCSPATIALSTRUCTUREELEMENT=170]="IFCSPATIALSTRUCTUREELEMENT",t[t.IFCBUILDING=169]="IFCBUILDING",t[t.IFCBUILDINGSTOREY=459]="IFCBUILDINGSTOREY",t[t.IFCSITE=349]="IFCSITE",t[t.IFCSPACE=454]="IFCSPACE",t[t.IFCEXTERNALSPATIALSTRUCTUREELEMENT=1175]="IFCEXTERNALSPATIALSTRUCTUREELEMENT",t[t.IFCEXTERNALSPATIALELEMENT=1174]="IFCEXTERNALSPATIALELEMENT",t[t.IFCSPATIALZONE=1275]="IFCSPATIALZONE",t[t.IFCGRID=564]="IFCGRID",t[t.IFCPROXY=447]="IFCPROXY"}(e.ProductType||(e.ProductType={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.getByName=function(t){t=t.toUpperCase();for(var e=[i];0!==e.length;){var r=e.shift();if(r.name.toUpperCase()===t)return r;r.children&&r.children.forEach((function(t){e.push(t)}))}return null},t.getAllSubTypes=function(t){for(var e=[],r=[i];0!==r.length;)(a=r.shift()).id===t&&e.push(a),a.children&&a.children.forEach((function(t){r.push(t)}));r=e.slice();for(var n={};0!==r.length;){var a;!1===(a=r.shift()).abs&&(n[a.id]=!0),a.children&&a.children.forEach((function(t){r.push(t)}))}return n},t}();e.Product=n;var i={name:"IfcProduct",id:20,abs:!0,children:[{name:"IfcElement",id:19,abs:!0,children:[{name:"IfcDistributionElement",id:44,abs:!1,children:[{name:"IfcDistributionFlowElement",id:45,abs:!1,children:[{name:"IfcDistributionChamberElement",id:180,abs:!1},{name:"IfcEnergyConversionDevice",id:175,abs:!1,children:[{name:"IfcAirToAirHeatRecovery",id:1097,abs:!1},{name:"IfcBoiler",id:1105,abs:!1},{name:"IfcBurner",id:1109,abs:!1},{name:"IfcChiller",id:1119,abs:!1},{name:"IfcCoil",id:1124,abs:!1},{name:"IfcCondenser",id:1132,abs:!1},{name:"IfcCooledBeam",id:1141,abs:!1},{name:"IfcCoolingTower",id:1142,abs:!1},{name:"IfcEngine",id:1164,abs:!1},{name:"IfcEvaporativeCooler",id:1166,abs:!1},{name:"IfcEvaporator",id:1167,abs:!1},{name:"IfcHeatExchanger",id:1187,abs:!1},{name:"IfcHumidifier",id:1188,abs:!1},{name:"IfcTubeBundle",id:1305,abs:!1},{name:"IfcUnitaryEquipment",id:1310,abs:!1},{name:"IfcElectricGenerator",id:1160,abs:!1},{name:"IfcElectricMotor",id:1161,abs:!1},{name:"IfcMotorConnection",id:1216,abs:!1},{name:"IfcSolarDevice",id:1270,abs:!1},{name:"IfcTransformer",id:1303,abs:!1}]},{name:"IfcFlowController",id:121,abs:!1,children:[{name:"IfcElectricDistributionPoint",id:242,abs:!1},{name:"IfcAirTerminalBox",id:1096,abs:!1},{name:"IfcDamper",id:1148,abs:!1},{name:"IfcFlowMeter",id:1182,abs:!1},{name:"IfcValve",id:1311,abs:!1},{name:"IfcElectricDistributionBoard",id:1157,abs:!1},{name:"IfcElectricTimeControl",id:1162,abs:!1},{name:"IfcProtectiveDevice",id:1235,abs:!1},{name:"IfcSwitchingDevice",id:1290,abs:!1}]},{name:"IfcFlowFitting",id:467,abs:!1,children:[{name:"IfcDuctFitting",id:1153,abs:!1},{name:"IfcPipeFitting",id:1222,abs:!1},{name:"IfcCableCarrierFitting",id:1111,abs:!1},{name:"IfcCableFitting",id:1113,abs:!1},{name:"IfcJunctionBox",id:1195,abs:!1}]},{name:"IfcFlowMovingDevice",id:502,abs:!1,children:[{name:"IfcCompressor",id:1131,abs:!1},{name:"IfcFan",id:1177,abs:!1},{name:"IfcPump",id:1238,abs:!1}]},{name:"IfcFlowSegment",id:574,abs:!1,children:[{name:"IfcDuctSegment",id:1154,abs:!1},{name:"IfcPipeSegment",id:1223,abs:!1},{name:"IfcCableCarrierSegment",id:1112,abs:!1},{name:"IfcCableSegment",id:1115,abs:!1}]},{name:"IfcFlowStorageDevice",id:371,abs:!1,children:[{name:"IfcTank",id:1293,abs:!1},{name:"IfcElectricFlowStorageDevice",id:1159,abs:!1}]},{name:"IfcFlowTerminal",id:46,abs:!1,children:[{name:"IfcFireSuppressionTerminal",id:1179,abs:!1},{name:"IfcSanitaryTerminal",id:1262,abs:!1},{name:"IfcStackTerminal",id:1277,abs:!1},{name:"IfcWasteTerminal",id:1315,abs:!1},{name:"IfcAirTerminal",id:1095,abs:!1},{name:"IfcMedicalDevice",id:1212,abs:!1},{name:"IfcSpaceHeater",id:1272,abs:!1},{name:"IfcAudioVisualAppliance",id:1099,abs:!1},{name:"IfcCommunicationsAppliance",id:1127,abs:!1},{name:"IfcElectricAppliance",id:1156,abs:!1},{name:"IfcLamp",id:1198,abs:!1},{name:"IfcLightFixture",id:1199,abs:!1},{name:"IfcOutlet",id:1219,abs:!1}]},{name:"IfcFlowTreatmentDevice",id:425,abs:!1,children:[{name:"IfcInterceptor",id:1193,abs:!1},{name:"IfcDuctSilencer",id:1155,abs:!1},{name:"IfcFilter",id:1178,abs:!1}]}]},{name:"IfcDistributionControlElement",id:468,abs:!1,children:[{name:"IfcProtectiveDeviceTrippingUnit",id:1236,abs:!1},{name:"IfcActuator",id:1091,abs:!1},{name:"IfcAlarm",id:1098,abs:!1},{name:"IfcController",id:1139,abs:!1},{name:"IfcFlowInstrument",id:1181,abs:!1},{name:"IfcSensor",id:1264,abs:!1},{name:"IfcUnitaryControlElement",id:1308,abs:!1}]}]},{name:"IfcElementComponent",id:424,abs:!0,children:[{name:"IfcDiscreteAccessory",id:423,abs:!1},{name:"IfcFastener",id:535,abs:!1,children:[{name:"IfcMechanicalFastener",id:536,abs:!1}]},{name:"IfcReinforcingElement",id:262,abs:!0,children:[{name:"IfcReinforcingBar",id:571,abs:!1},{name:"IfcReinforcingMesh",id:531,abs:!1},{name:"IfcTendon",id:261,abs:!1},{name:"IfcTendonAnchor",id:675,abs:!1}]},{name:"IfcBuildingElementPart",id:220,abs:!1},{name:"IfcMechanicalFastener",id:536,abs:!1},{name:"IfcVibrationIsolator",id:1312,abs:!1}]},{name:"IfcFeatureElement",id:386,abs:!0,children:[{name:"IfcFeatureElementSubtraction",id:499,abs:!0,children:[{name:"IfcEdgeFeature",id:764,abs:!0,children:[{name:"IfcChamferEdgeFeature",id:765,abs:!1},{name:"IfcRoundedEdgeFeature",id:766,abs:!1}]},{name:"IfcOpeningElement",id:498,abs:!1,children:[{name:"IfcOpeningStandardCase",id:1217,abs:!1}]},{name:"IfcVoidingFeature",id:1313,abs:!1}]},{name:"IfcFeatureElementAddition",id:385,abs:!0,children:[{name:"IfcProjectionElement",id:384,abs:!1}]},{name:"IfcSurfaceFeature",id:1287,abs:!1}]},{name:"IfcBuildingElement",id:26,abs:!0,children:[{name:"IfcBuildingElementComponent",id:221,abs:!0,children:[{name:"IfcBuildingElementPart",id:220,abs:!1},{name:"IfcReinforcingElement",id:262,abs:!0,children:[{name:"IfcReinforcingBar",id:571,abs:!1},{name:"IfcReinforcingMesh",id:531,abs:!1},{name:"IfcTendon",id:261,abs:!1},{name:"IfcTendonAnchor",id:675,abs:!1}]}]},{name:"IfcFooting",id:120,abs:!1},{name:"IfcPile",id:572,abs:!1},{name:"IfcBeam",id:171,abs:!1,children:[{name:"IfcBeamStandardCase",id:1104,abs:!1}]},{name:"IfcColumn",id:383,abs:!1,children:[{name:"IfcColumnStandardCase",id:1126,abs:!1}]},{name:"IfcCurtainWall",id:456,abs:!1},{name:"IfcDoor",id:213,abs:!1,children:[{name:"IfcDoorStandardCase",id:1151,abs:!1}]},{name:"IfcMember",id:310,abs:!1,children:[{name:"IfcMemberStandardCase",id:1214,abs:!1}]},{name:"IfcPlate",id:351,abs:!1,children:[{name:"IfcPlateStandardCase",id:1224,abs:!1}]},{name:"IfcRailing",id:350,abs:!1},{name:"IfcRamp",id:414,abs:!1},{name:"IfcRampFlight",id:348,abs:!1},{name:"IfcRoof",id:347,abs:!1},{name:"IfcSlab",id:99,abs:!1,children:[{name:"IfcSlabElementedCase",id:1268,abs:!1},{name:"IfcSlabStandardCase",id:1269,abs:!1}]},{name:"IfcStair",id:346,abs:!1},{name:"IfcStairFlight",id:25,abs:!1},{name:"IfcWall",id:452,abs:!1,children:[{name:"IfcWallStandardCase",id:453,abs:!1},{name:"IfcWallElementedCase",id:1314,abs:!1}]},{name:"IfcWindow",id:667,abs:!1,children:[{name:"IfcWindowStandardCase",id:1316,abs:!1}]},{name:"IfcBuildingElementProxy",id:560,abs:!1},{name:"IfcCovering",id:382,abs:!1},{name:"IfcChimney",id:1120,abs:!1},{name:"IfcShadingDevice",id:1265,abs:!1}]},{name:"IfcElementAssembly",id:18,abs:!1},{name:"IfcFurnishingElement",id:253,abs:!1,children:[{name:"IfcFurniture",id:1184,abs:!1},{name:"IfcSystemFurnitureElement",id:1291,abs:!1}]},{name:"IfcTransportElement",id:416,abs:!1},{name:"IfcVirtualElement",id:168,abs:!1},{name:"IfcElectricalElement",id:23,abs:!1},{name:"IfcEquipmentElement",id:212,abs:!1},{name:"IfcCivilElement",id:1122,abs:!1},{name:"IfcGeographicElement",id:1185,abs:!1}]},{name:"IfcPort",id:179,abs:!0,children:[{name:"IfcDistributionPort",id:178,abs:!1}]},{name:"IfcProxy",id:447,abs:!1},{name:"IfcStructuralActivity",id:41,abs:!0,children:[{name:"IfcStructuralAction",id:40,abs:!0,children:[{name:"IfcStructuralLinearAction",id:463,abs:!1,children:[{name:"IfcStructuralLinearActionVarying",id:464,abs:!1}]},{name:"IfcStructuralPlanarAction",id:39,abs:!1,children:[{name:"IfcStructuralPlanarActionVarying",id:357,abs:!1}]},{name:"IfcStructuralPointAction",id:356,abs:!1},{name:"IfcStructuralCurveAction",id:1279,abs:!1,children:[{name:"IfcStructuralLinearAction",id:463,abs:!1}]},{name:"IfcStructuralSurfaceAction",id:1284,abs:!1,children:[{name:"IfcStructuralPlanarAction",id:39,abs:!1}]}]},{name:"IfcStructuralReaction",id:355,abs:!0,children:[{name:"IfcStructuralPointReaction",id:354,abs:!1},{name:"IfcStructuralCurveReaction",id:1280,abs:!1},{name:"IfcStructuralSurfaceReaction",id:1285,abs:!1}]}]},{name:"IfcStructuralItem",id:226,abs:!0,children:[{name:"IfcStructuralConnection",id:265,abs:!0,children:[{name:"IfcStructuralCurveConnection",id:534,abs:!1},{name:"IfcStructuralPointConnection",id:533,abs:!1},{name:"IfcStructuralSurfaceConnection",id:264,abs:!1}]},{name:"IfcStructuralMember",id:225,abs:!0,children:[{name:"IfcStructuralCurveMember",id:224,abs:!1,children:[{name:"IfcStructuralCurveMemberVarying",id:227,abs:!1}]},{name:"IfcStructuralSurfaceMember",id:420,abs:!1,children:[{name:"IfcStructuralSurfaceMemberVarying",id:421,abs:!1}]}]}]},{name:"IfcAnnotation",id:634,abs:!1},{name:"IfcSpatialStructureElement",id:170,abs:!0,children:[{name:"IfcBuilding",id:169,abs:!1},{name:"IfcBuildingStorey",id:459,abs:!1},{name:"IfcSite",id:349,abs:!1},{name:"IfcSpace",id:454,abs:!1}]},{name:"IfcGrid",id:564,abs:!1},{name:"IfcSpatialElement",id:1273,abs:!0,children:[{name:"IfcSpatialStructureElement",id:170,abs:!0,children:[{name:"IfcBuilding",id:169,abs:!1},{name:"IfcBuildingStorey",id:459,abs:!1},{name:"IfcSite",id:349,abs:!1},{name:"IfcSpace",id:454,abs:!1}]},{name:"IfcExternalSpatialStructureElement",id:1175,abs:!0,children:[{name:"IfcExternalSpatialElement",id:1174,abs:!1}]},{name:"IfcSpatialZone",id:1275,abs:!1}]}]}},function(t,e,r){"use strict";function n(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),n(r(17)),n(r(16)),n(r(4)),n(r(2)),n(r(55)),n(r(3)),n(r(9)),n(r(1));var i=r(10);e.EasingType=i.EasingType,n(r(35)),n(r(31)),n(r(29)),n(r(28))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.new=function(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(t){var e=parseInt(t,10);return(e^16*Math.random()>>e/4).toString(16)}))},t}();e.Guid=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(19),i=r(8),a=r(6),o=r(0),s=r(3),u=r(18),c=r(5),l=r(7),f=function(){function t(){this.index=++t._currentIndex,this.guid=n.Guid.new()}return t.GetViewpoint=function(e,r,n){void 0===n&&(n=e.width/2);var i=new t,o=e.width/e.height,f=n/o,h=function(t){return Array.prototype.slice.call(t)};if(e.camera===s.CameraType.PERSPECTIVE)i.perspective_camera={camera_direction:h(e.getCameraDirection()),camera_up_vector:h(e.getCameraHeading()),camera_view_point:h(e.getCameraPositionWcs()),field_of_view:e.cameraProperties.fov,height:e.cameraProperties.height,width:e.cameraProperties.height*o};else{var d=e.cameraProperties.height/e.unitsInMeter,A=e.height/t.resolution;i.orthogonal_camera={camera_direction:h(e.getCameraDirection()),camera_up_vector:h(e.getCameraHeading()),camera_view_point:h(e.getCameraPositionWcs()),view_to_world_scale:A/d,height:e.cameraProperties.height,width:e.cameraProperties.height*o}}var p=e.getCurrentImageDataUrl(n,f,"png").substring(22);i.snapshot={snapshot_type:"png",snapshot_data:p};var I=e.getClip();null!=I&&(t.AddClippingPlane(i,I.PlaneA),t.AddClippingPlane(i,I.PlaneB));var E=e.getProductsWithState(u.State.HIGHLIGHTED);if(null!=E&&E.length>0){null==r&&(console.warn("ID mapping function should be used to persist global identity of selected elements"),r=function(t,e){return e+"_"+t}),null==i.components&&(i.components=new a.Components,i.components.coloring=[],i.components.selection=[],i.components.visibility=new c.Visibility);var v=i.components.selection;E.forEach((function(t){var e=r(t.id,t.model);v.push(new l.Component(e))}))}return i},t.AddClippingPlane=function(t,e){if(null!=e&&4===e.length){null==t.clipping_planes&&(t.clipping_planes=[]);var r=new i.ClippingPlane;r.direction=e.slice(0,3);var n=e,a=-n[0]*n[3]/(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]),o=-n[1]*n[3]/(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]),s=-n[2]*n[3]/(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);r.location=[a,o,s],t.clipping_planes.push(r)}},t.SetViewpoint=function(e,r,n,i){void 0===i&&(i=0);var a=function(t){return null==t||t.length<3?null:o.vec3.fromValues(t[0],t[1],t[2])},c=e.getCurrentWcs(),l=e.width/e.height;t.SetClipping(e,r);var f=r.perspective_camera||r.orthogonal_camera;if(null!=f){var h=f.camera_view_point,d=f.camera_direction,A=f.camera_up_vector,p=a(h),I=o.vec3.subtract(o.vec3.create(),p,c),E=o.vec3.normalize(o.vec3.create(),a(d)),v=o.vec3.normalize(o.vec3.create(),a(A)||o.vec3.fromValues(0,0,1)),T=o.vec3.angle(E,v);(Math.abs(T)<1e-6||Math.abs(T-Math.PI)<1e-6)&&(console.warn("Collinear target and heading vectors for the view. Singularity will be fixed by guess."),T=o.vec3.angle(E,o.vec3.fromValues(0,0,1)),(Math.abs(T)<1e-6||Math.abs(T-Math.PI)<1e-6)&&(v=o.vec3.fromValues(0,1,0)));var m=function(t){return null!=t&&"number"==typeof t&&t>0},C=e.cameraProperties.height||100,g=e.getMergedRegion(),R=g&&g.bbox&&g.population>0?e.getDistanceAndHeight(g.bbox,E,v):null;if(null!=R&&o.vec3.dist(a(g.centre),I)>4*R.distance){var b=o.vec3.negate(o.vec3.create(),E),M=o.vec3.scale(o.vec3.create(),b,R.distance);I=o.vec3.add(o.vec3.create(),a(g.centre),M),C=R.height}if(r.perspective_camera){e.camera=s.CameraType.PERSPECTIVE;var F=60;if(m(r.perspective_camera.field_of_view)&&(F=r.perspective_camera.field_of_view),m(f.width)&&m(f.height)&&(_=f.width/f.height)>l){var y=F*Math.PI/180;F=2*Math.atan(Math.tan(y/2)*_/l)*180/Math.PI}e.cameraProperties.fov=F}else if(r.orthogonal_camera){if(e.camera=s.CameraType.ORTHOGONAL,e.cameraProperties.fov=60,m(r.orthogonal_camera.view_to_world_scale)){var O=r.orthogonal_camera.view_to_world_scale;C=e.height/t.resolution/O*e.unitsInMeter}if(m(f.width)&&m(f.height)){var _,P=f.height;(_=f.width/P)>l&&(P=P*_/l),null!=R&&P>4*R.height&&(P=R.height),C=P}}var N=o.vec3.add(o.vec3.create(),I,E),S=o.mat4.lookAt(o.mat4.create(),I,N,v);if(e.animations.viewTo({mv:S,height:C},i).then((function(){r.orthogonal_camera&&o.vec3.angle(a(f.camera_direction),o.vec3.fromValues(0,0,-1))>Math.PI/180||e.adjustments.adjust()})),e.clearHighlighting(),null!=r.components&&null!=r.components.selection&&r.components.selection.length>0){var L=r.components.selection;null==n&&(console.warn("No function defined to map between global IDs and local product and model IDs"),n=function(t){var e=t.split("_"),r=parseInt(e[0],10);return{productId:parseInt(e[1],10),modelId:r}});var B={};L.map((function(t){return n(t.ifc_guid)})).forEach((function(t){(B[t.modelId]||(B[t.modelId]=[])).push(t.productId)})),Object.getOwnPropertyNames(B).forEach((function(t){e.addState(u.State.HIGHLIGHTED,B[t],parseInt(t,10))}))}}},t.SetClipping=function(e,r){if(e.unclip(),null!=r.clipping_planes&&0!==r.clipping_planes.length)if(6!==r.clipping_planes.length){var n=t.getClippingEquation(r.clipping_planes[0]),i=t.getClippingEquation(r.clipping_planes[1]);null!=n&&e.setClippingPlaneA(n),null!=i&&e.setClippingPlaneB(i)}else e.sectionBox.setToPlanes(r.clipping_planes)},t.getClippingEquation=function(t){if(null==t||null==t.direction||null==t.location)return null;var e=t.direction,r=t.location,n=0-e[0]*r[0]-e[1]*r[1]-e[2]*r[2];return[e[0],e[1],e[2],n]},Object.defineProperty(t,"resolution",{get:function(){if(null!=t._resolution)return t._resolution;var e=document.createElement("div");e.style.position="absolute",e.style.width="100mm",document.body.appendChild(e);var r=e.getBoundingClientRect();return document.body.removeChild(e),t._resolution=r.width/.1,t._resolution},enumerable:!0,configurable:!0}),t._currentIndex=0,t._resolution=null,t}();e.Viewpoint=f},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ViewSetupHints=function(){}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Snapshot=function(){}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PerspectiveCamera=function(){}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OrthogonalCamera=function(){}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Line=function(){}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Coloring=function(){}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Bitmap=function(){}},function(t,e,r){"use strict";function n(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),n(r(27)),n(r(8)),n(r(26)),n(r(7)),n(r(6)),n(r(25)),n(r(24)),n(r(23)),n(r(22)),n(r(21)),n(r(20)),n(r(5))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){var t=document.createElement("style");t.innerText="\n        .xbim-viewer-loader {\n            border: 32px solid #eee; /* Light grey */\n            border-top: 32px solid #aaa; /* Dark gray */\n            border-radius: 50%;\n            width: 120px;\n            height: 120px;\n            animation: xbim-viewer-loader-spin 2s linear infinite;\n          }\n          \n          @keyframes xbim-viewer-loader-spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }",document.body.appendChild(t)}return t.prototype.init=function(t){this.viewer=t},t.prototype.onBeforeDraw=function(t,e){},t.prototype.onAfterDraw=function(t,e){},t.prototype.onBeforeDrawId=function(){},t.prototype.onAfterDrawId=function(){},t.prototype.onAfterDrawModelId=function(){},t.prototype.show=function(t){var e=document.createElement("div");e.style.width="100%",e.style.height="100%",e.style.zIndex="1000",e.style.overflow="hidden",e.style.position="absolute",e.style.top="0",e.style.left="0";var r=document.createElement("div");if(r.style.height="100%",r.style.width="100%",r.style.backgroundColor="rgb(200,200,200)",r.style.opacity="0.5",e.appendChild(r),null!=t){var n=document.createElement("div");n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.height="100%",n.style.width="100%",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",e.appendChild(n),t.style.height="100%",t.style.filter="blur(15px)",n.appendChild(t)}var i=document.createElement("div");i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.height="100%",i.style.width="100%",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center";var a=document.createElement("div");a.className="xbim-viewer-loader",i.appendChild(a),e.appendChild(i),this.overlay=e;var o=this.viewer.canvas.parentElement;"relative"!==o.style.position&&"absolute"!==o.style.position&&(o.style.position="relative");var s=this.viewer.canvas.nextElementSibling;null!=s?o.insertBefore(e,s):o.appendChild(e)},t.prototype.hide=function(){null!=this.overlay&&(null!=this.overlay.parentElement&&this.overlay.parentElement.removeChild(this.overlay),this.overlay=null)},t}();e.LoaderOverlay=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.vshader="attribute vec3 coordinates;\r\n\r\n\r\nuniform mat4 uMvMatrix;\r\nuniform mat4 uPMatrix;\r\n\r\nvoid main(void) {\r\n gl_Position = uPMatrix * uMvMatrix * vec4(coordinates, 1.0);\r\n}"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(30),i=function(){function t(){this.initialized=!1,this.factor=1.5,this.zFactor=5,this.numberOfLines=10,this.colour=[0,0,0,.6],this._stopped=!1}return Object.defineProperty(t.prototype,"stopped",{get:function(){return this._stopped},set:function(t){this._stopped=t,this.viewer&&this.viewer.draw()},enumerable:!0,configurable:!0}),t.prototype.init=function(t){this.viewer=t;var e=t.gl;this._initShader(),e.useProgram(this.program),this.vertex_buffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertex_buffer),this.coordinatesAttributePointer=e.getAttribLocation(this.program,"coordinates"),e.vertexAttribPointer(this.coordinatesAttributePointer,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(this.coordinatesAttributePointer),this.colourUniformPointer=e.getUniformLocation(this.program,"uColour"),this.pUniformPointer=e.getUniformLocation(this.program,"uPMatrix"),this.mvUniformPointer=e.getUniformLocation(this.program,"uMvMatrix"),this.initialized=!0},t.prototype._initShader=function(){var t=this.viewer.gl,e=this.viewer,r=function(r,n){if(t.shaderSource(r,n),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){var i=t.getShaderInfoLog(r);return e.error(i),null}},i=t.createShader(t.FRAGMENT_SHADER);r(i,"precision mediump float; uniform vec4 uColour;void main(void) {gl_FragColor = uColour;}");var a=t.createShader(t.VERTEX_SHADER);r(a,n.vshader),this.program=t.createProgram(),t.attachShader(this.program,a),t.attachShader(this.program,i),t.linkProgram(this.program),t.getProgramParameter(this.program,t.LINK_STATUS)||e.error("Could not initialise shaders for a navigation cube plugin")},t.prototype.onAfterDraw=function(t,e){if(this.initialized&&!this.stopped){var r=this.viewer.getMergedRegion();if(r&&!(r.population<1)){var n=Math.max(r.bbox[3],r.bbox[4])*this.factor;if(!(n<.1)){for(var i=n/(this.numberOfLines+1),a=r.bbox[0]+r.bbox[3]/2-n/2,o=r.bbox[1]+r.bbox[4]/2-n/2,s=r.bbox[2]-r.bbox[5]/this.zFactor,u=[],c=1;c<this.numberOfLines+1;c++)u.push(a),u.push(o+c*i),u.push(s),u.push(a+n),u.push(o+c*i),u.push(s);for(c=1;c<this.numberOfLines+1;c++)u.push(a+c*i),u.push(o),u.push(s),u.push(a+c*i),u.push(o+n),u.push(s);var l=this.viewer.gl;l.useProgram(this.program),l.uniformMatrix4fv(this.pUniformPointer,!1,this.viewer.pMatrix),l.uniformMatrix4fv(this.mvUniformPointer,!1,this.viewer.mvMatrix),l.uniform4fv(this.colourUniformPointer,this.colour),l.bindBuffer(l.ARRAY_BUFFER,this.vertex_buffer),l.bufferData(l.ARRAY_BUFFER,new Float32Array(u),l.STATIC_DRAW),l.bindBuffer(l.ARRAY_BUFFER,this.vertex_buffer),l.vertexAttribPointer(this.coordinatesAttributePointer,3,l.FLOAT,!1,0,0),l.enable(l.BLEND),l.enable(l.DEPTH_TEST),l.blendFunc(l.ONE_MINUS_DST_ALPHA,l.ONE_MINUS_SRC_ALPHA),l.drawArrays(l.LINES,0,u.length/3)}}}},t.prototype.onBeforeDraw=function(t,e){},t.prototype.onBeforeDrawId=function(){},t.prototype.onAfterDrawId=function(){},t.prototype.onAfterDrawModelId=function(){},t}();e.Grid=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CubeTextures={en:"data:image/png;base64,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"}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cube_vshader="attribute highp vec3 aVertex;\r\nattribute highp vec2 aTexCoord;\r\nattribute highp float aId;\r\n\r\n\r\nuniform mat3 uRotation;\r\nuniform mat4 uPMatrix;\r\n\r\n\r\n\r\nuniform mediump float uColorCoding; \r\nuniform float uSelection;\r\n\r\n\r\nvarying vec2 vTexCoord;\r\nvarying vec4 vIdColor;\r\n\r\nvec4 getIdColor(float id){\r\n float product = floor(id + 0.5);\r\n float B = floor(product / (256.0*256.0));\r\n float G = floor((product - B * 256.0*256.0) / 256.0);\r\n float R = mod(product, 256.0);\r\n return vec4(R / 255.0, G / 255.0, B / 255.0, 1.0);\r\n}\r\n\r\nvoid main(void) {\r\n vec4 point = vec4(uRotation * aVertex, 1.0);\r\n gl_Position = uPMatrix * point;\r\n vTexCoord = aTexCoord;\r\n\r\n if (uColorCoding == 1.0)\r\n {\r\n vIdColor = getIdColor(aId);\r\n return;\r\n }\r\n\r\n if (uColorCoding > 1.0)\r\n {\r\n vIdColor = getIdColor(float(uColorCoding));\r\n return;\r\n }\r\n \r\n bool isSelected = abs(uSelection - aId) < 0.1;\r\n if (isSelected){\r\n vIdColor = vec4(-1.0, -1.0, -1.0, -1.0);\r\n }\r\n else{\r\n vIdColor = vec4(1.0, 1.0, 1.0, 1.0);\r\n }\r\n}"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cube_fshader="precision mediump float;\r\n\r\nuniform float uAlpha;\r\nuniform sampler2D uTexture;\r\nuniform mediump float uColorCoding;\r\nuniform float uHighlighting;\r\n\r\nvarying vec2 vTexCoord;\r\nvarying vec4 vIdColor;\r\n\r\n\r\nvoid main(void) {\r\n if (uColorCoding > 0.0)\r\n {\r\n gl_FragColor = vIdColor;\r\n }\r\n else\r\n {\r\n vec4 pixel = texture2D(uTexture, vTexCoord);\r\n if (vIdColor.x < 0.0)\r\n {\r\n \r\n gl_FragColor = vec4(pixel.rgb * uHighlighting, uAlpha);\r\n }\r\n else\r\n {\r\n \r\n gl_FragColor = vec4(pixel.rgb, uAlpha);\r\n }\r\n }\r\n}"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(34),i=r(33),a=r(32),o=r(0),s=r(1),u=function(){function t(t){this.TOP=1,this.BOTTOM=2,this.LEFT=3,this.RIGHT=4,this.FRONT=5,this.BACK=6,this.TOP_LEFT_FRONT=7,this.TOP_RIGHT_FRONT=8,this.TOP_LEFT_BACK=9,this.TOP_RIGHT_BACK=10,this.BOTTOM_LEFT_FRONT=11,this.BOTTOM_RIGHT_FRONT=12,this.BOTTOM_LEFT_BACK=13,this.BOTTOM_RIGHT_BACK=14,this.TOP_LEFT=15,this.TOP_RIGHT=16,this.TOP_FRONT=17,this.TOP_BACK=18,this.BOTTOM_LEFT=19,this.BOTTOM_RIGHT=20,this.BOTTOM_FRONT=21,this.BOTTOM_BACK=22,this.FRONT_RIGHT=23,this.FRONT_LEFT=24,this.BACK_RIGHT=25,this.BACK_LEFT=26,this._initialized=!1,this._modelId=1000001,this.ratio=.15,this.minSize=50,this.maxSize=200,this.highlighting=1.2,this.activeAlpha=1,this.passiveAlpha=.7,this.position=this.BOTTOM_RIGHT,this.trueNorth=0,this._stopped=!1,this.vertices=new Float32Array([-.3,-.5,-.3,.3,-.5,-.3,.3,-.5,.3,-.3,-.5,.3,-.3,.5,-.3,-.3,.5,.3,.3,.5,.3,.3,.5,-.3,-.3,-.3,.5,.3,-.3,.5,.3,.3,.5,-.3,.3,.5,-.3,-.3,-.5,-.3,.3,-.5,.3,.3,-.5,.3,-.3,-.5,.5,-.3,-.3,.5,.3,-.3,.5,.3,.3,.5,-.3,.3,-.5,-.3,-.3,-.5,-.3,.3,-.5,.3,.3,-.5,.3,-.3,-.5,-.5,.5,-.3,-.5,.5,-.3,-.3,.5,-.5,-.3,.5,-.5,-.5,.3,-.5,-.5,.5,-.5,-.3,.5,-.5,-.3,.3,-.5,-.5,.3,-.3,-.5,.3,-.3,-.5,.5,-.5,-.5,.5,.3,-.5,.5,.5,-.5,.5,.5,-.3,.5,.3,-.3,.5,.5,-.5,.3,.5,-.3,.3,.5,-.3,.5,.5,-.5,.5,.3,-.5,.3,.5,-.5,.3,.5,-.5,.5,.3,-.5,.5,-.5,.3,.5,-.3,.3,.5,-.3,.5,.5,-.5,.5,.5,-.5,.3,.3,-.5,.3,.5,-.5,.5,.5,-.5,.5,.3,-.5,.5,.3,-.5,.5,.5,-.3,.5,.5,-.3,.5,.3,.3,.3,.5,.5,.3,.5,.5,.5,.5,.3,.5,.5,.5,.3,.3,.5,.5,.3,.5,.5,.5,.5,.3,.5,.3,.5,.3,.3,.5,.5,.5,.5,.5,.5,.5,.3,-.5,-.5,-.5,-.3,-.5,-.5,-.3,-.3,-.5,-.5,-.3,-.5,-.5,-.5,-.5,-.5,-.5,-.3,-.5,-.3,-.3,-.5,-.3,-.5,-.5,-.5,-.5,-.3,-.5,-.5,-.3,-.5,-.3,-.5,-.5,-.3,.3,-.5,-.5,.5,-.5,-.5,.5,-.3,-.5,.3,-.3,-.5,.5,-.5,-.5,.5,-.3,-.5,.5,-.3,-.3,.5,-.5,-.3,.3,-.5,-.5,.5,-.5,-.5,.5,-.5,-.3,.3,-.5,-.3,-.5,.3,-.5,-.3,.3,-.5,-.3,.5,-.5,-.5,.5,-.5,-.5,.3,-.5,-.5,.3,-.3,-.5,.5,-.3,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.3,-.3,.5,-.3,-.3,.5,-.5,.3,.3,-.5,.5,.3,-.5,.5,.5,-.5,.3,.5,-.5,.5,.3,-.5,.5,.5,-.5,.5,.5,-.3,.5,.3,-.3,.3,.5,-.5,.3,.5,-.3,.5,.5,-.3,.5,.5,-.5,.3,-.3,.5,.5,-.3,.5,.5,.3,.5,.3,.3,.5,.5,-.3,.3,.5,.3,.3,.5,.3,.5,.5,-.3,.5,-.5,-.3,.5,-.3,-.3,.5,-.3,.3,.5,-.5,.3,.5,-.5,-.3,.3,-.5,-.3,.5,-.5,.3,.5,-.5,.3,.3,-.3,-.5,.5,.3,-.5,.5,.3,-.3,.5,-.3,-.3,.5,-.3,-.5,.3,.3,-.5,.3,.3,-.5,.5,-.3,-.5,.5,-.3,.3,.5,.3,.3,.5,.3,.5,.5,-.3,.5,.5,-.3,.5,.3,-.3,.5,.5,.3,.5,.5,.3,.5,.3,.3,-.3,-.5,.5,-.3,-.5,.5,.3,-.5,.3,.3,-.5,.5,-.3,-.5,.5,.3,-.5,.5,.3,-.3,.5,-.3,-.3,-.5,-.3,-.5,-.5,.3,-.5,-.3,.3,-.5,-.3,-.3,-.5,-.5,-.3,-.5,-.5,-.3,-.3,-.5,.3,-.3,-.5,.3,-.5,-.3,-.5,-.5,.3,-.5,-.5,.3,-.3,-.5,-.3,-.3,-.5,-.3,-.5,-.5,.3,-.5,-.5,.3,-.5,-.3,-.3,-.5,-.3,-.3,.3,-.5,.3,.3,-.5,.3,.5,-.5,-.3,.5,-.5,-.3,.5,-.5,-.3,.5,-.3,.3,.5,-.3,.3,.5,-.5,.3,-.5,-.3,.5,-.5,-.3,.5,-.5,.3,.3,-.5,.3,.5,-.5,-.3,.5,-.3,-.3,.5,-.3,.3,.5,-.5,.3,-.5,-.5,-.3,-.3,-.5,-.3,-.3,-.5,.3,-.5,-.5,.3,-.5,-.5,-.3,-.5,-.5,.3,-.5,-.3,.3,-.5,-.3,-.3,.3,.5,-.3,.3,.5,.3,.5,.5,.3,.5,.5,-.3,.5,.3,-.3,.5,.5,-.3,.5,.5,.3,.5,.3,.3,-.5,.5,-.3,-.5,.5,.3,-.3,.5,.3,-.3,.5,-.3,-.5,.3,-.3,-.5,.3,.3,-.5,.5,.3,-.5,.5,-.3]),this.indices=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23,24,25,26,24,26,27,28,29,30,28,30,31,32,33,34,32,34,35,36,37,38,36,38,39,40,41,42,40,42,43,44,45,46,44,46,47,48,49,50,48,50,51,52,53,54,52,54,55,56,57,58,56,58,59,60,61,62,60,62,63,64,65,66,64,66,67,68,69,70,68,70,71,72,74,73,72,75,74,76,77,78,76,78,79,80,81,82,80,82,83,84,86,85,84,87,86,88,89,90,88,90,91,92,93,94,92,94,95,96,98,97,96,99,98,100,101,102,100,102,103,104,105,106,104,106,107,108,110,109,108,111,110,112,113,114,112,114,115,116,117,118,116,118,119,120,121,122,120,122,123,124,125,126,124,126,127,128,129,130,128,130,131,132,133,134,132,134,135,136,137,138,136,138,139,140,141,142,140,142,143,144,145,146,144,146,147,148,149,150,148,150,151,152,154,153,152,155,154,156,157,158,156,158,159,160,161,162,160,162,163,164,165,166,164,166,167,168,170,169,168,171,170,172,173,174,172,174,175,176,178,177,176,179,178,180,181,182,180,182,183,184,185,186,184,186,187,188,189,190,188,190,191,192,193,194,192,194,195,196,197,198,196,198,199,200,201,202,200,202,203,204,205,206,204,206,207,208,209,210,208,210,211,212,213,214,212,214,215]),this.txtCoords=new Float32Array([1/3+1/15,0+1/15,.6,0+1/15,.6,1/3-1/15,1/3+1/15,1/3-1/15,1-1/15,0+1/15,1-1/15,1/3-1/15,2/3+1/15,1/3-1/15,2/3+1/15,0+1/15,2/3+1/15,1/3+1/15,1-1/15,1/3+1/15,1-1/15,.6,2/3+1/15,.6,0+1/15,1/3-1/15,0+1/15,0+1/15,1/3-1/15,0+1/15,1/3-1/15,1/3-1/15,0+1/15,1/3+1/15,1/3-1/15,1/3+1/15,1/3-1/15,.6,0+1/15,.6,.6,1/3+1/15,.6,.6,1/3+1/15,.6,1/3+1/15,1/3+1/15,.7,1/3+1/30,.7,1/3+1/30,.7,1/3+1/30,.7,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,.7,1/3+1/30,.7,1/3+1/30,.7,1/3+1/30,.7,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,.7,1/3+1/30,.7,1/3+1/30,.7,1/3+1/30,.7,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,.7,1/30,.7,1/30,.7,1/30,.7,1/30,.7,1/3+1/30,.7,1/3+1/30,.7,1/3+1/30,.7,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,.7,1/30,.7,1/30,.7,1/30,.7,1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,1/3+1/30,.7,1/30,.7,1/30,.7,1/30,.7,1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,1/30,1/3+1/30,.7,1/30,.7,1/30,.7,1/30,.7,1/30,2/3+2/30,1/3+1/30,2/3+2/30,1/3+1/30,2/3+2/30,1/3+1/30,2/3+2/30,1/3+1/30,2/30,1/3+1/30,2/30,1/3+1/30,2/30,1/3+1/30,2/30,1/3+1/30,2/3+2/30,1/3+1/30,2/3+2/30,1/3+1/30,2/3+2/30,1/3+1/30,2/3+2/30,1/3+1/30,1/3+2/30,1/3+1/30,1/3+2/30,1/3+1/30,1/3+2/30,1/3+1/30,1/3+2/30,1/3+1/30,2/3+2/30,1/3+1/30,2/3+2/30,1/3+1/30,2/3+2/30,1/3+1/30,2/3+2/30,1/3+1/30,1/3+2/30,1/30,1/3+2/30,1/30,1/3+2/30,1/30,1/3+2/30,1/30,2/3+2/30,1/3+1/30,2/3+2/30,1/3+1/30,2/3+2/30,1/3+1/30,2/3+2/30,1/3+1/30,2/3+2/30,1/30,2/3+2/30,1/30,2/3+2/30,1/30,2/3+2/30,1/30,2/30,1/30,2/30,1/30,2/30,1/30,2/30,1/30,2/30,1/3+1/30,2/30,1/3+1/30,2/30,1/3+1/30,2/30,1/3+1/30,2/30,1/30,2/30,1/30,2/30,1/30,2/30,1/30,1/3+2/30,1/3+1/30,1/3+2/30,1/3+1/30,1/3+2/30,1/3+1/30,1/3+2/30,1/3+1/30,2/30,1/30,2/30,1/30,2/30,1/30,2/30,1/30,1/3+2/30,1/30,1/3+2/30,1/30,1/3+2/30,1/30,1/3+2/30,1/30,2/30,1/30,2/30,1/30,2/30,1/30,2/30,1/30,2/3+2/30,1/30,2/3+2/30,1/30,2/3+2/30,1/30,2/3+2/30,1/30,1/3+2/30,1/30,1/3+2/30,1/30,1/3+2/30,1/30,1/3+2/30,1/30,2/30,1/3+1/30,2/30,1/3+1/30,2/30,1/3+1/30,2/30,1/3+1/30,1/3+2/30,1/30,1/3+2/30,1/30,1/3+2/30,1/30,1/3+2/30,1/30,1/3+2/30,1/3+1/30,1/3+2/30,1/3+1/30,1/3+2/30,1/3+1/30,1/3+2/30,1/3+1/30,2/3+2/30,1/30,2/3+2/30,1/30,2/3+2/30,1/30,2/3+2/30,1/30,2/30,1/3+1/30,2/30,1/3+1/30,2/30,1/3+1/30,2/30,1/3+1/30,2/3+2/30,1/30,2/3+2/30,1/30,2/3+2/30,1/30,2/3+2/30,1/30,1/3+2/30,1/3+1/30,1/3+2/30,1/3+1/30,1/3+2/30,1/3+1/30,1/3+2/30,1/3+1/30]),this.ids=new Float32Array([this.FRONT,this.FRONT,this.FRONT,this.FRONT,this.BACK,this.BACK,this.BACK,this.BACK,this.TOP,this.TOP,this.TOP,this.TOP,this.BOTTOM,this.BOTTOM,this.BOTTOM,this.BOTTOM,this.RIGHT,this.RIGHT,this.RIGHT,this.RIGHT,this.LEFT,this.LEFT,this.LEFT,this.LEFT,this.TOP_LEFT_FRONT,this.TOP_LEFT_FRONT,this.TOP_LEFT_FRONT,this.TOP_LEFT_FRONT,this.TOP_LEFT_FRONT,this.TOP_LEFT_FRONT,this.TOP_LEFT_FRONT,this.TOP_LEFT_FRONT,this.TOP_LEFT_FRONT,this.TOP_LEFT_FRONT,this.TOP_LEFT_FRONT,this.TOP_LEFT_FRONT,this.TOP_RIGHT_FRONT,this.TOP_RIGHT_FRONT,this.TOP_RIGHT_FRONT,this.TOP_RIGHT_FRONT,this.TOP_RIGHT_FRONT,this.TOP_RIGHT_FRONT,this.TOP_RIGHT_FRONT,this.TOP_RIGHT_FRONT,this.TOP_RIGHT_FRONT,this.TOP_RIGHT_FRONT,this.TOP_RIGHT_FRONT,this.TOP_RIGHT_FRONT,this.TOP_LEFT_BACK,this.TOP_LEFT_BACK,this.TOP_LEFT_BACK,this.TOP_LEFT_BACK,this.TOP_LEFT_BACK,this.TOP_LEFT_BACK,this.TOP_LEFT_BACK,this.TOP_LEFT_BACK,this.TOP_LEFT_BACK,this.TOP_LEFT_BACK,this.TOP_LEFT_BACK,this.TOP_LEFT_BACK,this.TOP_RIGHT_BACK,this.TOP_RIGHT_BACK,this.TOP_RIGHT_BACK,this.TOP_RIGHT_BACK,this.TOP_RIGHT_BACK,this.TOP_RIGHT_BACK,this.TOP_RIGHT_BACK,this.TOP_RIGHT_BACK,this.TOP_RIGHT_BACK,this.TOP_RIGHT_BACK,this.TOP_RIGHT_BACK,this.TOP_RIGHT_BACK,this.BOTTOM_LEFT_FRONT,this.BOTTOM_LEFT_FRONT,this.BOTTOM_LEFT_FRONT,this.BOTTOM_LEFT_FRONT,this.BOTTOM_LEFT_FRONT,this.BOTTOM_LEFT_FRONT,this.BOTTOM_LEFT_FRONT,this.BOTTOM_LEFT_FRONT,this.BOTTOM_LEFT_FRONT,this.BOTTOM_LEFT_FRONT,this.BOTTOM_LEFT_FRONT,this.BOTTOM_LEFT_FRONT,this.BOTTOM_RIGHT_FRONT,this.BOTTOM_RIGHT_FRONT,this.BOTTOM_RIGHT_FRONT,this.BOTTOM_RIGHT_FRONT,this.BOTTOM_RIGHT_FRONT,this.BOTTOM_RIGHT_FRONT,this.BOTTOM_RIGHT_FRONT,this.BOTTOM_RIGHT_FRONT,this.BOTTOM_RIGHT_FRONT,this.BOTTOM_RIGHT_FRONT,this.BOTTOM_RIGHT_FRONT,this.BOTTOM_RIGHT_FRONT,this.BOTTOM_LEFT_BACK,this.BOTTOM_LEFT_BACK,this.BOTTOM_LEFT_BACK,this.BOTTOM_LEFT_BACK,this.BOTTOM_LEFT_BACK,this.BOTTOM_LEFT_BACK,this.BOTTOM_LEFT_BACK,this.BOTTOM_LEFT_BACK,this.BOTTOM_LEFT_BACK,this.BOTTOM_LEFT_BACK,this.BOTTOM_LEFT_BACK,this.BOTTOM_LEFT_BACK,this.BOTTOM_RIGHT_BACK,this.BOTTOM_RIGHT_BACK,this.BOTTOM_RIGHT_BACK,this.BOTTOM_RIGHT_BACK,this.BOTTOM_RIGHT_BACK,this.BOTTOM_RIGHT_BACK,this.BOTTOM_RIGHT_BACK,this.BOTTOM_RIGHT_BACK,this.BOTTOM_RIGHT_BACK,this.BOTTOM_RIGHT_BACK,this.BOTTOM_RIGHT_BACK,this.BOTTOM_RIGHT_BACK,this.TOP_RIGHT,this.TOP_RIGHT,this.TOP_RIGHT,this.TOP_RIGHT,this.TOP_RIGHT,this.TOP_RIGHT,this.TOP_RIGHT,this.TOP_RIGHT,this.TOP_LEFT,this.TOP_LEFT,this.TOP_LEFT,this.TOP_LEFT,this.TOP_LEFT,this.TOP_LEFT,this.TOP_LEFT,this.TOP_LEFT,this.TOP_FRONT,this.TOP_FRONT,this.TOP_FRONT,this.TOP_FRONT,this.TOP_FRONT,this.TOP_FRONT,this.TOP_FRONT,this.TOP_FRONT,this.TOP_BACK,this.TOP_BACK,this.TOP_BACK,this.TOP_BACK,this.TOP_BACK,this.TOP_BACK,this.TOP_BACK,this.TOP_BACK,this.BOTTOM_RIGHT,this.BOTTOM_RIGHT,this.BOTTOM_RIGHT,this.BOTTOM_RIGHT,this.BOTTOM_RIGHT,this.BOTTOM_RIGHT,this.BOTTOM_RIGHT,this.BOTTOM_RIGHT,this.BOTTOM_LEFT,this.BOTTOM_LEFT,this.BOTTOM_LEFT,this.BOTTOM_LEFT,this.BOTTOM_LEFT,this.BOTTOM_LEFT,this.BOTTOM_LEFT,this.BOTTOM_LEFT,this.BOTTOM_FRONT,this.BOTTOM_FRONT,this.BOTTOM_FRONT,this.BOTTOM_FRONT,this.BOTTOM_FRONT,this.BOTTOM_FRONT,this.BOTTOM_FRONT,this.BOTTOM_FRONT,this.BOTTOM_BACK,this.BOTTOM_BACK,this.BOTTOM_BACK,this.BOTTOM_BACK,this.BOTTOM_BACK,this.BOTTOM_BACK,this.BOTTOM_BACK,this.BOTTOM_BACK,this.FRONT_RIGHT,this.FRONT_RIGHT,this.FRONT_RIGHT,this.FRONT_RIGHT,this.FRONT_RIGHT,this.FRONT_RIGHT,this.FRONT_RIGHT,this.FRONT_RIGHT,this.FRONT_LEFT,this.FRONT_LEFT,this.FRONT_LEFT,this.FRONT_LEFT,this.FRONT_LEFT,this.FRONT_LEFT,this.FRONT_LEFT,this.FRONT_LEFT,this.BACK_RIGHT,this.BACK_RIGHT,this.BACK_RIGHT,this.BACK_RIGHT,this.BACK_RIGHT,this.BACK_RIGHT,this.BACK_RIGHT,this.BACK_RIGHT,this.BACK_LEFT,this.BACK_LEFT,this.BACK_LEFT,this.BACK_LEFT,this.BACK_LEFT,this.BACK_LEFT,this.BACK_LEFT,this.BACK_LEFT]),this._image=t}return Object.defineProperty(t.prototype,"stopped",{get:function(){return this._stopped},set:function(t){this._stopped=t,this.viewer&&this.viewer.draw()},enumerable:!0,configurable:!0}),t.prototype.init=function(t){var e=this;this.viewer=t;var r=this.viewer.gl;this._shader=null,this._initShader(),this._alpha=this.passiveAlpha,this._selection=0,r.useProgram(this._shader),this._pMatrixUniformPointer=r.getUniformLocation(this._shader,"uPMatrix"),this._rotationUniformPointer=r.getUniformLocation(this._shader,"uRotation"),this._colourCodingUniformPointer=r.getUniformLocation(this._shader,"uColorCoding"),this._alphaUniformPointer=r.getUniformLocation(this._shader,"uAlpha"),this._selectionUniformPointer=r.getUniformLocation(this._shader,"uSelection"),this._textureUniformPointer=r.getUniformLocation(this._shader,"uTexture"),this._highlightingUniformPointer=r.getUniformLocation(this._shader,"uHighlighting"),this._vertexAttrPointer=r.getAttribLocation(this._shader,"aVertex"),this._texCoordAttrPointer=r.getAttribLocation(this._shader,"aTexCoord"),this._idAttrPointer=r.getAttribLocation(this._shader,"aId"),r.enableVertexAttribArray(this._vertexAttrPointer),r.enableVertexAttribArray(this._texCoordAttrPointer),r.enableVertexAttribArray(this._idAttrPointer),this._indexBuffer=r.createBuffer(),this._vertexBuffer=r.createBuffer(),this._texCoordBuffer=r.createBuffer(),this._idBuffer=r.createBuffer(),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this._indexBuffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,this.indices,r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,this._vertexBuffer),r.bufferData(r.ARRAY_BUFFER,this.vertices,r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,this._texCoordBuffer),r.bufferData(r.ARRAY_BUFFER,this.txtCoords,r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,this._idBuffer),r.bufferData(r.ARRAY_BUFFER,this.ids,r.STATIC_DRAW);var n=this;if(this._texture=r.createTexture(),void 0===this._image){var i=a.CubeTextures.en,s=new Image;n._image=s,s.addEventListener("load",(function(){r.bindTexture(r.TEXTURE_2D,n._texture),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,1),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n._image),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_NEAREST),r.generateMipmap(r.TEXTURE_2D)})),s.src=i}else r.bindTexture(r.TEXTURE_2D,n._texture),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,1),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n._image),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_NEAREST),r.generateMipmap(r.TEXTURE_2D);t.canvas.addEventListener("mousemove",(function(r){if(!(e.stopped||t.plugins.indexOf(e)<0)){var i=r.clientX,a=r.clientY,o=t.canvas.getBoundingClientRect(),s=i-o.left,u=t.height-(a-o.top);if(n._region){if(!n.isInRegion(s,u))return n._alpha=n.passiveAlpha,void(n._selection=0);var c=e.getId(r);null==c?(n._alpha=n.passiveAlpha,n._selection=0):c>=n.TOP&&c<=n.BACK_LEFT&&(n._alpha=n.activeAlpha,n._selection=c),e.onAfterDraw(t.width,t.height)}}}),!0),n._drag=!1,t.canvas.addEventListener("mousedown",(function(r){if(!(e.stopped||t.plugins.indexOf(e)<0)){var i=r.clientX,a=r.clientY,o=t.canvas.getBoundingClientRect(),s=i-o.left,u=t.height-(a-o.top);if(e._region&&n.isInRegion(s,u)){var c=e.getId(r);null!=c&&c>=n.TOP&&c<=n.BACK_LEFT&&(n._drag=!0,n._originalNavigation=t.navigationMode,t.navigationMode="orbit")}}}),!0),window.addEventListener("mouseup",(function(r){e.stopped||t.plugins.indexOf(e)<0||!0===n._drag&&(t.navigationMode=n._originalNavigation),n._drag=!1}),!0),t.on("pick",(function(r){if(null==r.model){var n=r.event;if(n instanceof MouseEvent||n instanceof TouchEvent){var i;i=n instanceof MouseEvent?n:n.changedTouches[0];var a=e.getId(i),s=o.vec3.create(),u=o.vec3.fromValues(0,0,1);switch(a){case e.TOP:s=o.vec3.fromValues(0,0,1),u=o.vec3.fromValues(0,1,0);break;case e.BOTTOM:s=o.vec3.fromValues(0,0,-1),u=o.vec3.fromValues(0,-1,0);break;case e.FRONT:s=o.vec3.fromValues(0,-1,0);break;case e.BACK:s=o.vec3.fromValues(0,1,0);break;case e.LEFT:s=o.vec3.fromValues(-1,0,0);break;case e.RIGHT:s=o.vec3.fromValues(1,0,0);break;case e.TOP_LEFT_FRONT:s=o.vec3.fromValues(-1,-1,1);break;case e.TOP_RIGHT_FRONT:s=o.vec3.fromValues(1,-1,1);break;case e.TOP_LEFT_BACK:s=o.vec3.fromValues(-1,1,1);break;case e.TOP_RIGHT_BACK:s=o.vec3.fromValues(1,1,1);break;case e.BOTTOM_LEFT_FRONT:s=o.vec3.fromValues(-1,-1,-1);break;case e.BOTTOM_RIGHT_FRONT:s=o.vec3.fromValues(1,-1,-1);break;case e.BOTTOM_LEFT_BACK:s=o.vec3.fromValues(-1,1,-1);break;case e.BOTTOM_RIGHT_BACK:s=o.vec3.fromValues(1,1,-1);break;case e.TOP_LEFT:s=o.vec3.fromValues(-1,0,1);break;case e.TOP_RIGHT:s=o.vec3.fromValues(1,0,1);break;case e.TOP_FRONT:s=o.vec3.fromValues(0,-1,1);break;case e.TOP_BACK:s=o.vec3.fromValues(0,1,1);break;case e.BOTTOM_LEFT:s=o.vec3.fromValues(-1,0,-1);break;case e.BOTTOM_RIGHT:s=o.vec3.fromValues(1,0,-1);break;case e.BOTTOM_FRONT:s=o.vec3.fromValues(0,-1,-1);break;case e.BOTTOM_BACK:s=o.vec3.fromValues(0,1,-1);break;case e.FRONT_RIGHT:s=o.vec3.fromValues(1,-1,0);break;case e.FRONT_LEFT:s=o.vec3.fromValues(-1,-1,0);break;case e.BACK_RIGHT:s=o.vec3.fromValues(1,1,0);break;case e.BACK_LEFT:s=o.vec3.fromValues(-1,1,0);break;default:return!1}var c=t.getTargetBoundingBox(),l=o.vec3.fromValues(c[0]+c[3]/2,c[1]+c[4]/2,c[2]+c[5]/2);if(s=o.vec3.normalize(o.vec3.create(),s),0!==e.trueNorth){var f=-e.trueNorth*Math.PI/180,h=o.quat.rotateZ(o.quat.create(),o.quat.create(),f);s=o.vec3.transformQuat(o.vec3.create(),s,h),u=o.vec3.transformQuat(o.vec3.create(),u,h)}var d=t.getDistanceAndHeight(c,s,u),A=o.vec3.scale(o.vec3.create(),s,d.distance),p=o.vec3.add(o.vec3.create(),l,A),I=o.mat4.lookAt(o.mat4.create(),p,l,u);e.viewer.animations.viewTo({mv:I,height:d.height},e.viewer.zoomDuration)}}})),this._initialized=!0},t.prototype.onBeforeDraw=function(t,e){},t.prototype.onBeforePick=function(t){return t.model===this._modelId&&null!=t.id},t.prototype.onAfterDraw=function(t,e){if(!this.stopped){var r=this.setActive();r.disable(r.BLEND),r.disable(r.DEPTH_TEST),r.uniform1f(this._colourCodingUniformPointer,0),this.draw(t,e)}},t.prototype.onBeforeDrawId=function(){},t.prototype.onAfterDrawId=function(){this.stopped||(this.setActive().uniform1f(this._colourCodingUniformPointer,1),this.draw(this.viewer.width,this.viewer.height))},t.prototype.onAfterDrawModelId=function(){this.stopped||(this.setActive().uniform1f(this._colourCodingUniformPointer,this._modelId),this.draw(this.viewer.width,this.viewer.height))},t.prototype.getId=function(t){var e=t.clientX,r=t.clientY,n=this.viewer.canvas.getBoundingClientRect(),i=e-n.left,a=this.viewer.height-(r-n.top),o=this.viewer.gl,u=new s.Framebuffer(o,this.viewer.width,this.viewer.height,this.viewer.hasDepthSupport);o.viewport(0,0,this.viewer.width,this.viewer.height),o.enable(o.DEPTH_TEST),o.disable(o.BLEND),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),this.onAfterDrawId();var c=u.getId(i,a);return u.delete(),c},t.prototype.setActive=function(){var t=this.viewer.gl;return t.useProgram(this._shader),t},t.prototype.isInRegion=function(t,e){var r=this._region[0]*this.viewer.width,n=this._region[2]*this.viewer.width,i=this._region[1]*this.viewer.height,a=this._region[3]*this.viewer.height;return!(t<r||t>n||e<i||e>a)},t.prototype.draw=function(t,e){if(!this.stopped&&this._initialized){var r=this.viewer.gl,n=Math.min(t,e),i=this.minSize/n,a=this.maxSize/n,s=this.ratio;s<i?s=i:s>a&&(s=a);var u=o.mat4.create(),c=1/s,l=c/e*t;e>t&&(c=(l=1/s)/t*e);var f=s*e/t*2,h=2*s;switch(this.position){case this.BOTTOM_RIGHT:o.mat4.ortho(u,1-l,1,-1,c-1,-1,1),this._region=[1-f,0,1,h];break;case this.BOTTOM_LEFT:o.mat4.ortho(u,-1,l-1,-1,c-1,-1,1),this._region=[0,0,f,h];break;case this.TOP_LEFT:o.mat4.ortho(u,-1,l-1,1-c,1,-1,1),this._region=[0,1-h,f,1];break;case this.TOP_RIGHT:o.mat4.ortho(u,1-l,1,1-c,1,-1,1),this._region=[1-f,1-h,1,1]}var d=o.mat3.fromMat4(o.mat3.create(),this.viewer.mvMatrix);if(0!==this.trueNorth){var A=-this.trueNorth*Math.PI/180,p=o.mat3.fromRotation(o.mat3.create(),A);d=o.mat3.multiply(o.mat3.create(),d,p)}r.uniformMatrix4fv(this._pMatrixUniformPointer,!1,u),r.uniformMatrix3fv(this._rotationUniformPointer,!1,d),r.uniform1f(this._alphaUniformPointer,this._alpha),r.uniform1f(this._highlightingUniformPointer,this.highlighting),r.uniform1f(this._selectionUniformPointer,this._selection),r.bindBuffer(r.ARRAY_BUFFER,this._vertexBuffer),r.vertexAttribPointer(this._vertexAttrPointer,3,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this._idBuffer),r.vertexAttribPointer(this._idAttrPointer,1,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this._texCoordBuffer),r.vertexAttribPointer(this._texCoordAttrPointer,2,r.FLOAT,!1,0,0),r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,this._texture),r.uniform1i(this._textureUniformPointer,1);var I=r.getParameter(r.CULL_FACE);I||r.enable(r.CULL_FACE),r.disable(r.BLEND),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this._indexBuffer),r.drawElements(r.TRIANGLES,this.indices.length,r.UNSIGNED_SHORT,0),I||r.disable(r.CULL_FACE)}},t.prototype._initShader=function(){var t=this.viewer.gl,e=this.viewer,r=function(r,n){if(t.shaderSource(r,n),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){var i=t.getShaderInfoLog(r);return e.error(i),null}},a=t.createShader(t.FRAGMENT_SHADER);r(a,n.cube_fshader);var o=t.createShader(t.VERTEX_SHADER);r(o,i.cube_vshader),this._shader=t.createProgram(),t.attachShader(this._shader,o),t.attachShader(this._shader,a),t.linkProgram(this._shader),t.getProgramParameter(this._shader,t.LINK_STATUS)||e.error("Could not initialise shaders for a navigation cube plugin")},t}();e.NavigationCube=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),i=function(){function t(){}return t.findView=function(t,e,r){if(null==e||0===e.length)return null;var i=t.getTargetsBoundingBox(e),a=[{dir:[1,0,0],up:[0,0,1]},{dir:[0,1,0],up:[0,0,1]},{dir:[-1,0,0],up:[0,0,1]},{dir:[0,-1,0],up:[0,0,1]},{dir:[1,1,0],up:[0,0,1]},{dir:[-1,-1,0],up:[0,0,1]},{dir:[-1,1,0],up:[0,0,1]},{dir:[1,-1,0],up:[0,0,1]}].map((function(t){return{dir:n.vec3.normalize(n.vec3.create(),t.dir),up:n.vec3.normalize(n.vec3.create(),t.up)}})),o=i[3]*i[4],s=i[3]*i[5],u=i[4]*i[5];o>s&&o>u&&(a.push({dir:n.vec3.fromValues(0,0,-1),up:n.vec3.fromValues(0,1,0)}),a.push({dir:n.vec3.fromValues(0,0,-1),up:n.vec3.fromValues(1,0,0)}));for(var c=t.width/r,l=t.height/r,f=[],h=1;h<r;h++)for(var d=1;d<10;d++)f.push({x:h*c,y:d*l});var A=e.reduce((function(t,e){return t[e.model+"."+e.id]=!0,t}),{}),p=t.isRunning;t.stop();var I=t.mvMatrix,E=t.cameraProperties.height;try{var v=n.vec3.fromValues(i[0]+i[3]/2,i[1]+i[4]/2,i[2]+i[5]/2),T=a.map((function(e){return t.getDistanceAndHeight(i,e.dir,e.up)})),m=T.map((function(t,e){var r=n.vec3.negate(n.vec3.create(),a[e].dir),i=n.vec3.scale(n.vec3.create(),r,t.distance),o=n.vec3.add(n.vec3.create(),i,v);return n.mat4.lookAt(n.mat4.create(),o,v,a[e].up)})),C=m.map((function(e,r){return t.mvMatrix=e,t.cameraProperties.height=T[r].height,t.getData(f).map((function(t){return null!=t?t.model+"."+t.id:null}))})).map((function(t){return t.reduce((function(t,e){return null==e||!0===A[e]&&(t.count++,null==t.types[e]?t.types[e]=1:t.types[e]=t.types[e]+1),t}),{count:0,types:{}})})).map((function(t){return t.count*Math.pow(Object.getOwnPropertyNames(t.types).length,2)})),g=0,R=0;return C.forEach((function(t,e){t>R&&(R=t,g=e)})),R>0?{mv:m[g],height:T[g].height}:null}finally{t.mvMatrix=I,t.cameraProperties.height=E,p&&t.start()}},t}();e.PreflightCheck=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),i=r(0),a=r(3),o=function(){function t(t,e,r){this.viewer=t,this.request=e,this.density=r,this.lastMvChange=0,this.dirty=!0,this.stopped=!0}return t.prototype.stop=function(){this.stopped=!0},t.prototype.watch=function(t){var e=this;if(void 0===t&&(t=500),this.viewer.hasDepthSupport){var r=this.request,n=this.viewer;this.stopped=!1;var i=function(){if(!e.stopped){if(!(Date.now()-e.lastMvChange<t+20))return n.mvMatrixAge<t?(e.dirty=!0,void r(i)):void(n.mvMatrixAge>t&&!e.dirty?r(i):n.height?(e.adjust(),e.dirty=!1,r(i)):r(i));r(i)}};r(i)}},t.prototype.adjust=function(){var t=this.viewer,e=this.density;if(t.hasDepthSupport){var r=t.width/4,o=t.height/4;if(0!==r&&0!==o){var s=new n.Framebuffer(t.gl,r,o,!0);t.draw(s,!0);for(var u=[],c=r/(e+1),l=o/(e+1),f=1;f<e+1;f++)for(var h=f*c,d=1;d<e+1;d++){var A=d*l;u.push({x:h,y:A})}var p=u.map((function(t){return 1})),I=s.getXYZArray(u).map((function(t,e){return null==t?null:{point:t,weight:p[e]}})).filter((function(t){return null!=t}));if(0!==I.length){var E=t.cameraProperties.getProjectionMatrix(r,o),v=i.mat4.invert(i.mat4.create(),E),T=I.map((function(t){return{point:i.vec3.transformMat4(i.vec3.create(),t.point,v),weight:t.weight}})).map((function(t){return{distance:-t.point[2],weight:t.weight}})),m=this.trimmedMean(T),C=t.cameraProperties.fov*Math.PI/180;if(t.camera===a.CameraType.PERSPECTIVE){var g=2*m*Math.tan(C/2);t.cameraProperties.height=g}if(t.camera===a.CameraType.ORTHOGONAL){var R=i.vec3.normalize(i.vec3.create(),t.getCameraDirection()),b=t.cameraProperties.height/(2*Math.tan(C/2)),M=b/m;if(M>1.1||M<.9){var F=b-m,y=i.vec3.scale(i.vec3.create(),R,F);t.mvMatrix=i.mat4.translate(i.mat4.create(),t.mvMatrix,y),this.lastMvChange=Date.now()}}}}}},t.prototype.trimmedMean=function(t){if(t.length>100){t.sort((function(t,e){return t.distance-e.distance}));var e=Math.floor(t.length/10);t=t.slice(e,t.length-e)}return t.reduce((function(t,e){return t+e.distance*e.weight}),0)/t.reduce((function(t,e){return t+e.weight}),0)},t}();e.CameraAdjustment=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.VERY_LOW=0]="VERY_LOW",t[t.LOW=1]="LOW",t[t.MEDIUM=2]="MEDIUM",t[t.HIGH=3]="HIGH"}(e.PerformanceRating||(e.PerformanceRating={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CheckResult=function(){this.warnings=[],this.errors=[],this.noErrors=!1,this.noWarnings=!1}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(11),i=r(39),a=function(){function t(){}return t.check=function(){var t=new i.CheckResult,e=document.createElement("canvas");if(e){var r=null,a=0;if(n.WebGLUtils.setupWebGL(e,(function(t,e){r=t,a=e}),null,(function(e){t.errors.push(e)})),null==r)t.errors.push("Browser doesn't support WebGL. This is critical.");else{!(a<2)||r.getExtension("OES_texture_float")||r.getExtension("MOZ_OES_texture_float")||r.getExtension("WEBKIT_OES_texture_float")||t.errors.push("Floating point texture extension is not supported."),!(a<2)||r.getExtension("WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||t.warnings.push("Depth texture extension is not available. It will not be possible to get 3D coordinates of user interactions.");var o=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS);o<4&&t.errors.push("Browser supports only "+o+" vertex texture image units but minimal requirement for the viewer is 4.")}}else t.errors.push("Browser doesn't have support for HTMLCanvasElement. This is critical.");return window.File&&window.FileReader&&window.Blob||t.errors.push("Browser doesn't support 'File', 'FileReader' or 'Blob' objects."),window.Int32Array&&window.Float32Array||t.errors.push("Browser doesn't support TypedArrays. These are crucial for binary parsing and for comunication with GPU."),0==t.errors.length&&(t.noErrors=!0),0==t.warnings.length&&(t.noWarnings=!0),t},t}();e.Abilities=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),i=function(){function t(){}return t.initTouchNavigationEvents=function(t){var e,r,i,a,o,s,u=n.vec3.create();t.canvas.addEventListener("touchstart",(function(c){return function(c){c.preventDefault(),c.touches.length>=1&&(e=c.touches[0].clientX,r=c.touches[0].clientY),c.touches.length>=2&&(i=c.touches[1].clientX,a=c.touches[1].clientY),c.touches.length>=3&&(o=c.touches[2].clientX,s=c.touches[2].clientY);var l=t.getEventDataFromEvent(c.touches[0]);if(null==l||null==l.id||null==l.model){var f=t.getMergedRegion();u=n.vec3.fromValues(f.centre[0],f.centre[1],f.centre[2])}else if(null==l.xyz){var h=t.getTargetBoundingBox(l.id,l.model);u=n.vec3.fromValues(h[0]+h[3]/2,h[1]+h[4]/2,h[2]+h[5]/2)}else u=l.xyz}(c)}),!0),t.canvas.addEventListener("touchmove",(function(n){return function(n){if(n.preventDefault(),"none"!==t.navigationMode&&n.touches)if(1===n.touches.length){var c=n.touches[0].clientX-e,l=n.touches[0].clientY-r;e=n.touches[0].clientX,r=n.touches[0].clientY,t.navigate("orbit",c,l,u)}else if(2===n.touches.length){var f=Math.sqrt((e-i)*(e-i)+(r-a)*(r-a));e=n.touches[0].clientX,r=n.touches[0].clientY,i=n.touches[1].clientX,a=n.touches[1].clientY,f>Math.sqrt((e-i)*(e-i)+(r-a)*(r-a))?t.navigate("zoom",-1,-1,u):t.navigate("zoom",1,1,u)}else if(3===n.touches.length){var h=(n.touches[0].clientX+n.touches[1].clientX+n.touches[2].clientX)/3-(e+i+o)/3,d=(n.touches[0].clientY+n.touches[1].clientY+n.touches[2].clientY)/3-(r+a+s)/3;e=n.touches[0].clientX,r=n.touches[0].clientY,i=n.touches[1].clientX,a=n.touches[1].clientY,s=n.touches[2].clientX,s=n.touches[2].clientY,t.navigate("pan",.2*h,.2*d,u)}}(n)}),!0)},t.initTouchTapEvents=function(t){var e,r,n=!1,i=new Date,a={id:null,model:null,xyz:null};t.canvas.addEventListener("touchstart",(function(o){return function(o){if(1===o.touches.length){n=!0,e=o.touches[0].clientX,r=o.touches[0].clientY;var s=t.canvas.getBoundingClientRect(),u=e-s.left,c=t.height-(r-s.top);a=t.getEventData(u,c);var l=new Date;l.getTime()-i.getTime()<200&&t.fire("dblclick",{id:a.id,model:a.model,event:o,xyz:a.xyz}),i=l,t.fire("mousedown",{id:a.id,model:a.model,event:o,xyz:a.xyz}),t.disableTextSelection()}}(o)}),!0),t.canvas.addEventListener("touchend",(function(i){return function(i){if(n){n=!1;var o=i.changedTouches[0].clientX,s=i.changedTouches[0].clientY,u=Math.abs(o-e),c=Math.abs(s-r);u<3&&c<3&&t.fire("pick",{id:a.id,model:a.model,event:i,xyz:a.xyz}),t.enableTextSelection()}}(i)}),!0)},t}();e.TouchNavigation=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),i=function(){function t(){}return t.initKeyboardEvents=function(t){document.addEventListener("keydown",(function(e){if("walk"===t.navigationMode){var r=function(){var e=t.getCameraDirection(),r=t.getCameraPosition(),i=10*t.unitsInMeter;return n.vec3.add(n.vec3.create(),r,n.vec3.scale(n.vec3.create(),e,i))},i=!0===e.shiftKey?3:1;switch(e.code){case"KeyW":t.navigate("walk",0,2*i,n.vec3.create());break;case"KeyS":t.navigate("walk",0,-2*i,n.vec3.create());break;case"KeyA":t.navigate("pan",4*i,0,r());break;case"KeyD":t.navigate("pan",-4*i,0,r());break;case"KeyR":case"ArrowUp":t.navigate("pan",0,4*i,r());break;case"KeyF":case"ArrowDown":t.navigate("pan",0,-4*i,r());break;case"KeyQ":case"ArrowLeft":t.navigate("look-around",2,0,t.getCameraPosition());break;case"KeyE":case"ArrowRight":t.navigate("look-around",-2,0,t.getCameraPosition())}}}),!1)},t}();e.KeyboardNavigation=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),i=function(){function t(){}return t.initMouseEvents=function(t){var e=!1,r=null,i=null,a=null,o=null,s="L",u=-1,c=-1,l=null,f=!1,h=n.vec3.create(),d=function(e){"walk"===t.navigationMode&&t.navigate("look-at",.5*e.movementX,.5*e.movementY,h)},A=null,p=null,I=0,E=t.canvas.requestPointerLock;null!=E&&(E=E.bind(t.canvas),t.canvas.onclick=function(){"walk"!==t.navigationMode||f||E()}),document.addEventListener("pointerlockchange",(function(e){document.pointerLockElement===t.canvas?f||(f=!0,t.canvas.addEventListener("mousemove",d,!1)):(f=!1,t.canvas.removeEventListener("mousemove",d,!1))}),!1);var v=0;t.canvas.addEventListener("mousedown",(function(f){return function(f){e=!0,r=f.clientX,i=f.clientY,a=f.clientX,o=f.clientY;var d=t.canvas.getBoundingClientRect(),A=a-d.left,p=t.height-(o-d.top),I=t.getEventData(A,p);if(null!=I){if(u=I.id,c=I.model,l=I.xyz,null==I||null==I.id||null==I.model){var E=t.getMergedRegion();if(null==E||null==E.centre)return void(e=!1);h=n.vec3.fromValues(E.centre[0],E.centre[1],E.centre[2])}else if(null==I.xyz){var v=t.getTargetBoundingBox(I.id,I.model);h=n.vec3.fromValues(v[0]+v[3]/2,v[1]+v[4]/2,v[2]+v[5]/2)}else h=I.xyz;switch(f.button){case 0:s="left";break;case 1:s="middle";break;case 2:s="right";break;default:s="left"}t.disableTextSelection()}else e=!1}(f)}),!0),t.canvas.addEventListener("wheel",(function(e){return function(e){if("none"!==t.navigationMode){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),I++;var r=n.vec2.fromValues(e.clientX,e.clientY);if(null==p||n.vec2.dist(p,r)>5||I>10){if(null==(A=t.getInteractionOrigin(e))){var i=t.getMergedRegion(),a=n.vec3.fromValues(i.centre[0],i.centre[1],i.centre[2]),o=t.getCameraPosition(),s=n.vec3.distance(a,o),u=n.mat4.invert(n.mat4.create(),t.mvMatrix),c=n.mat4.getRotation(n.quat.create(),u),l=n.vec3.normalize(n.vec3.create(),n.vec3.transformQuat(n.vec3.create(),[0,0,-1],c)),f=n.vec3.scale(n.vec3.create(),l,s);A=n.vec3.add(n.vec3.create(),f,o)}p=r,I=0}var h=function(t){return 0==(t=+t)||isNaN(t)?t:t>0?1:-1};t.navigate("zoom",-1*h(e.deltaX),-1*h(e.deltaY),A)}}(e)}),!0),window.addEventListener("mouseup",(function(r){return function(r){if(e){e=!1;var n=r.clientX,i=r.clientY,f=Math.abs(n-a),h=Math.abs(i-o);if(f<3&&h<3&&"left"===s){t.fire("pick",{id:u,model:c,event:r,xyz:l});var d=(new Date).getTime();d-v<250&&t.fire("dblclick",{id:u,model:c,event:r,xyz:l}),v=d}t.enableTextSelection()}}(r)}),!0),window.addEventListener("mousemove",(function(n){return function(n){if(e&&"none"!==t.navigationMode){var a=n.clientX,o=n.clientY,u=a-r,c=o-i;if(r=a,i=o,"left"===s)if(n.shiftKey)t.navigate("pan",u,c,h);else switch(t.navigationMode){case"free-orbit":t.navigate("free-orbit",u,c,h);break;case"fixed-orbit":case"orbit":t.navigate("orbit",u,c,h);break;case"pan":t.navigate("pan",u,c,h);break;case"zoom":t.navigate("zoom",u,c,h);break;case"look-around":t.navigate("look-around",u,c,h)}"middle"!==s&&"right"!==s||t.navigate("pan",u,c,h)}}(n)}),!0)},t}();e.MouseNavigation=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.vertex_shader_300="#version 300 es\r\nin highp float aVertexIndex;\r\nin highp float aTransformationIndex;\r\nin highp float aStyleIndex;\r\nin highp float aProduct;\r\nin highp vec2 aState;\r\nin highp vec2 aNormal;\r\n\r\n\r\nuniform mat4 uMVMatrix;\r\nuniform mat4 uPMatrix;\r\n\r\n\r\nuniform vec4 uHighlightColour;\r\n\r\n\r\nuniform vec4 uXRayColour;\r\n\r\n\r\nuniform float uMeter;\r\n\r\n\r\nuniform vec3 uWcs;\r\n\r\n\r\n\r\nuniform int uColorCoding;\r\n\r\n\r\n\r\n\r\n\r\n\r\nuniform int uRenderingMode;\r\n\r\n\r\nuniform highp sampler2D uVertexSampler;\r\nuniform highp float uVertexTextureSize;\r\n\r\n\r\nuniform highp sampler2D uMatrixSampler;\r\nuniform highp float uMatrixTextureSize;\r\n\r\n\r\nuniform highp sampler2D uStyleSampler;\r\nuniform highp float uStyleTextureSize;\r\n\r\n\r\nuniform highp sampler2D uStateStyleSampler;\r\n\r\n\r\nout vec4 vColor;\r\n\r\nout vec3 vPosition;\r\n\r\nout vec3 vNormal;\r\n\r\nout mediump float vDiscard;\r\n\r\nconst float PI = 3.1415926535897932384626433832795;\r\n\r\nvec3 getNormal(mat4 transform) {\r\n float U = aNormal[0];\r\n float V = aNormal[1];\r\n float lon = U / 252.0 * 2.0 * PI;\r\n float lat = V / 252.0 * PI;\r\n\r\n float x = sin(lon) * sin(lat);\r\n float z = cos(lon) * sin(lat);\r\n float y = cos(lat);\r\n\r\n vec3 normal = vec3(x, y, z);\r\n if (aTransformationIndex < -0.5) {\r\n return normalize(normal);\r\n }\r\n\r\n \r\n \r\n \r\n \r\n mat3 normTrans = mat3(transform);\r\n\r\n return normalize(vec3(normTrans * normal));\r\n}\r\n\r\nvec4 getIdColor(float id) {\r\n float B = floor(id / (256.0*256.0));\r\n float G = floor((id - B * 256.0*256.0) / 256.0);\r\n float R = mod(id, 256.0);\r\n \r\n \r\n\r\n return vec4(R / 255.0, G / 255.0, B / 255.0, 1.0);\r\n}\r\n\r\nvec2 getTextureCoordinates(float index, float size)\r\n{\r\n float x = floor(mod(index + 0.5, size)); \r\n float y = floor((index + 0.5)/ size); \r\n \r\n return vec2((x + 0.5) / size, (y + 0.5) / size);\r\n}\r\n\r\n\r\nvec4 getColor() { \r\n \r\n float restyle = aState[1];\r\n if (restyle > 224.5) {\r\n vec2 coords = getTextureCoordinates(aStyleIndex, uStyleTextureSize);\r\n vec4 col = texture(uStyleSampler, coords);\r\n \r\n \r\n if (uRenderingMode == 1) {\r\n float intensity = (col.r + col.g + col.b) / 3.0;\r\n return vec4(intensity, intensity, intensity, col.a);\r\n }\r\n\r\n \r\n return col;\r\n }\r\n\r\n \r\n \r\n vec2 coords = getTextureCoordinates(restyle, 15.0);\r\n vec4 col2 = texture(uStateStyleSampler, coords);\r\n\r\n \r\n if (uRenderingMode == 1) {\r\n float intensity = (col2.r + col2.g + col2.b) / 3.0;\r\n return vec4(intensity, intensity, intensity, col2.a);\r\n }\r\n\r\n return col2;\r\n}\r\n\r\nvec4 getVertexPosition(mat4 transform) {\r\n vec2 coords = getTextureCoordinates(aVertexIndex, uVertexTextureSize);\r\n vec3 point = vec3(texture(uVertexSampler, coords));\r\n\r\n if (aTransformationIndex < -0.5) {\r\n return vec4 (point, 1.0);\r\n }\r\n\r\n return transform * vec4(point, 1.0);\r\n}\r\n\r\nmat4 getTransform() {\r\n if (aTransformationIndex < -0.5) {\r\n return mat4(1.0);\r\n }\r\n\r\n float tIndex = aTransformationIndex * 4.0;\r\n\r\n \r\n vec2 c1 = getTextureCoordinates(tIndex, uMatrixTextureSize);\r\n vec2 c2 = getTextureCoordinates(tIndex + 1.0, uMatrixTextureSize);\r\n vec2 c3 = getTextureCoordinates(tIndex + 2.0, uMatrixTextureSize);\r\n vec2 c4 = getTextureCoordinates(tIndex + 3.0, uMatrixTextureSize);\r\n\r\n \r\n vec4 v1 = texture(uMatrixSampler, c1);\r\n vec4 v2 = texture(uMatrixSampler, c2);\r\n vec4 v3 = texture(uMatrixSampler, c3);\r\n vec4 v4 = texture(uMatrixSampler, c4);\r\n\r\n \r\n return mat4(v1, v2, v3, v4);\r\n}\r\n\r\nvoid main(void) {\r\n int state = int(floor(aState[0] + 0.5));\r\n vDiscard = 0.0;\r\n\r\n if (state == 254 || \r\n (uColorCoding == -1 && state == 251) || \r\n (uColorCoding == -1 && (\r\n (uRenderingMode == 2 && state != 253 && state != 252) || \r\n (uRenderingMode == 3 && (state == 253 || state == 252))) \r\n ))\r\n {\r\n vDiscard = 1.0;\r\n vColor = vec4(0.0, 0.0, 0.0, 0.0);\r\n vNormal = vec3(0.0, 0.0, 0.0);\r\n vPosition = vec3(0.0, 0.0, 0.0);\r\n gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\r\n return;\r\n }\r\n\r\n \r\n mat4 w = mat4(1.0);\r\n w[3] = w[3] + vec4(uWcs, 0.0);\r\n\r\n \r\n mat4 transform = getTransform();\r\n vPosition = vec3(w * getVertexPosition(transform));\r\n vNormal = getNormal(transform);\r\n\r\n \r\n vec4 baseColor = getColor();\r\n\r\n \r\n if (baseColor.a < 0.98)\r\n {\r\n float correction = -0.002;\r\n if (uColorCoding == -2 || uColorCoding >= 0) {\r\n correction = -0.02;\r\n }\r\n vec3 trans = correction * uMeter * normalize(vNormal);\r\n vPosition = vPosition + trans;\r\n }\r\n \r\n \r\n if (uColorCoding == -2) {\r\n float id = floor(aProduct + 0.5);\r\n vColor = getIdColor(id);\r\n vNormal = vec3(0.0, 0.0, 0.0);\r\n }\r\n \r\n else if (uColorCoding >= 0) {\r\n float id = float(uColorCoding);\r\n vColor = getIdColor(id);\r\n vNormal = vec3(0.0, 0.0, 0.0);\r\n }\r\n \r\n else {\r\n \r\n \r\n if (state == 253) {\r\n baseColor = uHighlightColour;\r\n }\r\n \r\n else if (uRenderingMode == 2 || uRenderingMode == 3) {\r\n \r\n if (state == 252) { \r\n baseColor = getColor();\r\n }\r\n \r\n else {\r\n baseColor = uXRayColour; \r\n }\r\n }\r\n \r\n vColor = baseColor;\r\n }\r\n\r\n \r\n gl_Position = uPMatrix * uMVMatrix * vec4(vPosition, 1.0);\r\n}"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fragment_shader_300="#version 300 es\r\nprecision mediump float;\r\n\r\nuniform vec4 uClippingPlaneA;\r\nuniform vec4 uClippingPlaneB;\r\nuniform bool uClippingA;\r\nuniform bool uClippingB;\r\n\r\nuniform vec3 uGBC;\r\n\r\n\r\nuniform vec3 uLight;\r\n\r\n\r\nuniform mat4 uSectionBox;\r\n\r\nin vec4 vColor;\r\n\r\nin vec3 vPosition;\r\n\r\nin vec3 vNormal;\r\n\r\n\r\nin float vDiscard;\r\n\r\n\r\nout vec4 vFragColor;\r\n\r\nvoid main(void) {\r\n \r\n if ( vDiscard > 0.5) discard;\r\n \r\n \r\n vec4 fp = uSectionBox * vec4(vPosition, 1);\r\n if (\r\n fp.x > 1.0 || fp.x < -1.0 || \r\n fp.y > 1.0 || fp.y < -1.0 || \r\n fp.z > 1.0 || fp.z < -1.0) \r\n discard;\r\n\r\n \r\n if (uClippingA)\r\n {\r\n \r\n vec4 p = uClippingPlaneA;\r\n vec3 x = vPosition;\r\n float distance = (dot(p.xyz, x) + p.w) / length(p.xyz);\r\n if (distance < 0.0){\r\n discard;\r\n return;\r\n }\r\n }\r\n\r\n \r\n if (uClippingB)\r\n {\r\n \r\n vec4 p = uClippingPlaneB;\r\n vec3 x = vPosition;\r\n float distance = (dot(p.xyz, x) + p.w) / length(p.xyz);\r\n if (distance < 0.0) {\r\n discard;\r\n return;\r\n }\r\n\r\n }\r\n\r\n \r\n if (length(vNormal) < 0.1) {\r\n vFragColor = vColor;\r\n return;\r\n }\r\n\r\n \r\n vec3 normalInterp = gl_FrontFacing ? vNormal : -vNormal;\r\n\r\n \r\n float Ka = 0.8; \r\n float Kd = 1.0; \r\n float Ks = 0.15; \r\n float shininessVal = 30.0; \r\n\r\n vec3 ambientColor = vColor.rgb * 0.5; \r\n vec3 diffuseColor = vColor.rgb;\r\n vec3 specularColor = vec3(1.0, 1.0, 1.0);\r\n\r\n vec3 N = normalize(normalInterp);\r\n vec3 L = normalize(uLight - vPosition);\r\n\r\n \r\n \r\n float lambertian = max(dot(N, L), 0.0);\r\n\r\n \r\n float specular = 0.0;\r\n\r\n \r\n if (lambertian > 0.0) {\r\n vec3 R = reflect(-L, N); \r\n \r\n vec3 V = L; \r\n\r\n \r\n float specAngle = max(dot(R, V), 0.0);\r\n specular = pow(specAngle, shininessVal);\r\n }\r\n\r\nvec4 fragColor = vec4(\r\n Ka * ambientColor +\r\n Kd * lambertian * diffuseColor +\r\n Ks * specular * specularColor\r\n , vColor.a\r\n );\r\n\r\n \r\n \r\n fragColor.r = (pow(fragColor.r,uGBC[0]) - 0.5)*uGBC[1] + uGBC[2] + 0.5;\r\n fragColor.g = (pow(fragColor.g,uGBC[0]) - 0.5)*uGBC[1] + uGBC[2] + 0.5;\r\n fragColor.b = (pow(fragColor.b,uGBC[0]) - 0.5)*uGBC[1] + uGBC[2] + 0.5;\r\n\r\n vFragColor = fragColor;\r\n}"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.vertex_shader="attribute highp float aVertexIndex;\r\nattribute highp float aTransformationIndex;\r\nattribute highp float aStyleIndex;\r\nattribute highp float aProduct;\r\nattribute highp vec2 aState;\r\nattribute highp vec2 aNormal;\r\n\r\n\r\nuniform mat4 uMVMatrix;\r\nuniform mat4 uPMatrix;\r\n\r\n\r\nuniform vec4 uHighlightColour;\r\n\r\n\r\nuniform vec4 uXRayColour;\r\n\r\n\r\nuniform float uMeter;\r\n\r\n\r\nuniform vec3 uWcs;\r\n\r\n\r\n\r\nuniform int uColorCoding;\r\n\r\n\r\n\r\n\r\n\r\n\r\nuniform int uRenderingMode;\r\n\r\n\r\nuniform highp sampler2D uVertexSampler;\r\nuniform highp float uVertexTextureSize;\r\n\r\n\r\nuniform highp sampler2D uMatrixSampler;\r\nuniform highp float uMatrixTextureSize;\r\n\r\n\r\nuniform highp sampler2D uStyleSampler;\r\nuniform highp float uStyleTextureSize;\r\n\r\n\r\nuniform highp sampler2D uStateStyleSampler;\r\n\r\n\r\nvarying vec4 vColor;\r\n\r\nvarying vec3 vPosition;\r\n\r\nvarying vec3 vNormal;\r\n\r\nvarying mediump float vDiscard;\r\n\r\nconst float PI = 3.1415926535897932384626433832795;\r\n\r\nvec3 getNormal(mat4 transform) {\r\n float U = aNormal[0];\r\n float V = aNormal[1];\r\n float lon = U / 252.0 * 2.0 * PI;\r\n float lat = V / 252.0 * PI;\r\n\r\n float x = sin(lon) * sin(lat);\r\n float z = cos(lon) * sin(lat);\r\n float y = cos(lat);\r\n\r\n vec3 normal = vec3(x, y, z);\r\n if (aTransformationIndex < -0.5) {\r\n return normalize(normal);\r\n }\r\n\r\n \r\n \r\n \r\n \r\n mat3 normTrans = mat3(transform);\r\n\r\n return normalize(vec3(normTrans * normal));\r\n}\r\n\r\nvec4 getIdColor(float id) {\r\n float B = floor(id / (256.0*256.0));\r\n float G = floor((id - B * 256.0*256.0) / 256.0);\r\n float R = mod(id, 256.0);\r\n \r\n \r\n\r\n return vec4(R / 255.0, G / 255.0, B / 255.0, 1.0);\r\n}\r\n\r\nvec2 getTextureCoordinates(float index, float size)\r\n{\r\n float x = floor(mod(index + 0.5, size)); \r\n float y = floor((index + 0.5)/ size); \r\n \r\n return vec2((x + 0.5) / size, (y + 0.5) / size);\r\n}\r\n\r\n\r\nvec4 getColor() { \r\n \r\n float restyle = aState[1];\r\n if (restyle > 224.5) {\r\n vec2 coords = getTextureCoordinates(aStyleIndex, uStyleTextureSize);\r\n vec4 col = texture2D(uStyleSampler, coords);\r\n \r\n \r\n if (uRenderingMode == 1) {\r\n float intensity = (col.r + col.g + col.b) / 3.0;\r\n return vec4(intensity, intensity, intensity, col.a);\r\n }\r\n\r\n \r\n return col;\r\n }\r\n\r\n \r\n \r\n vec2 coords = getTextureCoordinates(restyle, 15.0);\r\n vec4 col2 = texture2D(uStateStyleSampler, coords);\r\n\r\n \r\n if (uRenderingMode == 1) {\r\n float intensity = (col2.r + col2.g + col2.b) / 3.0;\r\n return vec4(intensity, intensity, intensity, col2.a);\r\n }\r\n\r\n return col2;\r\n}\r\n\r\nvec4 getVertexPosition(mat4 transform) {\r\n vec2 coords = getTextureCoordinates(aVertexIndex, uVertexTextureSize);\r\n vec3 point = vec3(texture2D(uVertexSampler, coords));\r\n\r\n if (aTransformationIndex < -0.5) {\r\n return vec4(point, 1.0);\r\n }\r\n\r\n return transform * vec4(point, 1.0);\r\n}\r\n\r\nmat4 getTransform() {\r\n if (aTransformationIndex < -0.5) {\r\n return mat4(1.0);\r\n }\r\n\r\n float tIndex = aTransformationIndex * 4.0;\r\n\r\n \r\n vec2 c1 = getTextureCoordinates(tIndex, uMatrixTextureSize);\r\n vec2 c2 = getTextureCoordinates(tIndex + 1.0, uMatrixTextureSize);\r\n vec2 c3 = getTextureCoordinates(tIndex + 2.0, uMatrixTextureSize);\r\n vec2 c4 = getTextureCoordinates(tIndex + 3.0, uMatrixTextureSize);\r\n\r\n \r\n vec4 v1 = texture2D(uMatrixSampler, c1);\r\n vec4 v2 = texture2D(uMatrixSampler, c2);\r\n vec4 v3 = texture2D(uMatrixSampler, c3);\r\n vec4 v4 = texture2D(uMatrixSampler, c4);\r\n\r\n \r\n return mat4(v1, v2, v3, v4);\r\n}\r\n\r\nvoid main(void) {\r\n int state = int(floor(aState[0] + 0.5));\r\n vDiscard = 0.0;\r\n\r\n if (state == 254 || \r\n (uColorCoding == -1 && state == 251) || \r\n (uColorCoding == -1 && (\r\n (uRenderingMode == 2 && state != 253 && state != 252) || \r\n (uRenderingMode == 3 && (state == 253 || state == 252))) \r\n ))\r\n {\r\n vDiscard = 1.0;\r\n vColor = vec4(0.0, 0.0, 0.0, 0.0);\r\n vNormal = vec3(0.0, 0.0, 0.0);\r\n vPosition = vec3(0.0, 0.0, 0.0);\r\n gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\r\n return;\r\n }\r\n\r\n \r\n mat4 w = mat4(1.0);\r\n w[3] = w[3] + vec4(uWcs, 0.0);\r\n\r\n \r\n mat4 transform = getTransform();\r\n vPosition = vec3(w * getVertexPosition(transform));\r\n vNormal = getNormal(transform);\r\n\r\n \r\n vec4 baseColor = getColor();\r\n\r\n \r\n if (baseColor.a < 0.98)\r\n {\r\n float correction = -0.002;\r\n if (uColorCoding == -2 || uColorCoding >= 0) {\r\n correction = -0.02;\r\n }\r\n vec3 trans = correction * uMeter * normalize(vNormal);\r\n vPosition = vPosition + trans;\r\n }\r\n\r\n \r\n if (uColorCoding == -2) {\r\n float id = floor(aProduct + 0.5);\r\n vColor = getIdColor(id);\r\n vNormal = vec3(0.0, 0.0, 0.0);\r\n }\r\n \r\n else if (uColorCoding >= 0) {\r\n float id = float(uColorCoding);\r\n vColor = getIdColor(id);\r\n vNormal = vec3(0.0, 0.0, 0.0);\r\n }\r\n \r\n else {\r\n \r\n vec4 baseColor = vec4(1.0, 1.0, 1.0, 1.0);\r\n \r\n if (state == 253) {\r\n baseColor = uHighlightColour;\r\n \r\n }\r\n else if (uRenderingMode == 2 || uRenderingMode == 3) {\r\n \r\n if (state == 252) { \r\n baseColor = getColor();\r\n }\r\n \r\n else {\r\n baseColor = vec4(0.0, 0.0, 0.3, 0.5); \r\n }\r\n }\r\n\r\n \r\n vColor = baseColor;\r\n }\r\n\r\n \r\n gl_Position = uPMatrix * uMVMatrix * vec4(vPosition, 1.0);\r\n}"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fragment_shader="precision mediump float;\r\n\r\nuniform vec4 uClippingPlaneA;\r\nuniform vec4 uClippingPlaneB;\r\nuniform bool uClippingA;\r\nuniform bool uClippingB;\r\n\r\n\r\nuniform vec3 uGBC;\r\n\r\n\r\nuniform vec3 uLight;\r\n\r\n\r\nuniform mat4 uSectionBox;\r\n\r\nvarying vec4 vColor;\r\n\r\nvarying vec3 vPosition;\r\n\r\nvarying vec3 vNormal;\r\n\r\n\r\nvarying float vDiscard;\r\n\r\nvoid main(void) {\r\n \r\n if ( vDiscard > 0.5) discard;\r\n \r\n \r\n vec4 fp = uSectionBox * vec4(vPosition, 1);\r\n if (\r\n fp.x > 1.0 || fp.x < -1.0 || \r\n fp.y > 1.0 || fp.y < -1.0 || \r\n fp.z > 1.0 || fp.z < -1.0) \r\n discard;\r\n\r\n \r\n if (uClippingA)\r\n {\r\n \r\n vec4 p = uClippingPlaneA;\r\n vec3 x = vPosition;\r\n float distance = (dot(p.xyz, x) + p.w) / length(p.xyz);\r\n if (distance < 0.0){\r\n discard;\r\n return;\r\n }\r\n }\r\n\r\n \r\n if (uClippingB)\r\n {\r\n \r\n vec4 p = uClippingPlaneB;\r\n vec3 x = vPosition;\r\n float distance = (dot(p.xyz, x) + p.w) / length(p.xyz);\r\n if (distance < 0.0) {\r\n discard;\r\n return;\r\n }\r\n }\r\n \r\n \r\n if (length(vNormal) < 0.1) {\r\n gl_FragColor = vColor;\r\n return;\r\n }\r\n\r\n \r\n vec3 normalInterp = gl_FrontFacing ? vNormal : -vNormal;\r\n\r\n \r\n float Ka = 1.0; \r\n float Kd = 1.0; \r\n float Ks = 0.2; \r\n float shininessVal = 30.0; \r\n\r\n vec3 ambientColor = vColor.rgb * 0.2; \r\n vec3 diffuseColor = vColor.rgb;\r\n vec3 specularColor = vec3(1.0, 1.0, 1.0);\r\n\r\n vec3 N = normalize(normalInterp);\r\n vec3 L = normalize(uLight - vPosition);\r\n\r\n \r\n float lambertian = max(dot(N, L), 0.0);\r\n\r\n float specular = 0.0;\r\n\r\n if(lambertian > 0.0) {\r\n vec3 R = reflect(-L, N); \r\n \r\n vec3 V = L; \r\n\r\n \r\n float specAngle = max(dot(R, V), 0.0);\r\n specular = pow(specAngle, shininessVal);\r\n }\r\n\r\n vec4 fragColor = vec4(\r\n Ka * ambientColor +\r\n Kd * lambertian * diffuseColor +\r\n Ks * specular * specularColor\r\n , vColor.a\r\n );\r\n\r\n \r\n \r\n fragColor.r = (pow(fragColor.r,uGBC[0]) - 0.5)*uGBC[1] + uGBC[2] + 0.5;\r\n fragColor.g = (pow(fragColor.g,uGBC[0]) - 0.5)*uGBC[1] + uGBC[2] + 0.5;\r\n fragColor.b = (pow(fragColor.b,uGBC[0]) - 0.5)*uGBC[1] + uGBC[2] + 0.5;\r\n\r\n gl_FragColor = fragColor;\r\n}"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.worker='!function(t,r){for(var e in r)t[e]=r[e]}(this,function(t){var r={};function e(I){if(r[I])return r[I].exports;var n=r[I]={i:I,l:!1,exports:{}};return t[I].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=t,e.c=r,e.d=function(t,r,I){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:I})},e.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=7)}([function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var I=function(){return function(){}}();r.Message=I,function(t){t[t.PROGRESS=0]="PROGRESS",t[t.COMPLETED=1]="COMPLETED",t[t.FAILED=2]="FAILED"}(r.MessageType||(r.MessageType={}))},function(t,r,e){"use strict";var I;Object.defineProperty(r,"__esModule",{value:!0}),function(t){t[t.UNDEFINED=255]="UNDEFINED",t[t.HIDDEN=254]="HIDDEN",t[t.HIGHLIGHTED=253]="HIGHLIGHTED",t[t.XRAYVISIBLE=252]="XRAYVISIBLE",t[t.PICKING_ONLY=251]="PICKING_ONLY",t[t.UNSTYLED=225]="UNSTYLED"}(I=r.State||(r.State={}));var n=function(){function t(){}return t.getPriority=function(t){switch(t){case I.HIGHLIGHTED:return 1;case I.PICKING_ONLY:return 2;case I.HIDDEN:return 3;case I.XRAYVISIBLE:return 4;default:return 100}},t.getHighestPriority=function(t){var r=this;if(null==t||0===t.length)return null;if(1===t.length)return t[0];var e=t.map(function(t){return{state:t,priority:r.getPriority(t)}});e.sort(function(t,r){return t.priority-r.priority});var n=e[0];return n.priority>50?I.UNDEFINED:n.state},t}();r.StatePriorities=n},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var I=e(0),n=function(){function t(){this._buffer=null,this._view=null,this._position=0,this._progress=function(t){},this._lastProgress=0}return Object.defineProperty(t.prototype,"Position",{get:function(){return this._position},enumerable:!0,configurable:!0}),t.prototype.getSubReader=function(r){var e=new t,I=this._buffer.slice(this._position,this._position+r);return e.load(I,null,null),this._position+=r,e},t.prototype.load=function(t,r,e){this._position=0;var n=this;if(e=e||function(t){},this._progress=e,void 0===t||null==t)throw"Source must be defined";if("string"==typeof t){var E=new XMLHttpRequest;E.open("GET",t,!0),E.onreadystatechange=function(){if(4==E.readyState&&200==E.status){var t=new FileReader;t.onloadend=function(){t.result&&"string"!=typeof t.result&&(n._buffer=t.result,n._view=new DataView(n._buffer),n.onloaded&&n.onloaded(n))},t.onprogress=function(t){e({message:"Downloading geometry",percent:Math.floor(t.loaded/t.total*100),type:I.MessageType.PROGRESS})},t.readAsArrayBuffer(E.response)}if(4==E.readyState&&200!=E.status){var r="Failed to fetch binary data from server. Server code: "+E.status+". This might be due to CORS policy of your browser if you run this as a local file.";throw e({message:"Downloading geometry",percent:0,type:I.MessageType.FAILED}),n.onerror&&n.onerror(r),r}},E.responseType="blob",null!=r&&Object.keys(r).forEach(function(t){var e=r[t];E.setRequestHeader(t,e)}),E.send()}else if(t instanceof Blob||t instanceof File){var a=new FileReader;a.onloadend=function(){a.result&&"string"!=typeof a.result&&(n._buffer=a.result,n._view=new DataView(n._buffer),n.onloaded&&n.onloaded(n))},a.onprogress=function(t){e({message:"Loading binary data",percent:Math.floor(t.loaded/t.total*100),type:I.MessageType.PROGRESS})},a.readAsArrayBuffer(t)}else t instanceof ArrayBuffer&&(this._buffer=t,this._view=new DataView(n._buffer),n.onloaded&&n.onloaded(n))},t.prototype.seek=function(t){if(t<0||t>this._buffer.byteLength)throw"Position out of range.";this._position=t},t.prototype.isEOF=function(){if(null==this._position)throw"Position is not defined";return this._position==this._buffer.byteLength},t.prototype.readArray=function(t,r,e){null==r&&(r=1);var I=t*r,n=this._position;return this._position+=I,this.reportProgress(),1===r?new e(this._buffer.slice(n,n+I))[0]:new e(this._buffer.slice(n,n+I))},t.prototype.move=function(t){var r=this._position;return this._position+=t,this.reportProgress(),r},t.prototype.reportProgress=function(){null!=this._progress&&this._position-this._lastProgress>5e5&&(this._lastProgress=this._position,this._progress({type:I.MessageType.PROGRESS,message:"Processing data",percent:Math.floor(100*this._position/this._buffer.byteLength)}))},t.prototype.readByte=function(){return this.readUint8()},t.prototype.readByteArray=function(t){return this.readUint8Array(t)},t.prototype.readUint8=function(){var t=this.move(1);return this._view.getUint8(t)},t.prototype.readUint8Array=function(t){return this.readArray(1,t,Uint8Array)},t.prototype.readInt16=function(){var t=this.move(2);return this._view.getInt16(t,!0)},t.prototype.readInt16Array=function(t){return this.readArray(2,t,Int16Array)},t.prototype.readUInt16=function(){var t=this.move(2);return this._view.getUint16(t,!0)},t.prototype.readUint16Array=function(t){return this.readArray(2,t,Uint16Array)},t.prototype.readInt32=function(){var t=this.move(4);return this._view.getInt32(t,!0)},t.prototype.readInt32Array=function(t){return this.readArray(4,t,Int32Array)},t.prototype.readUint32=function(){var t=this.move(4);return this._view.getUint32(t,!0)},t.prototype.readUint32Array=function(t){return this.readArray(4,t,Uint32Array)},t.prototype.readFloat32=function(){var t=this.move(4);return this._view.getFloat32(t,!0)},t.prototype.readFloat32Array=function(t){return this.readArray(4,t,Float32Array)},t.prototype.readFloat64=function(){var t=this.move(8);return this._view.getFloat64(t,!0)},t.prototype.readFloat64Array=function(t){return this.readArray(8,t,Float64Array)},t.prototype.readChar=function(t){null==t&&(t=1);var r=this.readByteArray(t),e=new Array(t);for(var I in r)e[I]=String.fromCharCode(r[I]);return 1===t?e[0]:e},t.prototype.readPoint=function(t){null==t&&(t=1);for(var r=this.readFloat32Array(3*t),e=new Array(t),I=0;I<t;I++){var n=3*I*4,E=new Float32Array(r.buffer,n,3);e[I]=E}return 1===t?e[0]:e},t.prototype.readRgba=function(t){null==t&&(t=1);for(var r=this.readByteArray(4*t),e=new Array(t),I=0;I<t;I++){var n=4*I,E=new Uint8Array(r.buffer,n,4);e[I]=E}return 1===t?e[0]:e},t.prototype.readPackedNormal=function(t){null==t&&(t=1);for(var r=this.readUint8Array(2*t),e=new Array(t),I=0;I<t;I++){var n=new Uint8Array(r.buffer,2*I,2);e[I]=n}return 1===t?e[0]:e},t.prototype.readMatrix4x4=function(t){null==t&&(t=1);for(var r=this.readFloat32Array(16*t),e=new Array(t),I=0;I<t;I++){var n=16*I*4,E=new Float32Array(r.buffer,n,16);e[I]=E}return 1===t?e[0]:e},t.prototype.readMatrix4x4_64=function(t){null==t&&(t=1);for(var r=this.readFloat64Array(16*t),e=new Array(t),I=0;I<t;I++){var n=16*I*8,E=new Float64Array(r.buffer,n,16);e[I]=E}return 1===t?e[0]:e},t.prototype.readData=function(t){var r=this.move(t);return this._buffer.slice(r,r+t)},t}();r.BinaryReader=n},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var I=e(1),n=function(){function t(){this.states=[]}return t.clone=function(r){var e=new t;return e.productID=r.productID,e.renderId=r.renderId,e.type=r.type,e.bBox=new Float32Array(r.bBox),e.spans=r.spans,e.states=r.states.slice(0),e},t.addState=function(t,r){null==t.states.find(function(t){return t===r})&&t.states.push(r)},t.removeState=function(t,r){var e=t.states.indexOf(r);e<0||t.states.splice(e,1)},t.getState=function(t){return null==t.states||0===t.states.length?I.State.UNDEFINED:I.StatePriorities.getHighestPriority(t.states)},t}();r.ProductMap=n},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(t){t[t.IFCPRODUCT=20]="IFCPRODUCT",t[t.IFCELEMENT=19]="IFCELEMENT",t[t.IFCBUILDINGELEMENT=26]="IFCBUILDINGELEMENT",t[t.IFCFOOTING=120]="IFCFOOTING",t[t.IFCPILE=572]="IFCPILE",t[t.IFCBEAM=171]="IFCBEAM",t[t.IFCBEAMSTANDARDCASE=1104]="IFCBEAMSTANDARDCASE",t[t.IFCBUILDINGELEMENTPROXY=560]="IFCBUILDINGELEMENTPROXY",t[t.IFCCHIMNEY=1120]="IFCCHIMNEY",t[t.IFCCOLUMN=383]="IFCCOLUMN",t[t.IFCCOLUMNSTANDARDCASE=1126]="IFCCOLUMNSTANDARDCASE",t[t.IFCCOVERING=382]="IFCCOVERING",t[t.IFCCURTAINWALL=456]="IFCCURTAINWALL",t[t.IFCDOOR=213]="IFCDOOR",t[t.IFCDOORSTANDARDCASE=1151]="IFCDOORSTANDARDCASE",t[t.IFCMEMBER=310]="IFCMEMBER",t[t.IFCMEMBERSTANDARDCASE=1214]="IFCMEMBERSTANDARDCASE",t[t.IFCPLATE=351]="IFCPLATE",t[t.IFCPLATESTANDARDCASE=1224]="IFCPLATESTANDARDCASE",t[t.IFCRAILING=350]="IFCRAILING",t[t.IFCRAMP=414]="IFCRAMP",t[t.IFCRAMPFLIGHT=348]="IFCRAMPFLIGHT",t[t.IFCROOF=347]="IFCROOF",t[t.IFCSHADINGDEVICE=1265]="IFCSHADINGDEVICE",t[t.IFCSLAB=99]="IFCSLAB",t[t.IFCSLABELEMENTEDCASE=1268]="IFCSLABELEMENTEDCASE",t[t.IFCSLABSTANDARDCASE=1269]="IFCSLABSTANDARDCASE",t[t.IFCSTAIR=346]="IFCSTAIR",t[t.IFCSTAIRFLIGHT=25]="IFCSTAIRFLIGHT",t[t.IFCWALL=452]="IFCWALL",t[t.IFCWALLELEMENTEDCASE=1314]="IFCWALLELEMENTEDCASE",t[t.IFCWALLSTANDARDCASE=453]="IFCWALLSTANDARDCASE",t[t.IFCWINDOW=667]="IFCWINDOW",t[t.IFCWINDOWSTANDARDCASE=1316]="IFCWINDOWSTANDARDCASE",t[t.IFCELEMENTCOMPONENT=424]="IFCELEMENTCOMPONENT",t[t.IFCREINFORCINGELEMENT=262]="IFCREINFORCINGELEMENT",t[t.IFCREINFORCINGBAR=571]="IFCREINFORCINGBAR",t[t.IFCREINFORCINGMESH=531]="IFCREINFORCINGMESH",t[t.IFCTENDON=261]="IFCTENDON",t[t.IFCTENDONANCHOR=675]="IFCTENDONANCHOR",t[t.IFCBUILDINGELEMENTPART=220]="IFCBUILDINGELEMENTPART",t[t.IFCDISCRETEACCESSORY=423]="IFCDISCRETEACCESSORY",t[t.IFCFASTENER=535]="IFCFASTENER",t[t.IFCMECHANICALFASTENER=536]="IFCMECHANICALFASTENER",t[t.IFCVIBRATIONISOLATOR=1312]="IFCVIBRATIONISOLATOR",t[t.IFCFEATUREELEMENT=386]="IFCFEATUREELEMENT",t[t.IFCSURFACEFEATURE=1287]="IFCSURFACEFEATURE",t[t.IFCFEATUREELEMENTSUBTRACTION=499]="IFCFEATUREELEMENTSUBTRACTION",t[t.IFCVOIDINGFEATURE=1313]="IFCVOIDINGFEATURE",t[t.IFCOPENINGELEMENT=498]="IFCOPENINGELEMENT",t[t.IFCOPENINGSTANDARDCASE=1217]="IFCOPENINGSTANDARDCASE",t[t.IFCFEATUREELEMENTADDITION=385]="IFCFEATUREELEMENTADDITION",t[t.IFCPROJECTIONELEMENT=384]="IFCPROJECTIONELEMENT",t[t.IFCFURNISHINGELEMENT=253]="IFCFURNISHINGELEMENT",t[t.IFCFURNITURE=1184]="IFCFURNITURE",t[t.IFCSYSTEMFURNITUREELEMENT=1291]="IFCSYSTEMFURNITUREELEMENT",t[t.IFCDISTRIBUTIONELEMENT=44]="IFCDISTRIBUTIONELEMENT",t[t.IFCDISTRIBUTIONFLOWELEMENT=45]="IFCDISTRIBUTIONFLOWELEMENT",t[t.IFCDISTRIBUTIONCHAMBERELEMENT=180]="IFCDISTRIBUTIONCHAMBERELEMENT",t[t.IFCENERGYCONVERSIONDEVICE=175]="IFCENERGYCONVERSIONDEVICE",t[t.IFCAIRTOAIRHEATRECOVERY=1097]="IFCAIRTOAIRHEATRECOVERY",t[t.IFCBOILER=1105]="IFCBOILER",t[t.IFCBURNER=1109]="IFCBURNER",t[t.IFCCHILLER=1119]="IFCCHILLER",t[t.IFCCOIL=1124]="IFCCOIL",t[t.IFCCONDENSER=1132]="IFCCONDENSER",t[t.IFCCOOLEDBEAM=1141]="IFCCOOLEDBEAM",t[t.IFCCOOLINGTOWER=1142]="IFCCOOLINGTOWER",t[t.IFCENGINE=1164]="IFCENGINE",t[t.IFCEVAPORATIVECOOLER=1166]="IFCEVAPORATIVECOOLER",t[t.IFCEVAPORATOR=1167]="IFCEVAPORATOR",t[t.IFCHEATEXCHANGER=1187]="IFCHEATEXCHANGER",t[t.IFCHUMIDIFIER=1188]="IFCHUMIDIFIER",t[t.IFCTUBEBUNDLE=1305]="IFCTUBEBUNDLE",t[t.IFCUNITARYEQUIPMENT=1310]="IFCUNITARYEQUIPMENT",t[t.IFCELECTRICGENERATOR=1160]="IFCELECTRICGENERATOR",t[t.IFCELECTRICMOTOR=1161]="IFCELECTRICMOTOR",t[t.IFCMOTORCONNECTION=1216]="IFCMOTORCONNECTION",t[t.IFCSOLARDEVICE=1270]="IFCSOLARDEVICE",t[t.IFCTRANSFORMER=1303]="IFCTRANSFORMER",t[t.IFCFLOWCONTROLLER=121]="IFCFLOWCONTROLLER",t[t.IFCAIRTERMINALBOX=1096]="IFCAIRTERMINALBOX",t[t.IFCDAMPER=1148]="IFCDAMPER",t[t.IFCFLOWMETER=1182]="IFCFLOWMETER",t[t.IFCVALVE=1311]="IFCVALVE",t[t.IFCELECTRICDISTRIBUTIONBOARD=1157]="IFCELECTRICDISTRIBUTIONBOARD",t[t.IFCELECTRICTIMECONTROL=1162]="IFCELECTRICTIMECONTROL",t[t.IFCPROTECTIVEDEVICE=1235]="IFCPROTECTIVEDEVICE",t[t.IFCSWITCHINGDEVICE=1290]="IFCSWITCHINGDEVICE",t[t.IFCFLOWFITTING=467]="IFCFLOWFITTING",t[t.IFCDUCTFITTING=1153]="IFCDUCTFITTING",t[t.IFCPIPEFITTING=1222]="IFCPIPEFITTING",t[t.IFCCABLECARRIERFITTING=1111]="IFCCABLECARRIERFITTING",t[t.IFCCABLEFITTING=1113]="IFCCABLEFITTING",t[t.IFCJUNCTIONBOX=1195]="IFCJUNCTIONBOX",t[t.IFCFLOWMOVINGDEVICE=502]="IFCFLOWMOVINGDEVICE",t[t.IFCCOMPRESSOR=1131]="IFCCOMPRESSOR",t[t.IFCFAN=1177]="IFCFAN",t[t.IFCPUMP=1238]="IFCPUMP",t[t.IFCFLOWSEGMENT=574]="IFCFLOWSEGMENT",t[t.IFCDUCTSEGMENT=1154]="IFCDUCTSEGMENT",t[t.IFCPIPESEGMENT=1223]="IFCPIPESEGMENT",t[t.IFCCABLECARRIERSEGMENT=1112]="IFCCABLECARRIERSEGMENT",t[t.IFCCABLESEGMENT=1115]="IFCCABLESEGMENT",t[t.IFCFLOWSTORAGEDEVICE=371]="IFCFLOWSTORAGEDEVICE",t[t.IFCTANK=1293]="IFCTANK",t[t.IFCELECTRICFLOWSTORAGEDEVICE=1159]="IFCELECTRICFLOWSTORAGEDEVICE",t[t.IFCFLOWTERMINAL=46]="IFCFLOWTERMINAL",t[t.IFCFIRESUPPRESSIONTERMINAL=1179]="IFCFIRESUPPRESSIONTERMINAL",t[t.IFCSANITARYTERMINAL=1262]="IFCSANITARYTERMINAL",t[t.IFCSTACKTERMINAL=1277]="IFCSTACKTERMINAL",t[t.IFCWASTETERMINAL=1315]="IFCWASTETERMINAL",t[t.IFCAIRTERMINAL=1095]="IFCAIRTERMINAL",t[t.IFCMEDICALDEVICE=1212]="IFCMEDICALDEVICE",t[t.IFCSPACEHEATER=1272]="IFCSPACEHEATER",t[t.IFCAUDIOVISUALAPPLIANCE=1099]="IFCAUDIOVISUALAPPLIANCE",t[t.IFCCOMMUNICATIONSAPPLIANCE=1127]="IFCCOMMUNICATIONSAPPLIANCE",t[t.IFCELECTRICAPPLIANCE=1156]="IFCELECTRICAPPLIANCE",t[t.IFCLAMP=1198]="IFCLAMP",t[t.IFCLIGHTFIXTURE=1199]="IFCLIGHTFIXTURE",t[t.IFCOUTLET=1219]="IFCOUTLET",t[t.IFCFLOWTREATMENTDEVICE=425]="IFCFLOWTREATMENTDEVICE",t[t.IFCINTERCEPTOR=1193]="IFCINTERCEPTOR",t[t.IFCDUCTSILENCER=1155]="IFCDUCTSILENCER",t[t.IFCFILTER=1178]="IFCFILTER",t[t.IFCDISTRIBUTIONCONTROLELEMENT=468]="IFCDISTRIBUTIONCONTROLELEMENT",t[t.IFCPROTECTIVEDEVICETRIPPINGUNIT=1236]="IFCPROTECTIVEDEVICETRIPPINGUNIT",t[t.IFCACTUATOR=1091]="IFCACTUATOR",t[t.IFCALARM=1098]="IFCALARM",t[t.IFCCONTROLLER=1139]="IFCCONTROLLER",t[t.IFCFLOWINSTRUMENT=1181]="IFCFLOWINSTRUMENT",t[t.IFCSENSOR=1264]="IFCSENSOR",t[t.IFCUNITARYCONTROLELEMENT=1308]="IFCUNITARYCONTROLELEMENT",t[t.IFCCIVILELEMENT=1122]="IFCCIVILELEMENT",t[t.IFCELEMENTASSEMBLY=18]="IFCELEMENTASSEMBLY",t[t.IFCGEOGRAPHICELEMENT=1185]="IFCGEOGRAPHICELEMENT",t[t.IFCTRANSPORTELEMENT=416]="IFCTRANSPORTELEMENT",t[t.IFCVIRTUALELEMENT=168]="IFCVIRTUALELEMENT",t[t.IFCSTRUCTURALACTIVITY=41]="IFCSTRUCTURALACTIVITY",t[t.IFCSTRUCTURALACTION=40]="IFCSTRUCTURALACTION",t[t.IFCSTRUCTURALCURVEACTION=1279]="IFCSTRUCTURALCURVEACTION",t[t.IFCSTRUCTURALLINEARACTION=463]="IFCSTRUCTURALLINEARACTION",t[t.IFCSTRUCTURALSURFACEACTION=1284]="IFCSTRUCTURALSURFACEACTION",t[t.IFCSTRUCTURALPLANARACTION=39]="IFCSTRUCTURALPLANARACTION",t[t.IFCSTRUCTURALPOINTACTION=356]="IFCSTRUCTURALPOINTACTION",t[t.IFCSTRUCTURALREACTION=355]="IFCSTRUCTURALREACTION",t[t.IFCSTRUCTURALCURVEREACTION=1280]="IFCSTRUCTURALCURVEREACTION",t[t.IFCSTRUCTURALPOINTREACTION=354]="IFCSTRUCTURALPOINTREACTION",t[t.IFCSTRUCTURALSURFACEREACTION=1285]="IFCSTRUCTURALSURFACEREACTION",t[t.IFCSTRUCTURALITEM=226]="IFCSTRUCTURALITEM",t[t.IFCSTRUCTURALCONNECTION=265]="IFCSTRUCTURALCONNECTION",t[t.IFCSTRUCTURALCURVECONNECTION=534]="IFCSTRUCTURALCURVECONNECTION",t[t.IFCSTRUCTURALPOINTCONNECTION=533]="IFCSTRUCTURALPOINTCONNECTION",t[t.IFCSTRUCTURALSURFACECONNECTION=264]="IFCSTRUCTURALSURFACECONNECTION",t[t.IFCSTRUCTURALMEMBER=225]="IFCSTRUCTURALMEMBER",t[t.IFCSTRUCTURALCURVEMEMBER=224]="IFCSTRUCTURALCURVEMEMBER",t[t.IFCSTRUCTURALCURVEMEMBERVARYING=227]="IFCSTRUCTURALCURVEMEMBERVARYING",t[t.IFCSTRUCTURALSURFACEMEMBER=420]="IFCSTRUCTURALSURFACEMEMBER",t[t.IFCSTRUCTURALSURFACEMEMBERVARYING=421]="IFCSTRUCTURALSURFACEMEMBERVARYING",t[t.IFCPORT=179]="IFCPORT",t[t.IFCDISTRIBUTIONPORT=178]="IFCDISTRIBUTIONPORT",t[t.IFCANNOTATION=634]="IFCANNOTATION",t[t.IFCSPATIALELEMENT=1273]="IFCSPATIALELEMENT",t[t.IFCSPATIALSTRUCTUREELEMENT=170]="IFCSPATIALSTRUCTUREELEMENT",t[t.IFCBUILDING=169]="IFCBUILDING",t[t.IFCBUILDINGSTOREY=459]="IFCBUILDINGSTOREY",t[t.IFCSITE=349]="IFCSITE",t[t.IFCSPACE=454]="IFCSPACE",t[t.IFCEXTERNALSPATIALSTRUCTUREELEMENT=1175]="IFCEXTERNALSPATIALSTRUCTUREELEMENT",t[t.IFCEXTERNALSPATIALELEMENT=1174]="IFCEXTERNALSPATIALELEMENT",t[t.IFCSPATIALZONE=1275]="IFCSPATIALZONE",t[t.IFCGRID=564]="IFCGRID",t[t.IFCPROXY=447]="IFCPROXY"}(r.ProductType||(r.ProductType={}))},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var I=e(2),n=function(){function t(){var t=this;this.load=function(r){var e=new I.BinaryReader,n=t;e.onloaded=function(){n.parse(e),n.onloaded&&n.onloaded(t)},e.load(r,null,null)}}return t.prototype.parse=function(t){t.readByte();var r=t.readInt32(),e=t.readInt32();this.vertices=t.readFloat32Array(3*r),this.indices=new Uint32Array(3*e),this.normals=new Uint8Array(6*e);var I,n=0;I=r<=255?function(r){return t.readByteArray(r)}:r<=65535?function(r){return t.readUint16Array(r)}:function(r){return t.readInt32Array(r)};var E=t.readInt32();if(0!==r&&0!==e)for(var a=0;a<E;a++){var C=t.readInt32();if(0!=C){var o=C>0;if(C=Math.abs(C),o){var i=t.readByteArray(2),s=I(3*C);this.indices.set(s,n);for(var T=0;T<3*C;T++)this.normals[2*n]=i[0],this.normals[2*n+1]=i[1],n++}else for(T=0;T<C;T++)this.indices[n]=I(),this.normals.set(t.readByteArray(2),2*n),n++,this.indices[n]=I(),this.normals.set(t.readByteArray(2),2*n),n++,this.indices[n]=I(),this.normals.set(t.readByteArray(2),2*n),n++}}},t}();r.TriangulatedShape=n},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var I=e(2),n=e(5),E=e(1),a=e(4),C=e(0),o=e(3),i=function(){function t(){this.normals=new Uint8Array(0),this.indices=new Float32Array(0),this.products=new Float32Array(0),this.transformations=new Float32Array(0),this.styleIndices=new Uint16Array(0),this.states=new Uint8Array(0),this.vertices=new Float32Array(0),this.matrices=new Float32Array(0),this.styles=new Uint8Array(0),this.meter=1e3,this.wcs=[0,0,0],this._iVertex=0,this._iIndexForward=0,this._iIndexBackward=0,this._iTransform=0,this._iMatrix=0,this._maxVersionSupported=4,this.productMaps={},this.productIdLookup=[],this._styleMap=new T}return t.prototype.parse=function(t){if(t&&!t.isEOF()){this._reader=t;var r=t;if(94132117!==r.readInt32())throw new Error("Magic number mismatch. This is not a wexBIM file.");var e=r.readByte();if(e>this._maxVersionSupported)throw new Error("Viewer doesn\'t support version "+e+" of the wexBIM stream");var I=r.readInt32(),i=r.readInt32(),T=r.readInt32(),F=r.readInt32(),A=r.readInt32(),R=r.readInt32();this.meter=r.readFloat32(),e>3&&(this.wcs=[r.readFloat64(),r.readFloat64(),r.readFloat64()]);var N=r.readInt16();this.vertices=new Float32Array(this.square(4,3*i)),this.normals=new Uint8Array(6*T),this.indices=new Float32Array(3*T),this.styleIndices=new Uint16Array(3*T),this.styles=new Uint8Array(this.square(1,4*(R+2))),this.products=new Float32Array(3*T),this.states=new Uint8Array(3*T*2),this.transformations=new Float32Array(3*T),this.matrices=new Float32Array(this.square(4,16*F)),this.productMaps={},this.regions=new Array(N),this._iVertex=0,this._iIndexForward=0,this._iIndexBackward=3*T,this._iTransform=0,this._iMatrix=0;for(var u=0;u<N;u++){(U=new s).population=r.readInt32(),U.centre=r.readFloat32Array(3),U.bbox=r.readFloat32Array(6),this.regions[u]=U}for(var L=0;L<R;L++){var O=r.readInt32(),d=255*r.readFloat32(),p=255*r.readFloat32(),l=255*r.readFloat32(),S=255*r.readFloat32();this.styles.set([d,p,l,S],4*L),this._styleMap.Add({id:O,index:L,transparent:S<254})}this.styles.set([255,255,255,255],4*L),this._styleMap.Add({id:-1,index:L,transparent:!1}),L++,this.styles.set([0,255,255,100],4*L),this._styleMap.Add({id:-2,index:L,transparent:!0});for(u=0;u<A;u++){var f=r.readInt32(),c=r.readInt16(),h=r.readFloat32Array(6),y=new o.ProductMap;y.productID=f,y.renderId=u+1,y.type=c,y.bBox=h,y.spans=[],this.productMaps[f]=y,this.productIdLookup[u+1]=f,c!==a.ProductType.IFCSPACE&&c!==a.ProductType.IFCOPENINGELEMENT||y.states.push(E.State.HIDDEN)}if(e>=3)for(var M=0;M<N;M++)for(var U=this.regions[M],D=r.readInt32(),P=0;P<D;P++){var v=this.readShape(e),b=r.readInt32();if(0!==b){var w=r.getSubReader(b);if((B=new n.TriangulatedShape).parse(w),!w.isEOF())throw new Error("Incomplete reading of geometry for shape instance "+v[0].iLabel);this.feedDataArrays(v,B)}}else for(var G=0;G<I;G++){var B;v=this.readShape(e);(B=new n.TriangulatedShape).parse(r),this.feedDataArrays(v,B)}if(!r.isEOF())throw this.progress({type:C.MessageType.FAILED,message:"Processing data",percent:0}),new Error("Binary reader is not at the end of the file.");this.progress({type:C.MessageType.PROGRESS,message:"Processing data",percent:100}),this.transparentIndex=this._iIndexForward}},t.prototype.square=function(t,r){if(null==t||null==r)throw new Error(\'Wrong arguments for "square" function.\');if(0===r)return 0;for(var e=r*t,I=Math.ceil(Math.sqrt(e/4));4*I%t!=0;)I++;return I*I*4/t},t.prototype.feedDataArrays=function(t,r){var e=this;t.forEach(function(t){var I=0,n=I=t.transparent?e._iIndexBackward-r.indices.length:e._iIndexForward,C=e.productMaps[t.pLabel];void 0===C&&((C=new o.ProductMap).productID=0,C.renderId=0,C.type=a.ProductType.IFCOPENINGELEMENT,C.bBox=new Float32Array(6),C.spans=[],C.states.push(E.State.HIDDEN),e.productMaps[t.pLabel]=C),e.normals.set(r.normals,2*I);var i=C.type===a.ProductType.IFCSPACE||C.type===a.ProductType.IFCOPENINGELEMENT?E.State.HIDDEN:255;r.indices.forEach(function(r){e.indices[I]=r+e._iVertex/3,e.products[I]=C.renderId,e.styleIndices[I]=t.style,e.transformations[I]=t.transform,e.states[2*I]=i,e.states[2*I+1]=255,I++});var s=I;C.spans.push(new Int32Array([n,s])),t.transparent?e._iIndexBackward-=r.indices.length:e._iIndexForward+=r.indices.length},this),this.vertices.set(r.vertices,this._iVertex),this._iVertex+=r.vertices.length},t.prototype.readShape=function(t){for(var r=this._reader,e=r.readInt32(),I=new Array,n=0;n<e;n++){var E=r.readInt32(),C=(r.readInt16(),r.readInt32()),o=r.readInt32(),i=null;e>1&&(i=1===t?r.readFloat32Array(16):r.readFloat64Array(16),this.matrices.set(i,this._iMatrix),this._iMatrix+=16);var s=this._styleMap.GetStyle(o);null===s&&(s=this._styleMap.GetStyle(-1));var T=this.productMaps[E].type;T!==a.ProductType.IFCSPACE&&T!==a.ProductType.IFCOPENINGELEMENT||(s=this._styleMap.GetStyle(-2)),I.push({pLabel:E,iLabel:C,style:s.index,transparent:s.transparent,transform:null!=i?this._iTransform++:-1})}return I},t.prototype.load=function(t,r,e){var n=this;this.progress=e||function(t){};var E=new I.BinaryReader,a=this;E.onloaded=function(){a.parse(E),a.onloaded&&a.onloaded(n)},E.onerror=function(t){a.onerror&&a.onerror(t)},E.load(t,r,e)},t}();r.ModelGeometry=i;var s=function(){function t(t){this.population=-1,this.centre=null,this.bbox=null,t&&(this.population=t.population,t.centre&&(this.centre=new Float32Array(t.centre)),t.bbox&&(this.bbox=new Float32Array(t.bbox)))}return t.clone=function(r){var e=new t;return e.population=r.population,r.centre&&(e.centre=new Float32Array(r.centre)),r.bbox&&(e.bbox=new Float32Array(r.bbox)),e},t.prototype.merge=function(r){if(-1===this.population&&null===this.centre&&null===this.bbox)return new t(r);var e=new t;if(e.population=this.population+r.population,this.bbox&&r.bbox){var I=Math.min(this.bbox[0],r.bbox[0]),n=Math.min(this.bbox[1],r.bbox[1]),E=Math.min(this.bbox[2],r.bbox[2]),a=Math.max(this.bbox[0]+this.bbox[3],r.bbox[0]+r.bbox[3]),C=Math.max(this.bbox[1]+this.bbox[4],r.bbox[1]+r.bbox[4]),o=Math.max(this.bbox[2]+this.bbox[5],r.bbox[2]+r.bbox[5]),i=a-I,s=C-n,T=o-E,F=(I+a)/2,A=(n+C)/2,R=(E+o)/2;e.bbox=new Float32Array([I,n,E,i,s,T]),e.centre=new Float32Array([F,A,R])}else this.bbox?(e.bbox=new Float32Array(this.bbox),e.centre=new Float32Array(this.centre)):(e.bbox=new Float32Array(r.bbox),e.centre=new Float32Array(r.centre));return e},t}();r.Region=s;var T=function(){function t(){this._internal={}}return t.prototype.Add=function(t){this._internal[t.id]=t},t.prototype.GetStyle=function(t){var r=this._internal[t];return r||null},t}()},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var I=e(0),n=e(6);if(self&&self instanceof DedicatedWorkerGlobalScope){var E=self;E.onmessage=function(t){var r=t.data.model,e=t.data.headers,a=new n.ModelGeometry;a.onerror=function(t){var r={type:I.MessageType.FAILED,message:t,percent:0};E.postMessage(r),console.error(t),E.close()},a.onloaded=function(){try{var t={},r=[];for(var e in a)if(a.hasOwnProperty(e)){var n=a[e];"function"==typeof n||e.startsWith("_")||(t[e]=n,ArrayBuffer.isView(n)&&r.push(n.buffer))}var C={type:I.MessageType.COMPLETED,message:"Completed",percent:100,result:t};E.postMessage(C,r),E.close()}catch(t){C={type:I.MessageType.FAILED,message:t,percent:0};E.postMessage(C),console.error(t),E.close()}},a.load(r,e,function(t){E.postMessage(t)})}}}]));'},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ModelPointers=function(t,e){this.NormalAttrPointer=t.getAttribLocation(e,"aNormal"),this.IndexlAttrPointer=t.getAttribLocation(e,"aVertexIndex"),this.ProductAttrPointer=t.getAttribLocation(e,"aProduct"),this.StateAttrPointer=t.getAttribLocation(e,"aState"),this.StyleAttrPointer=t.getAttribLocation(e,"aStyleIndex"),this.TransformationAttrPointer=t.getAttribLocation(e,"aTransformationIndex"),this.VertexSamplerUniform=t.getUniformLocation(e,"uVertexSampler"),this.MatrixSamplerUniform=t.getUniformLocation(e,"uMatrixSampler"),this.StyleSamplerUniform=t.getUniformLocation(e,"uStyleSampler"),this.VertexTextureSizeUniform=t.getUniformLocation(e,"uVertexTextureSize"),this.MatrixTextureSizeUniform=t.getUniformLocation(e,"uMatrixTextureSize"),this.StyleTextureSizeUniform=t.getUniformLocation(e,"uStyleTextureSize"),this.ClippingPlaneAUniform=t.getUniformLocation(e,"uClippingPlaneA"),this.ClippingAUniform=t.getUniformLocation(e,"uClippingA"),this.ClippingPlaneBUniform=t.getUniformLocation(e,"uClippingPlaneB"),this.ClippingBUniform=t.getUniformLocation(e,"uClippingB"),this.MeterUniform=t.getUniformLocation(e,"uMeter"),this.WcsUniform=t.getUniformLocation(e,"uWcs"),t.enableVertexAttribArray(this.NormalAttrPointer),t.enableVertexAttribArray(this.IndexlAttrPointer),t.enableVertexAttribArray(this.ProductAttrPointer),t.enableVertexAttribArray(this.StateAttrPointer),t.enableVertexAttribArray(this.StyleAttrPointer),t.enableVertexAttribArray(this.TransformationAttrPointer)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.depth_vertex_shader="attribute highp vec2 point;\r\n\r\nvarying vec2 position;\r\n\r\nvoid main(void) {\r\n float x = (point.x * 2.0) - 1.0;\r\n float y = (point.y * 2.0) - 1.0;\r\n gl_Position = vec4(x, y, 0.0, 1.0);\r\n position = point;\r\n}"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.depth_fragment_shader=" precision mediump float;\r\n \r\n varying vec2 position;\r\n \r\n uniform sampler2D texture;\r\n \r\n void main() {\r\n \r\n float depth = texture2D(texture, position).x; \r\n\r\n \r\n gl_FragColor = vec4(depth, depth, depth, 1.0);\r\n }"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(51),i=r(50),a=r(1),o=function(){function t(t){this.gl=t,this.vertices=new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]);var e=function(e,r){if(t.shaderSource(e,r),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS)){var n=t.getShaderInfoLog(e);return console.error(n),!1}return!0};if(this.fragmentShader=t.createShader(t.FRAGMENT_SHADER),!e(this.fragmentShader,n.depth_fragment_shader))throw new Error("Failed to compile depth reading fragment shader");if(this.vertexShader=t.createShader(t.VERTEX_SHADER),!e(this.vertexShader,i.depth_vertex_shader))throw new Error("Failed to compile depth reading vertex shader");this.program=t.createProgram(),t.attachShader(this.program,this.vertexShader),t.attachShader(this.program,this.fragmentShader),t.linkProgram(this.program),t.getProgramParameter(this.program,t.LINK_STATUS)?(t.useProgram(this.program),this.texUniform=t.getUniformLocation(this.program,"texture"),this.vertAttrs=t.getAttribLocation(this.program,"point"),this.vertBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.STATIC_DRAW)):console.error("Could not initialise shaders ")}return t.prototype.draw=function(t){var e=this.gl;e.useProgram(this.program),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(this.texUniform,0),e.bindBuffer(e.ARRAY_BUFFER,this.vertBuffer),e.enableVertexAttribArray(this.vertAttrs),e.vertexAttribPointer(this.vertAttrs,2,e.FLOAT,!1,0,0),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.drawArrays(e.TRIANGLES,0,6)},t.prototype.getDepths=function(t,e,r,n){var i=this.gl;i.useProgram(this.program);var o=new a.Framebuffer(i,r,n,!1);i.viewport(0,0,r,n),this.draw(e);var s=t.map((function(t){return o.getPixel(t.x,t.y)[0]}));return o.delete(),s},t.prototype.getDepth=function(t,e,r,n,i){return this.getDepths([{x:t,y:e}],r,n,i)[0]},t.prototype.delete=function(){var t=this.gl;t.deleteBuffer(this.vertBuffer),t.deleteShader(this.fragmentShader),t.deleteShader(this.vertexShader),t.deleteProgram(this.program)},t}();e.DepthReader=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=r(15),a=r(4),o=r(17),s=r(2),u=r(0),c=r(13),l=r(12),f=function(){function t(e,r,n){if(this._gl=e,this._model=r,this.tag=null,this.wcs=u.vec3.create(),this._stopped=!1,this.pickable=!0,this.clippable=!0,this._changed=!1,this._empty=!1,this._drawProductIds=null,this._clippingPlaneA=null,this._clippingPlaneB=null,this._clippingA=!1,this._clippingB=!1,this._glVersion=1,void 0===e||void 0===r)throw new Error("WebGL context and geometry model must be specified");if("undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext&&(this._glVersion=2),n=n||function(t){},this.id=t._instancesNum++,this.meter=r.meter,this.wcs=this.getVec3(r.wcs),0===r.indices.length)return this._empty=!0,void(this._changed=!1);this.InitGlBuffersAndTextures(e),this.InitRegions(r.regions),this.InitGPU(e,r,n),this._changed=!0}return Object.defineProperty(t.prototype,"stopped",{get:function(){return this._stopped},set:function(t){this._stopped=t,this._changed=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isolatedProducts",{get:function(){return this._drawProductIds},set:function(t){this._drawProductIds=t,this._changed=!0},enumerable:!0,configurable:!0}),t.prototype.getRegion=function(t){var e=this,r=null;if(null!=this.isolatedProducts){var n=[];if(this.isolatedProducts.forEach((function(r){var i=e.getProductMap(r,t);i&&n.push(i)})),0===n.length)return null;var a=n.reduce((function(t,e){return null==t?e.bBox:l.BBox.union(t,e.bBox)}),null);return(r=new i.Region).population=n.length,r.bbox=new Float32Array(a),r.centre=new Float32Array([a[0]+a[3]/2,a[1]+a[4]/2,a[2]+a[5]/2]),r}r=i.Region.clone(this._region);var o=u.vec3.subtract(u.vec3.create(),this.wcs,t);r.centre=u.vec3.add(u.vec3.create(),o,this.getVec3(r.centre));var s=u.vec3.add(u.vec3.create(),o,this.getVec3(r.bbox.subarray(0,3)));return r.bbox.set(new Float32Array(s),0),r},Object.defineProperty(t.prototype,"changed",{get:function(){return this._changed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._empty},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gl1",{get:function(){return 1===this._glVersion?this._gl:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gl2",{get:function(){return 2===this._glVersion?this._gl:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clippingPlaneA",{get:function(){return this._clippingPlaneA},set:function(t){this._clippingPlaneA=t,this._clippingA=null!=t,this._changed=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clippingPlaneB",{get:function(){return this._clippingPlaneB},set:function(t){this._clippingPlaneB=t,this._clippingB=null!=t,this._changed=!0},enumerable:!0,configurable:!0}),t.prototype.InitRegions=function(t){var e=this;this.empty||(this._region=t[0],t.forEach((function(t){t.population>e._region.population&&(e._region=t)})),null==this._region&&(this._region=new i.Region,this._region.population=0,this._region.centre=new Float32Array([0,0,0]),this._region.bbox=new Float32Array([0,0,0,0,0,0])))},t.prototype.InitGlBuffersAndTextures=function(t){this.empty||(this._vertexTexture=t.createTexture(),this._matrixTexture=t.createTexture(),this._styleTexture=t.createTexture(),this._vertexTextureSize=0,this._matrixTextureSize=0,this._styleTextureSize=0,this._normalBuffer=t.createBuffer(),this._indexBuffer=t.createBuffer(),this._productBuffer=t.createBuffer(),this._styleBuffer=t.createBuffer(),this._stateBuffer=t.createBuffer(),this._transformationBuffer=t.createBuffer())},t.prototype.setActive=function(t,e){if(!this.stopped&&!this.empty){var r=1===this._glVersion?this.gl1:this.gl2;this._vertexTextureSize>0&&(r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,this._vertexTexture),r.uniform1i(t.VertexSamplerUniform,1)),this._matrixTextureSize>0&&(r.activeTexture(r.TEXTURE2),r.bindTexture(r.TEXTURE_2D,this._matrixTexture),r.uniform1i(t.MatrixSamplerUniform,2)),this._styleTextureSize>0&&(r.activeTexture(r.TEXTURE3),r.bindTexture(r.TEXTURE_2D,this._styleTexture),r.uniform1i(t.StyleSamplerUniform,3)),r.bindBuffer(r.ARRAY_BUFFER,this._normalBuffer),r.vertexAttribPointer(t.NormalAttrPointer,2,r.UNSIGNED_BYTE,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this._indexBuffer),r.vertexAttribPointer(t.IndexlAttrPointer,1,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this._productBuffer),r.vertexAttribPointer(t.ProductAttrPointer,1,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this._stateBuffer),r.vertexAttribPointer(t.StateAttrPointer,2,r.UNSIGNED_BYTE,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this._styleBuffer),r.vertexAttribPointer(t.StyleAttrPointer,1,r.UNSIGNED_SHORT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this._transformationBuffer),r.vertexAttribPointer(t.TransformationAttrPointer,1,r.FLOAT,!1,0,0),r.uniform1f(t.VertexTextureSizeUniform,this._vertexTextureSize),r.uniform1f(t.MatrixTextureSizeUniform,this._matrixTextureSize),r.uniform1f(t.StyleTextureSizeUniform,this._styleTextureSize),r.uniform1f(t.MeterUniform,this.meter);var n=u.vec3.subtract(u.vec3.create(),this.wcs,e);if(r.uniform3fv(t.WcsUniform,n),r.uniform1i(t.ClippingAUniform,this._clippingA?1:0),r.uniform1i(t.ClippingBUniform,this._clippingB?1:0),this._clippingA){var i=this.transformPlane(this._clippingPlaneA,e);r.uniform4fv(t.ClippingPlaneAUniform,i)}this._clippingB&&(i=this.transformPlane(this._clippingPlaneB,e),r.uniform4fv(t.ClippingPlaneBUniform,i))}},t.prototype.transformPlane=function(t,e){var r=u.vec3.len(t),n=t[0],i=t[1],a=t[2],o=t[3],s=n*-o/r,c=i*-o/r,l=a*-o/r;return o=0-n*(s-=e[0])-i*(c-=e[1])-a*(l-=e[2]),new Float32Array([n,i,a,o])},t.prototype.draw=function(t){var e=this;if(this._changed=!1,!this.stopped&&!this.empty){var r=this._gl,i=this.isolatedProducts&&this.isolatedProducts.length>0?this.isolatedProducts.reduce((function(t,r){var n=e.getProductMap(r);return n&&t.push(n),t}),new Array):null;if(null==i||0!==i.length)if(null!=t){if(!(t===n.SOLID&&this._model.transparentIndex>0))return t===n.TRANSPARENT&&this._model.transparentIndex<this._numberOfIndices?(r.depthMask(!1),null==i?r.drawArrays(r.TRIANGLES,this._model.transparentIndex,this._numberOfIndices-this._model.transparentIndex):i.forEach((function(t){t.spans.filter((function(t){return t[0]>=e._model.transparentIndex})).forEach((function(t){r.drawArrays(r.TRIANGLES,t[0],t[1]-t[0])}))})),void r.depthMask(!0)):void 0;null==i?r.drawArrays(r.TRIANGLES,0,this._model.transparentIndex):i.forEach((function(t){t.spans.filter((function(t){return t[1]<=e._model.transparentIndex})).forEach((function(t){r.drawArrays(r.TRIANGLES,t[0],t[1]-t[0])}))}))}else null==i?r.drawArrays(r.TRIANGLES,0,this._numberOfIndices):i.forEach((function(t){t.spans.forEach((function(t){r.drawArrays(r.TRIANGLES,t[0],t[1]-t[0])}))}))}},t.prototype.getProductId=function(t){return this.empty?null:this._model.productIdLookup[t]},t.prototype.getProductMap=function(t,e){if(this.empty)return null;var r=this._model.productMaps[t];if(null!=r){if(null!=e){r=c.ProductMap.clone(r);var n=this.getVec3(r.bBox.subarray(0,3)),i=u.vec3.subtract(u.vec3.create(),this.wcs,e),a=u.vec3.add(u.vec3.create(),n,i);r.bBox.set(a,0)}return r}return null},t.prototype.getProductMaps=function(t){var e=this,r=new Array;return this.empty||t.forEach((function(t){var n=e._model.productMaps[t];null!=n&&r.push(n)})),r},t.prototype.unload=function(){if(this.empty)return null;var t=this._gl;t.deleteTexture(this._vertexTexture),t.deleteTexture(this._matrixTexture),t.deleteTexture(this._styleTexture),t.deleteBuffer(this._normalBuffer),t.deleteBuffer(this._indexBuffer),t.deleteBuffer(this._productBuffer),t.deleteBuffer(this._styleBuffer),t.deleteBuffer(this._stateBuffer),t.deleteBuffer(this._transformationBuffer)},t.prototype.InitGPU=function(e,r,n){if(this.empty)return null;var i=function(t){var e={message:"Loading data into GPU",percent:t,type:s.MessageType.PROGRESS};n(e)};this._numberOfIndices=r.indices.length,this.bufferData(this._normalBuffer,r.normals),i(10),this.bufferData(this._indexBuffer,r.indices),i(30),this.bufferData(this._productBuffer,r.products),i(40),this.bufferData(this._stateBuffer,r.states),i(50),this.bufferData(this._transformationBuffer,r.transformations),i(60),this.bufferData(this._styleBuffer,r.styleIndices),this._vertexTextureSize=t.bufferTexture(e,this._vertexTexture,r.vertices,3),i(80),this._matrixTextureSize=t.bufferTexture(e,this._matrixTexture,r.matrices,4),i(90),this._styleTextureSize=t.bufferTexture(e,this._styleTexture,r.styles),i(100),r.normals=null,r.indices=null,r.products=null,r.transformations=null,r.styleIndices=null,r.vertices=null,r.matrices=null;var a={message:"Loading data into GPU",percent:100,type:s.MessageType.COMPLETED};n(a)},t.prototype.bufferData=function(t,e){var r;1===this._glVersion&&((r=this.gl1).bindBuffer(r.ARRAY_BUFFER,t),r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW)),2===this._glVersion&&((r=this.gl2).bindBuffer(r.ARRAY_BUFFER,t),r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW))},t.prototype.getVec3=function(t){return u.vec3.fromValues(t[0],t[1],t[2])},t.bufferTexture=function(t,e,r,n){if(0===r.length){t.bindTexture(t.TEXTURE_2D,e);var i=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,2,2,0,t.RGBA,t.UNSIGNED_BYTE,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),2}var a=r instanceof Float32Array,o=0,s=t.getParameter(t.MAX_TEXTURE_SIZE);if(a)o=Math.ceil(Math.sqrt(Math.ceil(r.length/n)))+1;else{var u=Math.sqrt(r.byteLength/4);o=Math.ceil(u)}if(0===o)return 0;if(o>s)throw new Error("Too much data! It cannot fit into the texture.");if(t.bindTexture(t.TEXTURE_2D,e),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),a){if(i=null,o*o*n!==r.length?(i=new Float32Array(o*o*n)).set(r):i=r,t instanceof WebGLRenderingContext){var c=null;switch(n){case 1:c=t.ALPHA;break;case 3:c=t.RGB;break;case 4:c=t.RGBA}t.texImage2D(t.TEXTURE_2D,0,c,o,o,0,c,t.FLOAT,i)}if("undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext){var l=t,f=null,h=null;switch(n){case 1:h=l.RED,f=l.R32F;break;case 3:h=l.RGB,f=l.RGB32F;break;case 4:h=l.RGBA,f=l.RGBA32F}l.texImage2D(l.TEXTURE_2D,0,f,o,o,0,h,l.FLOAT,i)}}else t.texImage2D(t.TEXTURE_2D,0,t.RGBA,o,o,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(r.buffer));return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),o},t.prototype.getState=function(t){var e=this.getFirstSpan(t);return null==e?null:this._model.states[2*e[0]]},t.prototype.getStates=function(){var t=this,e=[];return Object.getOwnPropertyNames(this._model.productMaps).forEach((function(r){var n=t._model.productMaps[+r];null!=n.states&&0!==n.states.length&&(1===n.states.length&&n.states[0]===a.State.UNDEFINED||e.push({id:n.productID,states:n.states.slice(0)}))})),e},t.prototype.getStyle=function(t){var e=this.getFirstSpan(t);return null==e?null:this._model.states[2*e[0]+1]},t.prototype.getFirstSpan=function(t){if(this.empty)return null;if(void 0===t)throw new Error("id must be defined");var e=this.getProductMap(t);if(null===e)return null;var r=e.spans[0];return void 0===r?null:r},t.prototype.addState=function(t,e){var r=this;this.empty||(this.checkStateArgs(t,e),this.getMaps(e).forEach((function(e){c.ProductMap.addState(e,t);var n=c.ProductMap.getState(e);e.spans.forEach((function(t){for(var e=t[0];e<t[1];e++)r._model.states[2*e]=n}))})),this.bufferData(this._stateBuffer,this._model.states),this._changed=!0)},t.prototype.setState=function(t,e){var r=this;this.empty||(this.checkStateArgs(t,e),this.getMaps(e).forEach((function(e){e.states=[t],e.spans.forEach((function(e){for(var n=e[0];n<e[1];n++)r._model.states[2*n]=t}))})),this.bufferData(this._stateBuffer,this._model.states),this._changed=!0)},t.prototype.clearHighlighting=function(){var t=this;Object.getOwnPropertyNames(this._model.productMaps).forEach((function(e){var r=t._model.productMaps[+e];c.ProductMap.removeState(r,a.State.HIGHLIGHTED);var n=c.ProductMap.getState(r);r.spans.forEach((function(e){for(var r=e[0];r<e[1];r++)t._model.states[2*r]=n}))})),this.bufferData(this._stateBuffer,this._model.states),this._changed=!0},t.prototype.removeState=function(t,e){var r=this;this.empty||(this.checkStateArgs(t,e),this.getMaps(e).forEach((function(e){c.ProductMap.removeState(e,t);var n=c.ProductMap.getState(e);e.spans.forEach((function(t){for(var e=t[0];e<t[1];e++)r._model.states[2*e]=n}))})),this.bufferData(this._stateBuffer,this._model.states),this._changed=!0)},t.prototype.checkStateArgs=function(t,e){if("number"!=typeof t||t<0||t>255)throw new Error("You have to specify state as an ID of state or index in style pallete.");if(void 0===e)throw new Error("You have to specify products as an array of product IDs or as a product type ID")},t.prototype.resetState=function(t){var e=this;if(this.empty)return null;if(null==t){Object.getOwnPropertyNames(this._model.productMaps).forEach((function(t){e._model.productMaps[+t].states=[]}));for(var r=0;r<this._model.states.length;r+=2)this._model.states[r]=a.State.UNDEFINED}else this.getMaps(t).forEach((function(t){t.states=[],t.spans.forEach((function(t){for(var r=t[0];r<t[1];r++)e._model.states[2*r]=a.State.UNDEFINED}))}));this.bufferData(this._stateBuffer,this._model.states),this._changed=!0},t.prototype.getProductsWithState=function(t){var e=this,r=[],n={},i=null!=this.isolatedProducts&&this.isolatedProducts.length>0;return i&&this.isolatedProducts.forEach((function(t){return n[t]=!0})),Object.getOwnPropertyNames(this._model.productMaps).forEach((function(a){var o=e._model.productMaps[a];-1!==o.states.indexOf(t)&&(i&&!n[o.productID]||r.push({id:o.productID,model:e.id}))})),r},t.prototype.setStyle=function(t,e){var r=this;if(this.empty)return null;if("number"!=typeof t&&t<0&&t>255)throw new Error("You have to specify state as an ID of state or index in style pallete.");if(void 0===e)throw new Error("You have to specify products as an array of product IDs or as a product type ID");this.getMaps(e).forEach((function(e){e.spans.forEach((function(e){for(var n=e[0];n<e[1];n++)r._model.states[2*n+1]=t}))})),this.bufferData(this._stateBuffer,this._model.states),this._changed=!0},t.prototype.getMaps=function(t){var e=this,r=[];if("number"==typeof t){var n=o.Product.getAllSubTypes(t);Object.getOwnPropertyNames(this._model.productMaps).forEach((function(t){var i=e._model.productMaps[t];n[i.type]&&r.push(i)}))}else t.forEach((function(t){var n=e.getProductMap(t);null!=n&&r.push(n)}));return r},t.prototype.resetStyles=function(){if(this.empty)return null;for(var t=0;t<this._model.states.length;t+=2)this._model.states[t+1]=a.State.UNSTYLED;this.bufferData(this._stateBuffer,this._model.states),this._changed=!0},t.prototype.getModelState=function(){var t=[];if(this.empty)return t;var e=this._model.productMaps;for(var r in e)if(e.hasOwnProperty(r)){var n=e[r],i=n.spans[0];if(void 0!==i){var a=this._model.states[2*i[0]],o=this._model.states[2*i[0]+1];t.push([n.productID,a+(o<<8)])}}return t},t.prototype.restoreModelState=function(t){var e=this;if(this.empty)return null;t.forEach((function(t){var r=t[0],n=t[1]>>8,i=t[1]-(n<<8),a=e.getProductMap(r);null!=a&&a.spans.forEach((function(t){for(var r=t[0];r<t[1];r++)e._model.states[2*r]=i,e._model.states[2*r+1]=n}))})),this.bufferData(this._stateBuffer,this._model.states),this._changed=!0},t._instancesNum=1,t}();e.ModelHandle=f,function(t){t[t.SOLID=0]="SOLID",t[t.TRANSPARENT=1]="TRANSPARENT"}(n=e.DrawMode||(e.DrawMode={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(14),i=function(){function t(){var t=this;this.load=function(e){var r=new n.BinaryReader,i=t;r.onloaded=function(){i.parse(r),i.onloaded&&i.onloaded(t)},r.load(e,null,null)}}return t.prototype.parse=function(t){t.readByte();var e=t.readInt32(),r=t.readInt32();this.vertices=t.readFloat32Array(3*e),this.indices=new Uint32Array(3*r),this.normals=new Uint8Array(6*r);var n,i=0;n=e<=255?function(e){return t.readByteArray(e)}:e<=65535?function(e){return t.readUint16Array(e)}:function(e){return t.readInt32Array(e)};var a=t.readInt32();if(0!==e&&0!==r)for(var o=0;o<a;o++){var s=t.readInt32();if(0!=s){var u=s>0;if(s=Math.abs(s),u){var c=t.readByteArray(2),l=n(3*s);this.indices.set(l,i);for(var f=0;f<3*s;f++)this.normals[2*i]=c[0],this.normals[2*i+1]=c[1],i++}else for(f=0;f<s;f++)this.indices[i]=n(),this.normals.set(t.readByteArray(2),2*i),i++,this.indices[i]=n(),this.normals.set(t.readByteArray(2),2*i),i++,this.indices[i]=n(),this.normals.set(t.readByteArray(2),2*i),i++}}},t}();e.TriangulatedShape=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i,a,o=r(15),s=r(53),u=r(1),c=r(49),l=r(48),f=r(47),h=r(46),d=r(45),A=r(44),p=r(11),I=r(2),E=r(43),v=r(42),T=r(41),m=r(40),C=r(10),g=r(0),R=r(38),b=r(3),M=r(9),F=r(12),y=r(37),O=r(36),_=function(){function t(t,e){var r=this;if(this.changed=!0,this.navigationMode="orbit",this.zoomDuration=1e3,this._camera=new b.CameraProperties((function(){r.changed=!0})),this._sectionBox=new M.SectionBox((function(){var t=r.getCurrentWcs(),e=r.getMergedRegion().bbox,n=r._sectionBox.getBoundingBox(t);null!=e&&null!=n&&F.BBox.areDisjoint(e,n)&&console.warn("Section box is disjoint with the current content"),r.changed=!0})),this._background=[230,230,230,255],this._highlightingColour=[255,173,33,255],this._xrayColour=[80,80,80,150],this._mvMatrix=g.mat4.create(),this._pMatrix=g.mat4.create(),this._renderingMode=i.NORMAL,this._mvMatrixTimestamp=Date.now(),this._isRunning=!1,this._plugins=[],this._handles=[],this._shaderProgram=null,this._gamma=1,this._contrast=1,this._brightness=0,this._currentFps=60,this._performance=R.PerformanceRating.HIGH,this._events={},this._canvasListeners={},null==t)throw new Error("Canvas has to be defined");if(void 0!==t.nodeName&&"CANVAS"===t.nodeName&&(this.canvas=t),"string"==typeof t&&(this.canvas=document.getElementById(t)),null==this.canvas)throw new Error("You have to specify canvas either as an ID of HTML element or the element itself");if(null!=e&&this.on("error",e),this.cameraProperties.fov=60,this.cameraProperties.near=1,this.cameraProperties.far=100,p.WebGLUtils.setupWebGL(this.canvas,(function(t,e){r.gl=t,r.glVersion=e}),{preserveDrawingBuffer:!0},(function(t){r.error(t)})),this.gl){this._requestAnimationFrame=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}).bind(window);var n=this.gl;if(this.glVersion<2){if(this._fptExtension=n.getExtension("OES_texture_float")||n.getExtension("MOZ_OES_texture_float")||n.getExtension("WEBKIT_OES_texture_float"),!this._fptExtension)throw new Error("Floating point texture support required.");this._depthTextureExtension=n.getExtension("WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture"),this._depthTextureExtension||console.warn("WebGL 1.0 Depth texture extension not available. Interaction might be constrained as 3D of the event won't be calculated.")}n.enable(n.DEPTH_TEST),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),n.enable(n.BLEND),this.width=this.canvas.width=this.canvas.offsetWidth,this.height=this.canvas.height=this.canvas.offsetHeight,this._initShaders(),this._initAttributesAndUniforms(),E.MouseNavigation.initMouseEvents(this),v.KeyboardNavigation.initKeyboardEvents(this),T.TouchNavigation.initTouchNavigationEvents(this),T.TouchNavigation.initTouchTapEvents(this),this._disableContextMenu(),this._stateStyles=new Uint8Array(900),this._stateStyleTexture=n.createTexture(),n.activeTexture(n.TEXTURE4),n.bindTexture(n.TEXTURE_2D,this._stateStyleTexture),n.uniform1i(this._stateStyleSamplerUniform,4),s.ModelHandle.bufferTexture(n,this._stateStyleTexture,this._stateStyles);var a=this.height,o=this.width,u=function(){r.canvas.offsetHeight===a&&r.canvas.offsetWidth===o||(a=r.height=r.canvas.height=r.canvas.offsetHeight,o=r.width=r.canvas.width=r.canvas.offsetWidth),r._requestAnimationFrame(u)};u(),this._watchFps(),this._watchPerformance(),this._cameraAdjustment=new y.CameraAdjustment(this,this._requestAnimationFrame,20),this.animations=new C.Animations(this)}else this.error("Unable to set up WebGL")}return Object.defineProperty(t.prototype,"cameraProperties",{get:function(){return this._camera},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sectionBox",{get:function(){return this._sectionBox},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this.changed=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this.changed=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"camera",{get:function(){return this.cameraProperties.type},set:function(t){this.cameraProperties.type=t,this.changed=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this._background},set:function(t){this._background=t,this.changed=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"highlightingColour",{get:function(){return this._highlightingColour},set:function(t){this._highlightingColour=t,this.changed=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xrayColour",{get:function(){return this._xrayColour},set:function(t){this._xrayColour=t,this.changed=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mvMatrix",{get:function(){return this._mvMatrix},set:function(t){this._mvMatrix=t,this.changed=!0,this._mvMatrixTimestamp=Date.now()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pMatrix",{get:function(){return this._pMatrix},set:function(t){this._pMatrix=t,this.changed=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderingMode",{get:function(){return this._renderingMode},set:function(t){this._renderingMode=t,this.changed=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gamma",{get:function(){return this._gamma},set:function(t){this._gamma=t,this.changed=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contrast",{get:function(){return this._contrast},set:function(t){this._contrast=t,this.changed=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"brightness",{get:function(){return this._brightness},set:function(t){this._brightness=t,this.changed=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mvMatrixAge",{get:function(){return Date.now()-this._mvMatrixTimestamp},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"performance",{get:function(){return this._performance},set:function(t){this._performance=t,this.changed=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plugins",{get:function(){return this._plugins.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unitsInMeter",{get:function(){var t=this.activeHandles.map((function(t){return t.meter}));return 0===t.length?null:t[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"adjustments",{get:function(){return this._cameraAdjustment},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activeHandles",{get:function(){return this._handles.filter((function(t){return null!=t&&!t.stopped&&!t.empty}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasDepthSupport",{get:function(){return this.glVersion>1||null!=this._depthTextureExtension},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),t.check=function(){return m.Abilities.check()},t.prototype.addPlugin=function(t){t.init&&(t.init(this),this._plugins.push(t),this.changed=!0)},t.prototype.removePlugin=function(t){var e=this._plugins.indexOf(t,0);e<0||(this._plugins.splice(e,1),this.changed=!0)},t.prototype.defineStyle=function(t,e){if(void 0===t||t<0&&t>224)throw new Error("Style index has to be defined as a number 0-224");if(void 0===e||!e.length||4!==e.length)throw new Error("Colour must be defined as an array of 4 bytes");var r=new Uint8Array(e);this._stateStyles.set(r,4*t);var n=this.setActive();n.activeTexture(n.TEXTURE4),n.bindTexture(n.TEXTURE_2D,this._stateStyleTexture),s.ModelHandle.bufferTexture(n,this._stateStyleTexture,this._stateStyles),this.changed=!0},t.prototype.addState=function(t,e,r){if(void 0===t||!(t>=225&&t<=255))throw new Error("State has to be defined as 225 - 255. Use State enum.");if(null==e)throw new Error("Target must be defined either as type ID or as a list of product IDs");this.forHandleOrAll((function(r){r.addState(t,e)}),r),this.changed=!0},t.prototype.setState=function(t,e,r){if(void 0===t||!(t>=225&&t<=255))throw new Error("State has to be defined as 225 - 255. Use State enum.");if(null==e)throw new Error("Target must be defined either as type ID or as a list of product IDs");this.forHandleOrAll((function(r){r.setState(t,e)}),r),this.changed=!0},t.prototype.removeState=function(t,e,r){if(void 0===t||!(t>=225&&t<=255))throw new Error("State has to be defined as 225 - 255. Use State enum.");if(null==e)throw new Error("Target must be defined either as type ID or as a list of product IDs");this.forHandleOrAll((function(r){r.removeState(t,e)}),r),this.changed=!0},t.prototype.getProductsWithState=function(t){var e=[];return this._handles.filter((function(t){return!t.stopped&&!t.empty})).forEach((function(r){var n=r.getProductsWithState(t);null!=n&&n.length>0&&(e=e.concat(n))})),e},t.prototype.getState=function(t,e){return this.forHandleOrAll((function(e){return e.getState(t)}),e)},t.prototype.resetState=function(t,e){this.forHandleOrAll((function(e){e.resetState(t)}),e),this.changed=!0},t.prototype.clearHighlighting=function(){this._handles.filter((function(t){return!t.stopped&&!t.empty})).forEach((function(t){return t.clearHighlighting()}))},t.prototype.forHandleOrAll=function(t,e){if(null!=e){var r=this.getHandle(e);if(!r)throw new Error("Model with id '"+e+"' doesn't exist.");return t(r)}var n=null;return this._handles.forEach((function(e){if(e){var r=t(e);null!=r&&(n=r)}})),n},t.prototype.getHandle=function(t){return this._handles.filter((function(e){return null!=e&&e.id===t})).pop()},t.prototype.getCurrentImageHtml=function(t,e){void 0===t&&(t=this.width),void 0===e&&(e=this.height);var r=document.createElement("img");return r.src=this.getCurrentImageDataUrl(t,e),r},t.prototype.getCurrentImageDataUrl=function(t,e,r){if(void 0===t&&(t=this.width),void 0===e&&(e=this.height),void 0===r&&(r="png"),0===t||0===e)return null;var n=new u.Framebuffer(this.gl,t,e,!1);this.draw(n);var i=n.getImageDataUrl(r);return n.delete(),i},t.prototype.getCurrentImageDataArray=function(t,e){if(void 0===t&&(t=this.width),void 0===e&&(e=this.height),0===t||0===e)return null;var r=new u.Framebuffer(this.gl,t,e,!1);this.draw(r);var n=r.getImageDataArray();return r.delete(),n},t.prototype.getCurrentImageBlob=function(t){return this.canvas.toBlob(t,"image/png")},t.prototype.getProductsStates=function(t){var e=this.getHandle(t);if(null==e)throw new Error("Model '"+t+"' doesn't exist");return e.getStates()},t.prototype.restoreProductsStates=function(t,e){var r=this.getHandle(t);if(null==r)throw new Error("Model '"+t+"' doesn't exist");r.resetState(),e.forEach((function(t){t.states.forEach((function(e){r.addState(e,[t.id])}))}))},t.prototype.getModelState=function(t){var e=this.getHandle(t);if(null==e)throw new Error("Model '"+t+"' doesn't exist");return e.getModelState()},t.prototype.restoreModelState=function(t,e){var r=this.getHandle(t);if(null==r)throw new Error("Model '"+t+"' doesn't exist");r.restoreModelState(e),this.changed=!0},t.prototype.setStyle=function(t,e,r){if(void 0===t||!(t>=0&&t<=225))throw new Error("Style has to be defined as 0 - 225 where 225 is for default style.");var n=[this._stateStyles[4*t],this._stateStyles[4*t+1],this._stateStyles[4*t+2],this._stateStyles[4*t+3]];0===n[0]&&0===n[1]&&0===n[2]&&0===n[3]&&console.warn("You have used undefined colour for restyling. Elements with this style will have transparent black colour and hence will be invisible."),this.forHandleOrAll((function(r){r.setStyle(t,e)}),r),this.changed=!0},t.prototype.getStyle=function(t,e){this.forHandleOrAll((function(e){return e.getStyle(t)}),e)},t.prototype.resetStyles=function(t){this.forHandleOrAll((function(t){t.resetStyles()}),t),this.changed=!0},t.prototype.getProductType=function(t,e){return this.forHandleOrAll((function(e){var r=e.getProductMap(t);if(r)return r.type}),e)},t.prototype.getProductBoundingBox=function(t,e){var r=this;return this.forHandleOrAll((function(e){var n=r.getCurrentWcs(),i=e.getProductMap(t,n);if(i){var a=i.bBox;return new Float32Array([a[0]+n[0],a[1]+n[1],a[2]+n[2],a[3],a[4],a[5]])}}),e)},t.prototype.getDistanceAndHeight=function(t,e,r){var n=F.BBox.getSizeInView(t,e,r),i=n.width/n.height,a=this.width>0&&this.height>0?this.width/this.height:1,o=n.width,s=n.height;return i>a?s=o/a:i<a&&(o=s*a),{distance:s/(2*Math.tan(this.cameraProperties.fov*Math.PI/180/2))+n.depth/2,height:1*s}},t.prototype.getTargetBoundingBox=function(t,e){var r=this.getCurrentWcs();if(null!=t)return this.forHandleOrAll((function(e){var n=e.getProductMap(t,r);if(n)return n.bBox}),e)||null;var n=this.getMergedRegion();return n&&n.population>0?n.bbox:null},t.prototype.getTargetsBoundingBox=function(t){var e=this,r=this.getCurrentWcs();return t.reduce((function(t,n){var i=e.forHandleOrAll((function(t){var e=t.getProductMap(n.id,r);if(e)return e.bBox}),n.model);return F.BBox.union(i,t)}),F.BBox.none)},t.prototype.getMergedRegion=function(){var t=new o.Region,e=this.getCurrentWcs();this.activeHandles.forEach((function(r){var n=r.getRegion(e);null!=n&&(t=t.merge(n))}));var r=t.bbox;return this.sectionBox.isSet&&(null==(r=F.BBox.intersection(t.bbox,this.sectionBox.getBoundingBox(e)))?console.debug("View will be empty because section box and actual content region are disjoint"):(t.bbox=new Float32Array(r),t.centre=new Float32Array(F.BBox.centre(r)))),t},t.prototype.getMergedRegionWcs=function(){var t=new o.Region,e=g.vec3.create();return this.activeHandles.forEach((function(r){var n=r.getRegion(e);null!=n&&(t=t.merge(n))})),t},t.prototype.set=function(t){var e=this;Object.getOwnPropertyNames(t).forEach((function(r){e[r]=t[r]}))},t.prototype.loadAsync=function(t,e,r,n){if(void 0===t)throw new Error("You have to specify model to load.");if("string"!=typeof t&&!(t instanceof Blob))throw new Error("Model has to be specified either as a URL to wexBIM file or Blob object representing the wexBIM file.");var i=this,a=n?function(t){t.type===I.MessageType.COMPLETED&&(t.type=I.MessageType.PROGRESS),n(t)}:function(t){};if("undefined"==typeof Worker)return this.load(t,e,r,n),void console.warn("Asynchronous model loading requires Web Worker support in the browser. Falling back to synchronous loading.");var o=new Blob([l.worker],{type:"application/javascript"}),s=new Worker(URL.createObjectURL(o));if(s.onmessage=function(t){var r=t.data;if(r.type===I.MessageType.COMPLETED){var o=r.result;r.result=null,a(r);var s=i.addHandle(o,e,a);n&&n({message:"Model loaded",type:I.MessageType.COMPLETED,percent:100,wexbimId:s})}else a(r)},s.onerror=function(t){i.error(t.message)},"string"==typeof t&&0!==t.indexOf("http")){var u=document.createElement("a");u.href=t,t=u.href}s.postMessage({model:t,headers:r})},t.prototype.load=function(t,e,r,n){if(null==t)throw new Error("You have to specify model to load.");if("string"!=typeof t&&!(t instanceof Blob))throw new Error("Model has to be specified either as a URL to wexBIM file or Blob object representing the wexBIM file.");var i=this,a=new o.ModelGeometry;a.onloaded=function(){i.addHandle(a,e,n)},a.onerror=function(t){i.error(t)},a.load(t,r,n)},t.prototype.addHandle=function(t,e,r){var n=this.setActive(),i=new s.ModelHandle(n,t,r);return i.tag=e,this._handles.push(i),this.setNearAndFarFromCurrentModels(),this.changed=!0,this.fire("loaded",{model:i.id,tag:e}),i.id},t.prototype.setNearAndFarFromCurrentModels=function(){if(0!==this.activeHandles.length){var t=this.getMergedRegion();if(t&&t.bbox&&0!==t.bbox.length){var e=this.activeHandles[0].meter,r=Math.max(t.bbox[3],t.bbox[4],t.bbox[5]);this.cameraProperties.far=20*r,this.cameraProperties.near=e/4}}},t.prototype.unload=function(t){var e=this.getHandle(t);if(null==e)throw new Error("Model with id: "+t+" doesn't exist or was unloaded already.");e.stopped=!0;var r=this._handles.indexOf(e);this._handles.splice(r,1),this.changed=!0,e.unload(),this.fire("unloaded",{tag:e.tag,model:e.id})},t.prototype._initShaders=function(){var t=this,e=this.gl,r=function(r,n){if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(r);return t.error(i),console.error(i),!1}return!0},n=e.createShader(e.FRAGMENT_SHADER);if(!(1===this.glVersion?r(n,f.fragment_shader):r(n,d.fragment_shader_300)))return!1;var i=e.createShader(e.VERTEX_SHADER);if(!(1===this.glVersion?r(i,h.vertex_shader):r(i,A.vertex_shader_300)))return!1;this._shaderProgram=e.createProgram(),e.attachShader(this._shaderProgram,i),e.attachShader(this._shaderProgram,n),e.linkProgram(this._shaderProgram),e.getProgramParameter(this._shaderProgram,e.LINK_STATUS)?e.useProgram(this._shaderProgram):(this.error("Could not initialise shaders "),console.error("Could not initialise shaders "))},t.prototype.setActive=function(){var t=this.gl;return t.useProgram(this._shaderProgram),t},t.prototype._initAttributesAndUniforms=function(){var t=this.setActive();this._pMatrixUniformPointer=t.getUniformLocation(this._shaderProgram,"uPMatrix"),this._mvMatrixUniformPointer=t.getUniformLocation(this._shaderProgram,"uMVMatrix"),this._lightUniformPointer=t.getUniformLocation(this._shaderProgram,"uLight"),this._colorCodingUniformPointer=t.getUniformLocation(this._shaderProgram,"uColorCoding"),this._renderingModeUniformPointer=t.getUniformLocation(this._shaderProgram,"uRenderingMode"),this._highlightingColourUniformPointer=t.getUniformLocation(this._shaderProgram,"uHighlightColour"),this._xrayColourUniformPointer=t.getUniformLocation(this._shaderProgram,"uXRayColour"),this._stateStyleSamplerUniform=t.getUniformLocation(this._shaderProgram,"uStateStyleSampler"),this._gammaContrastBrightnessUniform=t.getUniformLocation(this._shaderProgram,"uGBC"),this._sectionBoxUniform=t.getUniformLocation(this._shaderProgram,"uSectionBox"),this._pointers=new c.ModelPointers(t,this._shaderProgram)},t.prototype._disableContextMenu=function(){this.canvas.addEventListener("contextmenu",(function(t){return t.preventDefault(),"contextmenu"!==t.type}))},Object.defineProperty(t.prototype,"meter",{get:function(){var t=this._handles.find((function(t){return!t.stopped}));return t?t.meter:1},enumerable:!0,configurable:!0}),t.prototype.navigate=function(t,e,r,n){if(0!==this.activeHandles.length){var i=this.getCameraPosition(),a=g.vec3.distance(i,n);"look-around"===t&&(n=i,e=-e,r=-r),"look-at"===t&&(n=i);var o=g.vec3.transformMat4(g.vec3.create(),n,this.mvMatrix),s=g.mat4.translate(g.mat4.create(),g.mat4.create(),o),u=function(t){return t*Math.PI/180};switch(t){case"free-orbit":s=g.mat4.rotate(g.mat4.create(),s,u(r/4),[1,0,0]),s=g.mat4.rotate(g.mat4.create(),s,u(e/4),[0,1,0]);break;case"fixed-orbit":case"look-around":case"look-at":case"orbit":g.mat4.rotate(s,s,u(r/4),[1,0,0]);var c=g.vec3.transformMat3(g.vec3.create(),[0,0,1],g.mat3.fromMat4(g.mat3.create(),this.mvMatrix));c=g.vec3.normalize(g.vec3.create(),c),s=g.mat4.rotate(g.mat4.create(),s,u(e/4),c);break;case"pan":var l=0;if(this.camera===b.CameraType.ORTHOGONAL)l=this.cameraProperties.height/this.height;else{var f=this.cameraProperties.fov*Math.PI/180;l=2*a*Math.tan(f/2)/this.height}s=g.mat4.translate(g.mat4.create(),s,[l*e,-l*r,0]);break;case"walk":var h=r*this.meter*.5/20;return void this.animations.addZoom(h,0);case"zoom":var d=g.vec3.subtract(g.vec3.create(),n,i),A=r*Math.max(a,2*this.meter)/20;return void this.animations.addZoom(A,50,d)}var p=g.vec3.negate(g.vec3.create(),o);s=g.mat4.translate(g.mat4.create(),s,p),this.mvMatrix=g.mat4.multiply(g.mat4.create(),s,this.mvMatrix)}},t.prototype.getCurrentWcs=function(){var t=function(t){return!t.empty&&!t.stopped};if(null!=this._lastWcs&&!0===t(this._lastWcs))return this._lastWcs.wcs;var e=this._handles.filter(t)[0];return null!=e?(this._lastWcs=e,this._lastWcs.wcs):g.vec3.create()},t.prototype.draw=function(t,e){var r=this;void 0===e&&(e=!1);var a=this.getCurrentWcs(),o=this.gl;o.clearColor(this.background[0]/255,this.background[1]/255,this.background[2]/255,this.background[3]/255),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);var u=t?t.width:this.width,c=t?t.height:this.height;o.viewport(0,0,u,c),this.updatePMatrix(u,c),o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),e||this._plugins.forEach((function(t){t.onBeforeDraw&&t.onBeforeDraw(u,c)})),(o=this.setActive()).activeTexture(o.TEXTURE4),o.bindTexture(o.TEXTURE_2D,this._stateStyleTexture),o.uniform1i(this._stateStyleSamplerUniform,4),o.uniformMatrix4fv(this._pMatrixUniformPointer,!1,this.pMatrix),o.uniformMatrix4fv(this._mvMatrixUniformPointer,!1,this.mvMatrix);var l=this.getLightPosition(1*this.meter,1*this.meter);o.uniform3fv(this._lightUniformPointer,l),o.uniform3fv(this._gammaContrastBrightnessUniform,new Float32Array([this.gamma,this.contrast,this.brightness])),o.uniformMatrix4fv(this._sectionBoxUniform,!1,this.sectionBox.getMatrix(a)),o.uniform1i(this._colorCodingUniformPointer,n.NONE),o.uniform4fv(this._highlightingColourUniformPointer,new Float32Array([this.highlightingColour[0]/255,this.highlightingColour[1]/255,this.highlightingColour[2]/255,this.highlightingColour[3]/255])),o.uniform4fv(this._xrayColourUniformPointer,new Float32Array([this.xrayColour[0]/255,this.xrayColour[1]/255,this.xrayColour[2]/255,this.xrayColour[3]/255])),t?o.bindFramebuffer(o.FRAMEBUFFER,t.framebuffer):o.bindFramebuffer(o.FRAMEBUFFER,null),o.uniform1i(this._renderingModeUniformPointer,this.renderingMode),this.renderingMode===i.XRAY||this.renderingMode===i.XRAY_ULTRA?this.drawXRAY(o):(o.disable(o.CULL_FACE),o.enable(o.DEPTH_TEST),this._handles.forEach((function(t){t.stopped||(t.setActive(r._pointers,a),t.draw(s.DrawMode.SOLID))})),this._handles.forEach((function(t){t.stopped||(t.setActive(r._pointers,a),t.draw(s.DrawMode.TRANSPARENT))}))),e||this._plugins.forEach((function(t){t.onAfterDraw&&t.onAfterDraw(u,c)}))},t.prototype.getLightPosition=function(t,e){var r=g.mat4.getRotation(g.quat.create(),this.mvMatrix),n=g.quat.invert(g.quat.create(),r),i=g.vec3.transformQuat(g.vec3.create(),[0,1,0],n),a=g.vec3.transformQuat(g.vec3.create(),[1,0,0],n),o=g.vec3.scale(g.vec3.create(),i,t),s=g.vec3.scale(g.vec3.create(),a,e),u=g.vec3.add(g.vec3.create(),o,s),c=this.getCameraPosition();return g.vec3.add(g.vec3.create(),c,u)},t.prototype.drawXRAY=function(t){var e=this,r=this.renderingMode,n=this.getCurrentWcs(),a=function(){t.enable(t.CULL_FACE),t.uniform1i(e._renderingModeUniformPointer,3),t.depthMask(!1),e._handles.forEach((function(t){t.stopped||(t.setActive(e._pointers,n),t.draw())})),t.depthMask(!0)},o=function(){t.disable(t.CULL_FACE),t.uniform1i(e._renderingModeUniformPointer,i.XRAY),t.enable(t.DEPTH_TEST),e._handles.forEach((function(t){t.stopped||(t.setActive(e._pointers,n),t.draw())}))};r===i.XRAY&&(o(),a()),r===i.XRAY_ULTRA&&(a(),o())},t.prototype.updatePMatrix=function(t,e){this.pMatrix=this.cameraProperties.getProjectionMatrix(t,e)},t.prototype.getCameraPosition=function(){var t=g.mat4.invert(g.mat4.create(),this.mvMatrix);return null==t?g.vec3.create():g.vec3.transformMat4(g.vec3.create(),g.vec3.create(),t)},t.prototype.getCameraPositionWcs=function(){var t=this.getCameraPosition(),e=this.getCurrentWcs();return g.vec3.add(g.vec3.create(),t,e)},t.prototype.getCameraDirection=function(){var t=g.mat4.invert(g.mat4.create(),this.mvMatrix),e=g.mat4.getRotation(g.quat.create(),t);return g.vec3.transformQuat(g.vec3.create(),g.vec3.fromValues(0,0,-1),e)},t.prototype.getCameraHeading=function(){var t=g.mat4.invert(g.mat4.create(),this.mvMatrix),e=g.mat4.getRotation(g.quat.create(),t);return g.vec3.transformQuat(g.vec3.create(),g.vec3.fromValues(0,1,0),e)},t.prototype.zoomTo=function(t,e,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0);var i=r?this.zoomDuration:0,a=null;if(null==t||"number"==typeof t){if(a=this.getTargetBoundingBox(t,e),!0===n&&"number"==typeof t&&null!=(o=O.PreflightCheck.findView(this,[{id:t,model:e||1}],10)))return this.animations.viewTo(o,i)}else{var o;if(!0===n&&t.length>0&&null!=(o=O.PreflightCheck.findView(this,t,10)))return this.animations.viewTo(o,i);a=t.length>0?this.getTargetsBoundingBox(t):this.getTargetBoundingBox()}if(null==a)return new Promise((function(t,e){return e("There is no content to zoom to")}));var s=g.vec3.fromValues(a[0]+a[3]/2,a[1]+a[4]/2,a[2]+a[5]/2),u=this.getCameraPosition(),c=g.vec3.subtract(g.vec3.create(),u,s);c=g.vec3.normalize(g.vec3.create(),c);var l=g.vec3.angle(c,[0,0,1]),f=g.vec3.fromValues(0,0,1);(Math.abs(l)<1e-6||Math.abs(l-Math.PI)<1e-6)&&(f=this.getCameraHeading());var h=this.getDistanceAndHeight(a,c,f),d=g.vec3.create();g.vec3.scale(d,c,h.distance),g.vec3.add(u,d,s);var A=g.mat4.lookAt(g.mat4.create(),u,s,f);return this.animations.viewTo({mv:A,height:h.height},i)},t.prototype.show=function(t,e,r,n){void 0===n&&(n=!0);var i=this.getTargetBoundingBox(e,r);if(null==i)return new Promise((function(t,e){return e()}));var o=n?this.zoomDuration:0,s=g.vec3.fromValues(i[0]+i[3]/2,i[1]+i[4]/2,i[2]+i[5]/2),u=null,c=g.vec3.fromValues(0,0,1);switch(t){case a.TOP:u=g.vec3.fromValues(0,0,-1),c=g.vec3.fromValues(0,1,0);break;case a.BOTTOM:u=g.vec3.fromValues(0,0,1),c=g.vec3.fromValues(0,-1,0);break;case a.FRONT:u=g.vec3.fromValues(0,1,0);break;case a.BACK:u=g.vec3.fromValues(0,-1,0);break;case a.LEFT:u=g.vec3.fromValues(1,0,0);break;case a.RIGHT:u=g.vec3.fromValues(-1,0,0);break;case a.DEFAULT:u=g.vec3.normalize(g.vec3.create(),[1,1,-1])}var l=this.getDistanceAndHeight(i,u,c),f=g.vec3.negate(g.vec3.create(),u),h=g.vec3.scale(g.vec3.create(),f,l.distance),d=g.vec3.add(g.vec3.create(),s,h),A=g.mat4.lookAt(g.mat4.create(),d,s,c);return this.animations.viewTo({mv:A,height:l.height},o)},t.prototype.startRotation=function(){this.animations.startRotation()},t.prototype.stopRotation=function(){this.animations.stopRotation()},t.prototype.error=function(t){this.fire("error",{message:t})},t.prototype.getInteractionOrigin=function(t){var e=this.getEventDataFromEvent(t);if(null==e||null==e.id||null==e.model)return null;if(null!=e.xyz)return e.xyz;var r=this.getTargetBoundingBox(e.id,e.model);return g.vec3.fromValues(r[0]+r[3]/2,r[1]+r[4]/2,r[2]+r[5]/2)},t.prototype.getEventDataFromEvent=function(t,e){void 0===e&&(e=!1);var r=t.clientX,n=t.clientY,i=this.canvas.getBoundingClientRect(),a=r-i.left,o=this.height-(n-i.top);if(!e)return this.getEventData(a,o);var s=this.getEventDataRaw(a,o);return null==s?{id:null,model:null,xyz:null}:{id:s.renderId,model:s.modelId,xyz:s.location}},t.prototype.getEventData=function(e,r){var n=this.getEventDataRaw(e,r);if(null==n)return t.noData;var i=n.renderId,a=n.modelId,o=this.getHandle(a);return null!=o?{id:o.getProductId(i),model:a,xyz:n.location}:t.noData},t.prototype.getEventDataRaw=function(t,e){var r=this;if(0===this.width||0===this.height||0===this.activeHandles.length)return null;var i=this.setActive(),a=Math.floor(this.width/4),o=Math.floor(this.height/4),s=this.getCurrentWcs(),c=this.cameraProperties.near,l=this.cameraProperties.far,f=this._isRunning;t=Math.floor(t/4),e=Math.floor(e/4),this._isRunning=!1,null==this._eventFB&&(this._eventFB=new u.Framebuffer(i,a,o,this.hasDepthSupport)),(Math.abs(a-this._eventFB.width)>1||Math.abs(o-this._eventFB.height)>1)&&(this._eventFB.delete(),this._eventFB=new u.Framebuffer(i,a,o,this.hasDepthSupport));var h=this._eventFB;h.bind();try{this.setActive(),i.viewport(0,0,a,o),i.enable(i.DEPTH_TEST),i.disable(i.BLEND),i.enable(i.SCISSOR_TEST),i.scissor(t,e,1,1),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),this._plugins.forEach((function(t){t.onBeforeDrawId&&t.onBeforeDrawId()})),this.setActive(),i.uniform1i(this._colorCodingUniformPointer,n.PRODUCTS),this._handles.forEach((function(t){!t.stopped&&t.pickable&&(t.setActive(r._pointers,s),t.draw())})),this._plugins.forEach((function(t){t.onAfterDrawId&&t.onAfterDrawId()}));var d=h.getId(t,e);if(null==d)return null;var A=h.getXYZRange(t,e);if(null!=A){var p=g.mat4.invert(g.mat4.create(),this.pMatrix),I=g.vec3.transformMat4(g.vec3.create(),A.near,p),E=g.vec3.transformMat4(g.vec3.create(),A.far,p),v=-1*I[2],T=-1*E[2];this.cameraProperties.near=v,this.cameraProperties.far=T}this.setActive(),i.bindFramebuffer(i.FRAMEBUFFER,h.framebuffer),this.updatePMatrix(a,o),i.uniformMatrix4fv(this._pMatrixUniformPointer,!1,this.pMatrix),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),this._handles.forEach((function(t){!t.stopped&&t.pickable&&(i.uniform1i(r._colorCodingUniformPointer,t.id),t.setActive(r._pointers,s),t.draw())})),this._plugins.forEach((function(t){t.onAfterDrawModelId&&t.onAfterDrawModelId()}));var m=h.getId(t,e),C=h.getXYZ(t,e),R=null;if(null!=C){var b=g.mat4.multiply(g.mat4.create(),this.pMatrix,this.mvMatrix),M=g.mat4.invert(g.mat4.create(),b);R=g.vec3.transformMat4(g.vec3.create(),C,M)}return{location:R,modelId:m,renderId:d}}catch(t){this.error(t)}finally{this.setActive(),i.bindFramebuffer(i.FRAMEBUFFER,null),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),i.enable(i.BLEND),i.disable(i.SCISSOR_TEST),this.cameraProperties.near=c,this.cameraProperties.far=l,this.updatePMatrix(a,o),i.uniformMatrix4fv(this._pMatrixUniformPointer,!1,this.pMatrix),this._isRunning=f}},t.prototype.getData=function(t){var e=this;if(0===this.width||0===this.height||0===this.activeHandles.length)return null;var r=this.setActive(),i=Math.floor(this.width/4),a=Math.floor(this.height/4),o=this.getCurrentWcs(),s=this._isRunning;t=t.map((function(t){return{x:Math.floor(t.x/4),y:Math.floor(t.y/4)}})),this._isRunning=!1;var c=new u.Framebuffer(r,i,a,!1);c.bind();try{this.setActive(),r.viewport(0,0,i,a),r.enable(r.DEPTH_TEST),r.disable(r.BLEND),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),this.setActive(),r.uniform1i(this._colorCodingUniformPointer,n.PRODUCTS),this.updatePMatrix(i,a),r.uniformMatrix4fv(this._pMatrixUniformPointer,!1,this.pMatrix),r.uniformMatrix4fv(this._mvMatrixUniformPointer,!1,this.mvMatrix),this._handles.forEach((function(t){t.stopped||(t.setActive(e._pointers,o),t.draw())}));var l=c.getIds(t);this.setActive(),r.bindFramebuffer(r.FRAMEBUFFER,c.framebuffer),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),this._handles.forEach((function(t){t.stopped||(r.uniform1i(e._colorCodingUniformPointer,t.id),t.setActive(e._pointers,o),t.draw())}));var f=c.getIds(t);return l.map((function(t,r){if(null==t)return null;var n=f[r];if(null==n)return null;var i=e.getHandle(n);return null==i?null:{id:i.getProductId(t),model:n}}))}catch(t){this.error(t)}finally{this.setActive(),r.bindFramebuffer(r.FRAMEBUFFER,null),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),r.enable(r.BLEND),this._isRunning=s}},t.prototype.isolate=function(t,e){var r=this.getHandle(e);if(!r)throw new Error("Model with id "+e+" doesn't exist.");r.isolatedProducts=t},t.prototype.getIsolated=function(t){var e=this.getHandle(t);if(!e)throw new Error("Model with id "+t+" doesn't exist.");return e.isolatedProducts},t.prototype._watchFps=function(){var t=this,e=Date.now(),r=0,n=function(){r++;var i=Date.now(),a=i-e;if(a>=500){var o=1e3/a*r;e=i,r=0,Math.abs(t._currentFps-o)>=1&&(t._currentFps=o,t.fire("fps",Math.floor(o)))}t._requestAnimationFrame(n)};n()},t.prototype._watchPerformance=function(){var t=this,e=function(){var r=t.mvMatrixAge,n=t._currentFps;r>1e3&&t.performance===R.PerformanceRating.HIGH||(r>1e3?t.performance=R.PerformanceRating.HIGH:(n<10&&t.performance>R.PerformanceRating.VERY_LOW?t.performance=R.PerformanceRating.VERY_LOW:n<20&&t.performance>R.PerformanceRating.LOW?t.performance=R.PerformanceRating.LOW:n<30&&t.performance>R.PerformanceRating.MEDIUM&&(t.performance=R.PerformanceRating.MEDIUM),t._requestAnimationFrame(e)))};setInterval(e,500)},t.prototype.start=function(t){var e=this;if(null!=t){var r=this.getHandle(t);if(void 0===r)throw new Error("Model doesn't exist.");if(r.stopped=!1,this.setNearAndFarFromCurrentModels(),this._isRunning)return}if(this.changed=!0,this.setNearAndFarFromCurrentModels(),!this._isRunning){this._isRunning=!0;var n=function(){e._isRunning&&(0===e._handles.length||!e.changed&&0===e.activeHandles.filter((function(t){return t.changed})).length||(e.draw(),e.changed=!1),e._requestAnimationFrame(n))};n()}},t.prototype.stop=function(t){if(null!=t){var e=this.getHandle(t);if(null==e)throw new Error("Model doesn't exist.");e.stopped=!0,this.changed=!0,this.setNearAndFarFromCurrentModels()}else this._isRunning=!1},t.prototype.stopAll=function(){var t=this;this._handles.forEach((function(e){e.stopped=!0,t.changed=!0})),this._isRunning=!1},t.prototype.isModelOn=function(t){var e=this.getHandle(t);return!!e&&!e.stopped},t.prototype.isProductInModel=function(t,e){var r=this.getHandle(e);return!!r&&null!=r.getState(t)},t.prototype.isModelLoaded=function(t){return!!this.getHandle(t)},t.prototype.startAll=function(){var t=this;this._handles.forEach((function(e){e.stopped=!1,t.changed=!0})),this._isRunning=!0},t.prototype.stopPicking=function(t){var e=this.getHandle(t);if(null==e)throw new Error("Model doesn't exist.");e.pickable=!1},t.prototype.startPicking=function(t){var e=this.getHandle(t);if(void 0===e)throw new Error("Model doesn't exist.");e.pickable=!0},t.prototype.isPickable=function(t){return this.getHandle(t).pickable},t.prototype.on=function(t,e){var r=this,n=this._events;n[t]||(n[t]=[]),n[t].push(e);var i="on"+t;if((void 0!==this.canvas[i]||void 0!==document[i])&&null==this._canvasListeners[t]){var a=function(e){if("pointerlockchange"!==e.type){var n,i=t;e instanceof MouseEvent?null!=(n=r.getEventDataFromEvent(e))&&r.fire(i,{event:e,id:n.id,model:n.model,xyz:n.xyz}):e instanceof TouchEvent&&null!=(n=r.getEventDataFromEvent(e.touches[e.touches.length-1]))&&r.fire(i,{event:e,id:n.id,model:n.model,xyz:n.xyz})}else r.fire("pointerlockchange",{target:document.pointerLockElement})};"pointerlockchange"===t||"pointerlockerror"===t?document.addEventListener(t,a,!1):this.canvas.addEventListener(t,a),this._canvasListeners[t]=a}},t.prototype.off=function(t,e){var r=this._events[t];if(r){var n=r.indexOf(e);if(n>=0){r.splice(n,1);var i=this._canvasListeners[t];0===r.length&&null!==i&&("pointerlockchange"===t||"pointerlockerror"===t?document.removeEventListener(t,i):this.canvas.removeEventListener(t,i),this._canvasListeners[t]=null)}}},t.prototype.fire=function(t,e){var r=this._events[t];r&&r.slice().forEach((function(t){try{t(e)}catch(t){console.error(t)}}))},t.prototype.disableTextSelection=function(){document.documentElement.style["-webkit-touch-callout"]="none",document.documentElement.style["-webkit-user-select"]="none",document.documentElement.style["-khtml-user-select"]="none",document.documentElement.style["-moz-user-select"]="none",document.documentElement.style["-ms-user-select"]="none",document.documentElement.style["user-select"]="none"},t.prototype.enableTextSelection=function(){document.documentElement.style["-webkit-touch-callout"]="text",document.documentElement.style["-webkit-user-select"]="text",document.documentElement.style["-khtml-user-select"]="text",document.documentElement.style["-moz-user-select"]="text",document.documentElement.style["-ms-user-select"]="text",document.documentElement.style["user-select"]="text"},t.prototype.clip=function(t,e){if(null==t||null==e)throw new Error("Cutting plane not well defined");var r=0-e[0]*t[0]-e[1]*t[1]-e[2]*t[2];this._handles.forEach((function(t){t.clippingPlaneA=[e[0],e[1],e[2],r],t.clippingPlaneB=null}))},t.prototype.setClippingPlaneA=function(t,e){if(null!=e){var r=this.getHandle(e);r&&(r.clippingPlaneA=t)}else this._handles.forEach((function(e){e.clippingPlaneA=t}))},t.prototype.setClippingPlaneB=function(t,e){if(null!=e){var r=this.getHandle(e);r&&(r.clippingPlaneB=t)}else this._handles.forEach((function(e){e.clippingPlaneB=t}))},t.prototype.unclip=function(t){if(null!=t){var e=this.getHandle(t);e&&(e.clippingPlaneA=null,e.clippingPlaneB=null)}else this._handles.forEach((function(t){t.clippingPlaneA=null,t.clippingPlaneB=null}))},t.prototype.getClip=function(t){var e;return(e=null==t?this._handles.filter((function(t){return t.clippable&&!t.stopped&&(null!=t.clippingPlaneA||null!=t.clippingPlaneB)})).pop():this.getHandle(t))?{PlaneA:e.clippingPlaneA,PlaneB:e.clippingPlaneB}:null},t.noData={id:null,model:null,xyz:null},t}();e.Viewer=_,function(t){t[t.NONE=-1]="NONE",t[t.PRODUCTS=-2]="PRODUCTS"}(n||(n={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.GRAYSCALE=1]="GRAYSCALE",t[t.XRAY=2]="XRAY",t[t.XRAY_ULTRA=4]="XRAY_ULTRA"}(i=e.RenderingMode||(e.RenderingMode={})),function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM",t[t.FRONT=2]="FRONT",t[t.BACK=3]="BACK",t[t.LEFT=4]="LEFT",t[t.RIGHT=5]="RIGHT",t[t.DEFAULT=6]="DEFAULT"}(a=e.ViewType||(e.ViewType={}))}])},"./src/app.ts":function(t,e,r){"use strict";e.__esModule=!0,e.Application=void 0;var n=r("./node_modules/@xbim/viewer/index.js"),i=r("./src/services/entity.service.ts"),a=r("./src/services/selection.service.ts"),o=r("./src/components/properties/properties.component.ts"),s=function(){function t(){this.viewer=new n.Viewer("viewer"),this.service=new i.EntityService,this.selection=new a.SelectionService(this.viewer),this.setUpViewer(),this.setUpPlugins();var t=document.getElementById("left-container");this.properties=new o.PropertiesComponent(t)}return t.prototype.start=function(){var t=this;this.viewer.on("loaded",(function(){t.viewer.show(n.ViewType.DEFAULT,void 0,void 0,!1),t.viewer.start()})),this.viewer.loadAsync("api/model.wexbim")},t.prototype.setUpViewer=function(){var t=this;this.viewer.background=[0,0,0,0],this.viewer.on("pick",(function(e){t.selection.select(e.id),null!=e.id&&t.service.getProperties(e.id).then((function(e){t.properties.render(e)}))}))},t.prototype.setUpPlugins=function(){var t=new n.Grid;this.viewer.addPlugin(t);var e=new n.NavigationCube;e.ratio=.05,e.activeAlpha=.9,e.passiveAlpha=.9,this.viewer.addPlugin(e)},t}();e.Application=s},"./src/components/properties/properties.component.ts":function(t,e,r){"use strict";e.__esModule=!0,e.PropertiesComponent=void 0;var n=function(){function t(t){this.element=t}return t.prototype.render=function(t){this.element.innerHTML=null;var e=document.createElement("table");t.forEach((function(t){var r=document.createElement("tr"),n=document.createElement("th");r.appendChild(n),n.colSpan=2,n.innerText=t.name,e.appendChild(r),t.properties.forEach((function(t){var r=document.createElement("tr"),n=document.createElement("td");n.innerText=t.name;var i=document.createElement("td");i.innerText=t.value,r.appendChild(n),r.appendChild(i),e.appendChild(r)}))})),this.element.appendChild(e)},t}();e.PropertiesComponent=n},"./src/index.ts":function(t,e,r){"use strict";e.__esModule=!0,(new(r("./src/app.ts").Application)).start()},"./src/models/entity.ts":function(t,e,r){"use strict";e.__esModule=!0,e.Entity=void 0;var n=function(){this.properties=[]};e.Entity=n},"./src/models/property-set.ts":function(t,e,r){"use strict";e.__esModule=!0,e.PropertySet=void 0;var n=function(t){void 0===t&&(t=null),this.name=t,this.properties=[]};e.PropertySet=n},"./src/models/property.ts":function(t,e,r){"use strict";e.__esModule=!0,e.Property=void 0;var n=function(t,e){this.name=t,this.value=e};e.Property=n},"./src/services/entity.service.ts":function(t,e,r){"use strict";e.__esModule=!0,e.EntityService=void 0;var n=r("./src/models/entity.ts"),i=r("./src/models/property-set.ts"),a=r("./src/models/property.ts"),o=function(){function t(){this.cache={}}return t.prototype.getEntity=function(t){if(null!=this.cache[t])return this.cache[t]},t.prototype.getProperties=function(t){var e=this;return new Promise((function(r,o){var s=e.cache[t];null==s||null==s.properties?e.get("api/"+t+"/properties.json").then((function(o){var u=[];Object.getOwnPropertyNames(o).forEach((function(t){var e=o[t],r=new i.PropertySet(t);Object.getOwnPropertyNames(e).forEach((function(t){var n=e[t],i=new a.Property(t,n);r.properties.push(i)})),r.properties.length>0&&u.push(r)})),null==s&&(s=new n.Entity),s.properties=u,e.cache[t]=s,r(u)})).catch((function(t){o(t)})):r(s.properties)}))},t.prototype.get=function(t){return new Promise((function(e,r){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState){if(n.status>=200&&n.status<300){var i=JSON.parse(n.responseText);return void e(i)}r("Failed to request "+t+". Code: "+n.status+" ("+n.statusText+"). Result: "+n.responseText)}},n.open("GET",t,!0),n.send()}))},t}();e.EntityService=o},"./src/services/selection.service.ts":function(t,e,r){"use strict";e.__esModule=!0,e.SelectionService=void 0;var n=r("./node_modules/@xbim/viewer/index.js"),i=function(){function t(t){this.viewer=t}return t.prototype.select=function(t){null!=this.selection&&this.viewer.setState(n.State.UNDEFINED,[this.selection]),this.selection=t,null!=t&&this.viewer.setState(n.State.HIGHLIGHTED,[t])},t}();e.SelectionService=i}})}));